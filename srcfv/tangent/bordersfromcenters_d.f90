! This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (master) -  9 Oct 2020 17:47
!
!  Differentiation of bordersfromcenters_2d in forward (tangent) mode (with options with!SliceDeadControl with!SliceDeadInstrs wi
!th!StaticTaping):
!   variations   of useful results: x0 y0
!   with respect to varying inputs: xc yc x0 y0
!   RW status of diff variables: xc:in yc:in x0:in-out y0:in-out
SUBROUTINE BORDERSFROMCENTERS_2D_D(x0, x0d, y0, y0d, xc, xcd, yc, ycd, &
& im, jm)
  IMPLICIT NONE
! variables for dimension -----------------------------------------
  INTEGER :: im, jm, gh
! required arguments ----------------------------------------------
! Returned objects ------------------------------------------------
  REAL*8, DIMENSION(im+1, jm+1), INTENT(INOUT) :: x0
  REAL*8, DIMENSION(im+1, jm+1), INTENT(INOUT) :: x0d
  REAL*8, DIMENSION(im+1, jm+1), INTENT(INOUT) :: y0
  REAL*8, DIMENSION(im+1, jm+1), INTENT(INOUT) :: y0d
  REAL*8, DIMENSION(im, jm), INTENT(IN) :: xc
  REAL*8, DIMENSION(im, jm), INTENT(IN) :: xcd
  REAL*8, DIMENSION(im, jm), INTENT(IN) :: yc
  REAL*8, DIMENSION(im, jm), INTENT(IN) :: ycd
! Non-required arguments -------------------------------------------
  INTEGER :: i, j, g, dummy
! ------------------------------------------------------------------
  REAL*8 :: two, half, fourth
  fourth = 0.25d0
  DO j=2,jm
!DIR$ IVDEP
    DO i=2,im
      x0d(i, j) = fourth*(xcd(i-1, j-1)+xcd(i, j-1)+xcd(i-1, j)+xcd(i, j&
&       ))
      y0d(i, j) = fourth*(ycd(i-1, j-1)+ycd(i, j-1)+ycd(i-1, j)+ycd(i, j&
&       ))
    END DO
  END DO
  DO j=2,jm
    x0d(im+1, j) = xcd(im, j) + xcd(im, j-1) - x0d(im, j)
    y0d(im+1, j) = ycd(im, j) + ycd(im, j-1) - y0d(im, j)
    x0d(1, j) = xcd(1, j) + xcd(1, j-1) - x0d(2, j)
    y0d(1, j) = ycd(1, j) + ycd(1, j-1) - y0d(2, j)
  END DO
  DO i=2,im
    x0d(i, jm+1) = xcd(i, jm) + xcd(i-1, jm) - x0d(i, jm)
    y0d(i, jm+1) = ycd(i, jm) + ycd(i-1, jm) - y0d(i, jm)
    x0d(i, 1) = xcd(i, 1) + xcd(i-1, 1) - x0d(i, 2)
    y0d(i, 1) = ycd(i, 1) + ycd(i-1, 1) - y0d(i, 2)
  END DO
  x0d(im+1, jm+1) = x0d(im, jm+1) + x0d(im+1, jm) - x0d(im, jm)
  y0d(im+1, jm+1) = y0d(im, jm+1) + y0d(im+1, jm) - y0d(im, jm)
  x0d(1, jm+1) = x0d(1, jm) + x0d(2, jm+1) - x0d(2, jm)
  y0d(1, jm+1) = y0d(1, jm) + y0d(2, jm+1) - y0d(2, jm)
  x0d(im+1, 1) = x0d(im, 1) + x0d(im+1, 2) - x0d(im, 2)
  y0d(im+1, 1) = y0d(im, 1) + y0d(im+1, 2) - y0d(im, 2)
  x0d(1, 1) = x0d(1, 2) + x0d(2, 1) - x0d(2, 2)
  y0d(1, 1) = y0d(1, 2) + y0d(2, 1) - y0d(2, 2)
END SUBROUTINE BORDERSFROMCENTERS_2D_D

