! This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (master) -  9 Oct 2020 17:47
!
!  Differentiation of flux_num_dnc5_nowall_nodiss_2d in reverse (adjoint) mode (with options with!SliceDeadControl with!SliceDead
!Instrs with!StaticTaping):
!   gradient     of useful results: residu
!   with respect to varying inputs: w residu
!   RW status of diff variables: w:out residu:in-out
! =============================================================================
!          consistent fluxes for DNC5 2D
! =============================================================================
!
SUBROUTINE FLUX_NUM_DNC5_NOWALL_NODISS_2D_B(residu, residub, w, wb, x0, &
& y0, nx, ny, xc, yc, vol, volf, gh, cp, cv, prandtl, gam, rgaz, cs, &
& muref, tref, s_suth, k2, k4, im, jm)
  IMPLICIT NONE
! variables for dimension -----------------------------------------
  INTEGER :: im, jm, gh
! required arguments ----------------------------------------------
! thermo
  REAL*8, INTENT(IN) :: cp, cv, prandtl, gam, rgaz
! dissipation
  REAL*8, INTENT(IN) :: k2, k4
! viscosity
  REAL*8, INTENT(IN) :: cs, muref, tref, s_suth
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: x0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: y0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: nx
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: ny
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: xc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: yc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: vol
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2), INTENT(IN) :: volf
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: w
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: wb
! Returned objects ------------------------------------------------
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(INOUT) :: residu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(INOUT) :: residub
! Non-required arguments -------------------------------------------
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 5, 2) :: hn
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 5, 2) :: hnb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: f, g
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: fb, gb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velx
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velxb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: vely
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velyb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velz
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velzb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tloc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tlocb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: p
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: pb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mub
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradu, gradv, gradw, &
& gradmu
  REAL*8, DIMENSION(5) :: deltar, deltal, t
  INTEGER :: i, j, h
  REAL*8 :: nx_n, nx_s, nx_e, nx_o, volm1, ux, vx, wx, tx
  REAL*8 :: uxb, vxb, wxb, txb
  REAL*8 :: ny_n, ny_s, ny_e, ny_o, uy, vy, wy, ty
  REAL*8 :: uyb, vyb, wyb, tyb
  REAL*8 :: val_n, val_s, val_e, val_o
  REAL*8 :: val_nb, val_sb, val_eb, val_ob
  REAL*8 :: fxro1, fxro2, fxrou1, fxrou2, fxrov1, fxrov2, fxrow1, fxrow2&
& , fxroe1, fxroe2
  REAL*8 :: fxro1b, fxro2b, fxrou1b, fxrou2b, fxrov1b, fxrov2b, fxrow1b&
& , fxrow2b, fxroe1b, fxroe2b
  REAL*8 :: fvro1, fvro2, fvrou1, fvrou2, fvrov1, fvrov2, fvrow1, fvrow2&
& , fvroe1, fvroe2
  REAL*8 :: fvrou1b, fvrou2b, fvrov1b, fvrov2b, fvrow1b, fvrow2b, &
& fvroe1b, fvroe2b
  REAL*8 :: gvro1, gvro2, gvrou1, gvrou2, gvrov1, gvrov2, gvrow1, gvrow2&
& , gvroe1, gvroe2
  REAL*8 :: gvrou1b, gvrou2b, gvrov1b, gvrov2b, gvrow1b, gvrow2b, &
& gvroe1b, gvroe2b
  REAL*8 :: dissro1, dissro2, dissrou1, dissrou2, dissrov1, dissrov2, &
& dissrow1, dissrow2, dissroe1, dissroe2
  REAL*8 :: cpprandtl, mmu, lambda, uu, vv, ww, ro, rom1, htot, eloc, ec
  REAL*8 :: mmub, lambdab, uub, vvb, wwb, rob, rom1b, htotb, elocb, ecb
  REAL*8 :: predro1, predrou1, predrov1, predrow1, predroe1, eps2, eps4
  REAL*8 :: predro2, predrou2, predrov2, predrow2, predroe2, rspec
  REAL*8 :: divu, divu2, vort2, dx, dy, dxm1, dym1, dxm2, dym2
  REAL*8 :: nxloc, nyloc, sn, invsn, sc1, sc2
  REAL*8 :: gui, gvi, gwi, gmui
  REAL*8 :: guj, gvj, gwj, gmuj
  REAL*8 :: rhom, rhomr, rhoml, rhom1l, c2l, c2r, rr, r, u, ur, ul, vr, &
& vl, wr, wl, c2x, nx2, ny2
  REAL*8 :: ab, sq, ducros1, ducros2, k_sensor1, k_sensor2
  REAL*8 :: b1, b2, b3, b4, b5, c1, c2, c3, c4, c5, d1, d2, d3, wiggle, &
& denom, betas
  REAL*8 :: omrr, coef, test, diffro, diffrou, diffrov, diffrow, diffroe&
& , v
  REAL*8 :: half, one, zero, two, twothird, fourth, twelfth, cvm1
  REAL*8 :: twentyfourth, ccross
  REAL*8 :: mach2, alpha, vn2, cprim
  INTRINSIC SQRT
  REAL*8 :: temp
  REAL*8 :: tempb
  REAL*8 :: temp0
  REAL*8 :: tempb0
  REAL*8 :: tempb1
  REAL*8 :: ad_save
  REAL*8 :: ad_save0
  REAL*8 :: ad_save1
  REAL*8 :: ad_save2
  REAL*8 :: ad_save3
  REAL*8 :: ad_save4
  REAL*8 :: ad_save5
  REAL*8 :: ad_save6
  REAL*8 :: ad_save7
  REAL*8 :: ad_save8
  REAL*8 :: ad_save9
  REAL*8 :: ad_save10
  REAL*8 :: ad_save11
  REAL*8 :: ad_save12
  REAL*8 :: ad_save13
  REAL*8 :: ad_save14
! -----------------------------------------------------------------
!
  half = 0.5d0
  one = 1.d0
  two = 2.d0
  twothird = 2.d0/3.d0
  twelfth = 0.25d0/3.d0
  cpprandtl = cp/prandtl
  cvm1 = one/cv
  twentyfourth = one/24.d0
  ccross = twelfth*0.0625d0
! k2 = 1.d0
! k4 = 1.d0/60d0 already in coef for predictor
! Coef for grad o6
  denom = 1.d0/60.d0
!expression for FV
! c3 = b3
! c2 = c3 + b2
! c1 = c2 + b1
  c1 = 37.d0*denom
  c2 = -(8.d0*denom)
  c3 = denom
!predictor
! for Sutherland
  betas = muref*(tref+cs)/(SQRT(tref)*tref)
!$FWD-OF II-LOOP 
! Primitives
  DO j=1-gh,jm+gh
!DIR$ IVDEP
    DO i=1-gh,im+gh
      ro = w(i, j, 1)
      rom1 = one/ro
      velx(i, j) = w(i, j, 2)*rom1
      vely(i, j) = w(i, j, 3)*rom1
      velz(i, j) = w(i, j, 4)*rom1
!
      ec = half*(velx(i, j)*velx(i, j)+vely(i, j)*vely(i, j)+velz(i, j)*&
&       velz(i, j))
! ec  = HALF*( velx(i,j)*velx(i,j) &
!            + vely(i,j)*vely(i,j))
!
      eloc = (w(i, j, 5)-ec*ro)*rom1
!
      tloc(i, j) = eloc*cvm1
!
      p(i, j) = (gam-one)*ro*eloc
!  p(i,j)  = ro*rgaz*tloc(i,j)
      htot = (w(i, j, 5)+p(i, j))*rom1
      f(i, j, 1) = w(i, j, 2)
      f(i, j, 2) = w(i, j, 2)*velx(i, j) + p(i, j)
      f(i, j, 3) = w(i, j, 2)*vely(i, j)
      f(i, j, 4) = w(i, j, 2)*velz(i, j)
      f(i, j, 5) = w(i, j, 2)*htot
      g(i, j, 1) = w(i, j, 3)
      g(i, j, 2) = w(i, j, 3)*velx(i, j)
      g(i, j, 3) = w(i, j, 3)*vely(i, j) + p(i, j)
      g(i, j, 4) = w(i, j, 3)*velz(i, j)
      g(i, j, 5) = w(i, j, 3)*htot
!h(i,j,1)  = w(i,j,4)
!h(i,j,2)  = w(i,j,4) * velx(i,j)
!h(i,j,3)  = w(i,j,4) * vely(i,j)
!h(i,j,4)  = w(i,j,4) * velz(i,j) + p(i,j)
!h(i,j,5)  = w(i,j,4) * htot
      mu(i, j) = betas/(tloc(i, j)+s_suth)*SQRT(tloc(i, j))*tloc(i, j)
    END DO
  END DO
  hnb = 0.0_8
!$BWD-OF II-LOOP 
  DO j=1,jm
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1,im
      hnb(i, j, 5, 1) = hnb(i, j, 5, 1) + residub(i, j, 5)
      hnb(i+1, j, 5, 1) = hnb(i+1, j, 5, 1) - residub(i, j, 5)
      hnb(i, j, 5, 2) = hnb(i, j, 5, 2) + residub(i, j, 5)
      hnb(i, j+1, 5, 2) = hnb(i, j+1, 5, 2) - residub(i, j, 5)
      residub(i, j, 5) = 0.0_8
      hnb(i, j, 4, 1) = hnb(i, j, 4, 1) + residub(i, j, 4)
      hnb(i+1, j, 4, 1) = hnb(i+1, j, 4, 1) - residub(i, j, 4)
      hnb(i, j, 4, 2) = hnb(i, j, 4, 2) + residub(i, j, 4)
      hnb(i, j+1, 4, 2) = hnb(i, j+1, 4, 2) - residub(i, j, 4)
      residub(i, j, 4) = 0.0_8
      hnb(i, j, 3, 1) = hnb(i, j, 3, 1) + residub(i, j, 3)
      hnb(i+1, j, 3, 1) = hnb(i+1, j, 3, 1) - residub(i, j, 3)
      hnb(i, j, 3, 2) = hnb(i, j, 3, 2) + residub(i, j, 3)
      hnb(i, j+1, 3, 2) = hnb(i, j+1, 3, 2) - residub(i, j, 3)
      residub(i, j, 3) = 0.0_8
      hnb(i, j, 2, 1) = hnb(i, j, 2, 1) + residub(i, j, 2)
      hnb(i+1, j, 2, 1) = hnb(i+1, j, 2, 1) - residub(i, j, 2)
      hnb(i, j, 2, 2) = hnb(i, j, 2, 2) + residub(i, j, 2)
      hnb(i, j+1, 2, 2) = hnb(i, j+1, 2, 2) - residub(i, j, 2)
      residub(i, j, 2) = 0.0_8
      hnb(i, j, 1, 1) = hnb(i, j, 1, 1) + residub(i, j, 1)
      hnb(i+1, j, 1, 1) = hnb(i+1, j, 1, 1) - residub(i, j, 1)
      hnb(i, j, 1, 2) = hnb(i, j, 1, 2) + residub(i, j, 1)
      hnb(i, j+1, 1, 2) = hnb(i, j+1, 1, 2) - residub(i, j, 1)
      residub(i, j, 1) = 0.0_8
    END DO
  END DO
  fb = 0.0_8
  gb = 0.0_8
  velxb = 0.0_8
  velyb = 0.0_8
  velzb = 0.0_8
  tlocb = 0.0_8
  mub = 0.0_8
!$BWD-OF II-LOOP 
  DO j=1,jm+1
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1,im+1
!
! grad for viscous fluxes o4 - 5p
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccros = TWELFTH*0.0625d0
      volm1 = volf(i, j, 1)
      nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
      nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
      nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
      nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
      ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
      ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
      ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
      ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
      val_n = twentyfourth*(-velx(i+1, j)+26.d0*velx(i, j)-velx(i-1, j))
      val_s = twentyfourth*(-velx(i, j)+26.d0*velx(i-1, j)-velx(i-2, j))
      val_e = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-1, j-2)+9.d0*velx(i&
&       , j-2)-velx(i+1, j-2))+7.d0*(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)&
&       +9.d0*velx(i, j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx&
&       (i-1, j)+9.d0*velx(i, j)-velx(i+1, j))-(-velx(i-2, j+1)+9.d0*&
&       velx(i-1, j+1)+9.d0*velx(i, j+1)-velx(i+1, j+1)))
      val_o = ccross*(-(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0*velx(i&
&       , j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+&
&       9.d0*velx(i, j)-velx(i+1, j))+7.d0*(-velx(i-2, j+1)+9.d0*velx(i-&
&       1, j+1)+9.d0*velx(i, j+1)-velx(i+1, j+1))-(-velx(i-2, j+2)+9.d0*&
&       velx(i-1, j+2)+9.d0*velx(i, j+2)-velx(i+1, j+2)))
      ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = twentyfourth*(-vely(i+1, j)+26.d0*vely(i, j)-vely(i-1, j))
      val_s = twentyfourth*(-vely(i, j)+26.d0*vely(i-1, j)-vely(i-2, j))
      val_e = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-1, j-2)+9.d0*vely(i&
&       , j-2)-vely(i+1, j-2))+7.d0*(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)&
&       +9.d0*vely(i, j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely&
&       (i-1, j)+9.d0*vely(i, j)-vely(i+1, j))-(-vely(i-2, j+1)+9.d0*&
&       vely(i-1, j+1)+9.d0*vely(i, j+1)-vely(i+1, j+1)))
      val_o = ccross*(-(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0*vely(i&
&       , j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+&
&       9.d0*vely(i, j)-vely(i+1, j))+7.d0*(-vely(i-2, j+1)+9.d0*vely(i-&
&       1, j+1)+9.d0*vely(i, j+1)-vely(i+1, j+1))-(-vely(i-2, j+2)+9.d0*&
&       vely(i-1, j+2)+9.d0*vely(i, j+2)-vely(i+1, j+2)))
      vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = twentyfourth*(-velz(i+1, j)+26.d0*velz(i, j)-velz(i-1, j))
      val_s = twentyfourth*(-velz(i, j)+26.d0*velz(i-1, j)-velz(i-2, j))
      val_e = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-1, j-2)+9.d0*velz(i&
&       , j-2)-velz(i+1, j-2))+7.d0*(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)&
&       +9.d0*velz(i, j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz&
&       (i-1, j)+9.d0*velz(i, j)-velz(i+1, j))-(-velz(i-2, j+1)+9.d0*&
&       velz(i-1, j+1)+9.d0*velz(i, j+1)-velz(i+1, j+1)))
      val_o = ccross*(-(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0*velz(i&
&       , j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+&
&       9.d0*velz(i, j)-velz(i+1, j))+7.d0*(-velz(i-2, j+1)+9.d0*velz(i-&
&       1, j+1)+9.d0*velz(i, j+1)-velz(i+1, j+1))-(-velz(i-2, j+2)+9.d0*&
&       velz(i-1, j+2)+9.d0*velz(i, j+2)-velz(i+1, j+2)))
      wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = twentyfourth*(-tloc(i+1, j)+26.d0*tloc(i, j)-tloc(i-1, j))
      val_s = twentyfourth*(-tloc(i, j)+26.d0*tloc(i-1, j)-tloc(i-2, j))
      val_e = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-1, j-2)+9.d0*tloc(i&
&       , j-2)-tloc(i+1, j-2))+7.d0*(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)&
&       +9.d0*tloc(i, j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc&
&       (i-1, j)+9.d0*tloc(i, j)-tloc(i+1, j))-(-tloc(i-2, j+1)+9.d0*&
&       tloc(i-1, j+1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1)))
      val_o = ccross*(-(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i&
&       , j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j)+&
&       9.d0*tloc(i, j)-tloc(i+1, j))+7.d0*(-tloc(i-2, j+1)+9.d0*tloc(i-&
&       1, j+1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1))-(-tloc(i-2, j+2)+9.d0*&
&       tloc(i-1, j+2)+9.d0*tloc(i, j+2)-tloc(i+1, j+2)))
      tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
      uu = 0.0625d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*velx(i, j)-&
&       velx(i+1, j))
      vv = 0.0625d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*vely(i, j)-&
&       vely(i+1, j))
      ww = 0.0625d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*velz(i, j)-&
&       velz(i+1, j))
!
      mmu = 0.0625d0*(-mu(i-2, j)+9.d0*mu(i-1, j)+9.d0*mu(i, j)-mu(i+1, &
&       j))
      lambda = mmu*cpprandtl
!
      fvrou1 = twothird*mmu*(two*ux-vy)
      fvrov1 = mmu*(uy+vx)
      fvrow1 = mmu*wx
! fvroe1 = (lambda*tx + uu*fvrou1 + vv*fvrov1)
!
      gvrou1 = mmu*(uy+vx)
      gvrov1 = twothird*mmu*(-ux+two*vy)
      gvrow1 = mmu*wy
! gvroe1 = (lambda*ty + uu*gvrou1 + vv*gvrov1)
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! grad for viscous fluxes o4 - 5p
!
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccross = TWELFTH*0.0625d0
      volm1 = volf(i, j, 2)
      nx_n = half*(nx(i+1, j-1, 1)+nx(i+1, j, 1))
      nx_s = -(half*(nx(i, j-1, 1)+nx(i, j, 1)))
      nx_o = half*(nx(i, j+1, 2)+nx(i, j, 2))
      nx_e = -(half*(nx(i, j-1, 2)+nx(i, j, 2)))
!
      ny_n = half*(ny(i+1, j-1, 1)+ny(i+1, j, 1))
      ny_s = -(half*(ny(i, j-1, 1)+ny(i, j, 1)))
      ny_o = half*(ny(i, j+1, 2)+ny(i, j, 2))
      ny_e = -(half*(ny(i, j-1, 2)+ny(i, j, 2)))
      val_n = ccross*(-(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+9.d0*velx(i-&
&       1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0&
&       *velx(i, j)-velx(i, j+1))+7.d0*(-velx(i+1, j-2)+9.d0*velx(i+1, j&
&       -1)+9.d0*velx(i+1, j)-velx(i+1, j+1))-(-velx(i+2, j-2)+9.d0*velx&
&       (i+2, j-1)+9.d0*velx(i+2, j)-velx(i+2, j+1)))
      val_s = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-2, j-1)+9.d0*velx(i-&
&       2, j)-velx(i-2, j+1))+7.d0*(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+&
&       9.d0*velx(i-1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(&
&       i, j-1)+9.d0*velx(i, j)-velx(i, j+1))-(-velx(i+1, j-2)+9.d0*velx&
&       (i+1, j-1)+9.d0*velx(i+1, j)-velx(i+1, j+1)))
      val_e = twentyfourth*(-velx(i, j)+26.d0*velx(i, j-1)-velx(i, j-2))
      val_o = twentyfourth*(-velx(i, j+1)+26.d0*velx(i, j)-velx(i, j-1))
      ad_save = ux
      ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save0 = uy
      uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = ccross*(-(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+9.d0*vely(i-&
&       1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0&
&       *vely(i, j)-vely(i, j+1))+7.d0*(-vely(i+1, j-2)+9.d0*vely(i+1, j&
&       -1)+9.d0*vely(i+1, j)-vely(i+1, j+1))-(-vely(i+2, j-2)+9.d0*vely&
&       (i+2, j-1)+9.d0*vely(i+2, j)-vely(i+2, j+1)))
      val_s = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-2, j-1)+9.d0*vely(i-&
&       2, j)-vely(i-2, j+1))+7.d0*(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+&
&       9.d0*vely(i-1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(&
&       i, j-1)+9.d0*vely(i, j)-vely(i, j+1))-(-vely(i+1, j-2)+9.d0*vely&
&       (i+1, j-1)+9.d0*vely(i+1, j)-vely(i+1, j+1)))
      val_e = twentyfourth*(-vely(i, j)+26.d0*vely(i, j-1)-vely(i, j-2))
      val_o = twentyfourth*(-vely(i, j+1)+26.d0*vely(i, j)-vely(i, j-1))
      ad_save1 = vx
      vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save2 = vy
      vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = ccross*(-(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+9.d0*velz(i-&
&       1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0&
&       *velz(i, j)-velz(i, j+1))+7.d0*(-velz(i+1, j-2)+9.d0*velz(i+1, j&
&       -1)+9.d0*velz(i+1, j)-velz(i+1, j+1))-(-velz(i+2, j-2)+9.d0*velz&
&       (i+2, j-1)+9.d0*velz(i+2, j)-velz(i+2, j+1)))
      val_s = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-2, j-1)+9.d0*velz(i-&
&       2, j)-velz(i-2, j+1))+7.d0*(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+&
&       9.d0*velz(i-1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(&
&       i, j-1)+9.d0*velz(i, j)-velz(i, j+1))-(-velz(i+1, j-2)+9.d0*velz&
&       (i+1, j-1)+9.d0*velz(i+1, j)-velz(i+1, j+1)))
      val_e = twentyfourth*(-velz(i, j)+26.d0*velz(i, j-1)-velz(i, j-2))
      val_o = twentyfourth*(-velz(i, j+1)+26.d0*velz(i, j)-velz(i, j-1))
      ad_save3 = wx
      wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save4 = wy
      wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = ccross*(-(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i-&
&       1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i, j-1)+9.d0&
&       *tloc(i, j)-tloc(i, j+1))+7.d0*(-tloc(i+1, j-2)+9.d0*tloc(i+1, j&
&       -1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1))-(-tloc(i+2, j-2)+9.d0*tloc&
&       (i+2, j-1)+9.d0*tloc(i+2, j)-tloc(i+2, j+1)))
      val_s = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-2, j-1)+9.d0*tloc(i-&
&       2, j)-tloc(i-2, j+1))+7.d0*(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+&
&       9.d0*tloc(i-1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(&
&       i, j-1)+9.d0*tloc(i, j)-tloc(i, j+1))-(-tloc(i+1, j-2)+9.d0*tloc&
&       (i+1, j-1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1)))
      val_e = twentyfourth*(-tloc(i, j)+26.d0*tloc(i, j-1)-tloc(i, j-2))
      val_o = twentyfourth*(-tloc(i, j+1)+26.d0*tloc(i, j)-tloc(i, j-1))
      ad_save5 = tx
      tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save6 = ty
      ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      ad_save7 = uu
      uu = 0.0625d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*velx(i, j)-&
&       velx(i, j+1))
      ad_save8 = vv
      vv = 0.0625d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*vely(i, j)-&
&       vely(i, j+1))
      ad_save9 = ww
      ww = 0.0625d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*velz(i, j)-&
&       velz(i, j+1))
!
      ad_save10 = mmu
      mmu = 0.0625d0*(-mu(i, j-2)+9.d0*mu(i, j-1)+9.d0*mu(i, j)-mu(i, j+&
&       1))
      ad_save11 = lambda
      lambda = mmu*cpprandtl
!
      fvrou2 = twothird*mmu*(two*ux-vy)
      fvrov2 = mmu*(uy+vx)
      fvrow2 = mmu*wx
! fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2)
      gvrou2 = mmu*(uy+vx)
      gvrov2 = twothird*mmu*(-ux+two*vy)
      gvrow2 = mmu*wy
! gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2)
!!  fvrou2 = TWOTHIRD*mmu*( TWO*ux -     vy  -  wz  )
!!  fvrov2 =          mmu*(     uy +     vx         )
!!  fvrow2 =          mmu*(     uz           +  wx  )
!!  fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2 + ww * fvrow2)
!!
!!  gvrou2 =          mmu*(     uy +     vx       )
!!  gvrov2 = TWOTHIRD*mmu*(    -ux + TWO*vy -  wz )
!!  gvrow2 =          mmu*(              vz +  wy )
!!  gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2 + ww*gvrow2)
      sc1 = nx(i, j, 1)
      sc2 = ny(i, j, 1)
      sn = SQRT(sc1*sc1 + sc2*sc2)
      invsn = one/sn
      nxloc = sc1*invsn
      nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
      sc1 = nx(i, j, 2)
      sc2 = ny(i, j, 2)
      ad_save12 = sn
      sn = SQRT(sc1*sc1 + sc2*sc2)
      invsn = one/sn
      ad_save13 = nxloc
      nxloc = sc1*invsn
      ad_save14 = nyloc
      nyloc = sc2*invsn
!
!
!
! hn(i,j,4,2) = ZERO
!
      fxroe2b = hnb(i, j, 5, 2)
      fvroe2b = -(nxloc*sn*hnb(i, j, 5, 2))
      gvroe2b = -(nyloc*sn*hnb(i, j, 5, 2))
      hnb(i, j, 5, 2) = 0.0_8
      fxrow2b = hnb(i, j, 4, 2)
      fvrow2b = ww*fvroe2b - nxloc*sn*hnb(i, j, 4, 2)
      gvrow2b = ww*gvroe2b - nyloc*sn*hnb(i, j, 4, 2)
      hnb(i, j, 4, 2) = 0.0_8
      fxrov2b = hnb(i, j, 3, 2)
      fvrov2b = vv*fvroe2b - nxloc*sn*hnb(i, j, 3, 2)
      gvrov2b = vv*gvroe2b - nyloc*sn*hnb(i, j, 3, 2)
      hnb(i, j, 3, 2) = 0.0_8
      fxrou2b = hnb(i, j, 2, 2)
      fvrou2b = uu*fvroe2b - nxloc*sn*hnb(i, j, 2, 2)
      gvrou2b = uu*gvroe2b - nyloc*sn*hnb(i, j, 2, 2)
      hnb(i, j, 2, 2) = 0.0_8
      fxro2b = hnb(i, j, 1, 2)
      hnb(i, j, 1, 2) = 0.0_8
      nyloc = ad_save14
      nxloc = ad_save13
      sn = ad_save12
      fxroe1b = hnb(i, j, 5, 1)
      fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
      gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
      hnb(i, j, 5, 1) = 0.0_8
      fxrow1b = hnb(i, j, 4, 1)
      fxrov1b = hnb(i, j, 3, 1)
      fxrou1b = hnb(i, j, 2, 1)
      fxro1b = hnb(i, j, 1, 1)
      hnb(i, j, 1, 1) = 0.0_8
      lambdab = ty*gvroe2b + tx*fvroe2b
      tyb = lambda*gvroe2b
      uub = gvrou2*gvroe2b + fvrou2*fvroe2b
      vvb = gvrov2*gvroe2b + fvrov2*fvroe2b
      wwb = gvrow2*gvroe2b + fvrow2*fvroe2b
      wyb = mmu*gvrow2b
      tempb1 = twothird*gvrov2b
      mmub = wy*gvrow2b + (two*vy-ux)*tempb1
      vyb = two*mmu*tempb1
      uxb = -(mmu*tempb1)
      uyb = mmu*gvrou2b + mmu*fvrov2b
      vxb = mmu*gvrou2b + mmu*fvrov2b
      txb = lambda*fvroe2b
      wxb = mmu*fvrow2b
      tempb1 = twothird*fvrou2b
      mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (&
&       two*ux-vy)*tempb1 + cpprandtl*lambdab
      uxb = uxb + two*mmu*tempb1
      vyb = vyb - mmu*tempb1
      lambda = ad_save11
      mmu = ad_save10
      tempb1 = 0.0625d0*mmub
      mub(i, j-1) = mub(i, j-1) + 9.d0*tempb1
      mub(i, j-2) = mub(i, j-2) - tempb1
      mub(i, j) = mub(i, j) + 9.d0*tempb1
      mub(i, j+1) = mub(i, j+1) - tempb1
      ww = ad_save9
      fvrow1b = ww*fvroe1b - nxloc*sn*hnb(i, j, 4, 1)
      gvrow1b = ww*gvroe1b - nyloc*sn*hnb(i, j, 4, 1)
      hnb(i, j, 4, 1) = 0.0_8
      tempb1 = 0.0625d0*wwb
      velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb1
      velzb(i, j-2) = velzb(i, j-2) - tempb1
      velzb(i, j) = velzb(i, j) + 9.d0*tempb1
      velzb(i, j+1) = velzb(i, j+1) - tempb1
      vv = ad_save8
      fvrov1b = vv*fvroe1b - nxloc*sn*hnb(i, j, 3, 1)
      gvrov1b = vv*gvroe1b - nyloc*sn*hnb(i, j, 3, 1)
      hnb(i, j, 3, 1) = 0.0_8
      tempb1 = 0.0625d0*vvb
      velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb1
      velyb(i, j-2) = velyb(i, j-2) - tempb1
      velyb(i, j) = velyb(i, j) + 9.d0*tempb1
      velyb(i, j+1) = velyb(i, j+1) - tempb1
      uu = ad_save7
      fvrou1b = uu*fvroe1b - nxloc*sn*hnb(i, j, 2, 1)
      gvrou1b = uu*gvroe1b - nyloc*sn*hnb(i, j, 2, 1)
      hnb(i, j, 2, 1) = 0.0_8
      tempb1 = 0.0625d0*uub
      velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb1
      velxb(i, j-2) = velxb(i, j-2) - tempb1
      velxb(i, j) = velxb(i, j) + 9.d0*tempb1
      velxb(i, j+1) = velxb(i, j+1) - tempb1
      ty = ad_save6
      tempb1 = volm1*tyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tx = ad_save5
      tempb1 = volm1*txb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      tlocb(i, j) = tlocb(i, j) + 26.d0*tempb1
      tlocb(i, j+1) = tlocb(i, j+1) - tempb1
      tlocb(i, j-1) = tlocb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      tlocb(i, j-1) = tlocb(i, j-1) + 26.d0*tempb1
      tlocb(i, j) = tlocb(i, j) - tempb1
      tlocb(i, j-2) = tlocb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
      tlocb(i-2, j-1) = tlocb(i-2, j-1) - 9.d0*tempb1
      tlocb(i-2, j) = tlocb(i-2, j) - 9.d0*tempb1
      tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
      tlocb(i+1, j-1) = tlocb(i+1, j-1) - 9.d0*tempb1
      tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1
      tlocb(i+1, j) = tlocb(i+1, j) - 9.d0*tempb1
      tempb1 = ccross*val_nb
      tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      tlocb(i-1, j-2) = tlocb(i-1, j-2) + tempb1 - tempb0
      tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      tlocb(i, j-2) = tlocb(i, j-2) - tempb - tempb0
      tlocb(i, j) = tlocb(i, j) + 9.d0*tempb + 9.d0*tempb0
      tlocb(i, j+1) = tlocb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      tlocb(i+2, j-2) = tlocb(i+2, j-2) + tempb1
      tlocb(i+2, j-1) = tlocb(i+2, j-1) - 9.d0*tempb1
      tlocb(i+2, j+1) = tlocb(i+2, j+1) + tempb1
      tlocb(i+2, j) = tlocb(i+2, j) - 9.d0*tempb1
      tlocb(i+1, j-1) = tlocb(i+1, j-1) + 9.d0*tempb
      tlocb(i+1, j-2) = tlocb(i+1, j-2) - tempb
      tlocb(i+1, j) = tlocb(i+1, j) + 9.d0*tempb
      tlocb(i+1, j+1) = tlocb(i+1, j+1) - tempb
      wy = ad_save4
      tempb1 = volm1*wyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      wx = ad_save3
      tempb1 = volm1*wxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      velzb(i, j) = velzb(i, j) + 26.d0*tempb1
      velzb(i, j+1) = velzb(i, j+1) - tempb1
      velzb(i, j-1) = velzb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      velzb(i, j-1) = velzb(i, j-1) + 26.d0*tempb1
      velzb(i, j) = velzb(i, j) - tempb1
      velzb(i, j-2) = velzb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
      velzb(i-2, j-1) = velzb(i-2, j-1) - 9.d0*tempb1
      velzb(i-2, j) = velzb(i-2, j) - 9.d0*tempb1
      velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
      velzb(i+1, j-1) = velzb(i+1, j-1) - 9.d0*tempb1
      velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1
      velzb(i+1, j) = velzb(i+1, j) - 9.d0*tempb1
      tempb1 = ccross*val_nb
      velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      velzb(i-1, j-2) = velzb(i-1, j-2) + tempb1 - tempb0
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      velzb(i, j-2) = velzb(i, j-2) - tempb - tempb0
      velzb(i, j) = velzb(i, j) + 9.d0*tempb + 9.d0*tempb0
      velzb(i, j+1) = velzb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      velzb(i+2, j-2) = velzb(i+2, j-2) + tempb1
      velzb(i+2, j-1) = velzb(i+2, j-1) - 9.d0*tempb1
      velzb(i+2, j+1) = velzb(i+2, j+1) + tempb1
      velzb(i+2, j) = velzb(i+2, j) - 9.d0*tempb1
      velzb(i+1, j-1) = velzb(i+1, j-1) + 9.d0*tempb
      velzb(i+1, j-2) = velzb(i+1, j-2) - tempb
      velzb(i+1, j) = velzb(i+1, j) + 9.d0*tempb
      velzb(i+1, j+1) = velzb(i+1, j+1) - tempb
      vy = ad_save2
      tempb1 = volm1*vyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      vx = ad_save1
      tempb1 = volm1*vxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      velyb(i, j) = velyb(i, j) + 26.d0*tempb1
      velyb(i, j+1) = velyb(i, j+1) - tempb1
      velyb(i, j-1) = velyb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      velyb(i, j-1) = velyb(i, j-1) + 26.d0*tempb1
      velyb(i, j) = velyb(i, j) - tempb1
      velyb(i, j-2) = velyb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
      velyb(i-2, j-1) = velyb(i-2, j-1) - 9.d0*tempb1
      velyb(i-2, j) = velyb(i-2, j) - 9.d0*tempb1
      velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
      velyb(i+1, j-1) = velyb(i+1, j-1) - 9.d0*tempb1
      velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1
      velyb(i+1, j) = velyb(i+1, j) - 9.d0*tempb1
      tempb1 = ccross*val_nb
      velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      velyb(i-1, j-2) = velyb(i-1, j-2) + tempb1 - tempb0
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      velyb(i, j-2) = velyb(i, j-2) - tempb - tempb0
      velyb(i, j) = velyb(i, j) + 9.d0*tempb + 9.d0*tempb0
      velyb(i, j+1) = velyb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      velyb(i+2, j-2) = velyb(i+2, j-2) + tempb1
      velyb(i+2, j-1) = velyb(i+2, j-1) - 9.d0*tempb1
      velyb(i+2, j+1) = velyb(i+2, j+1) + tempb1
      velyb(i+2, j) = velyb(i+2, j) - 9.d0*tempb1
      velyb(i+1, j-1) = velyb(i+1, j-1) + 9.d0*tempb
      velyb(i+1, j-2) = velyb(i+1, j-2) - tempb
      velyb(i+1, j) = velyb(i+1, j) + 9.d0*tempb
      velyb(i+1, j+1) = velyb(i+1, j+1) - tempb
      uy = ad_save0
      tempb1 = volm1*uyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      ux = ad_save
      tempb1 = volm1*uxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      velxb(i, j) = velxb(i, j) + 26.d0*tempb1
      velxb(i, j+1) = velxb(i, j+1) - tempb1
      velxb(i, j-1) = velxb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      velxb(i, j-1) = velxb(i, j-1) + 26.d0*tempb1
      velxb(i, j) = velxb(i, j) - tempb1
      velxb(i, j-2) = velxb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
      velxb(i-2, j-1) = velxb(i-2, j-1) - 9.d0*tempb1
      velxb(i-2, j) = velxb(i-2, j) - 9.d0*tempb1
      velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
      velxb(i+1, j-1) = velxb(i+1, j-1) - 9.d0*tempb1
      velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1
      velxb(i+1, j) = velxb(i+1, j) - 9.d0*tempb1
      velxb(i, j) = velxb(i, j) + 9.d0*tempb
      tempb1 = ccross*val_nb
      velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      velxb(i-1, j-2) = velxb(i-1, j-2) + tempb1 - tempb0
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      velxb(i, j-2) = velxb(i, j-2) - tempb - tempb0
      velxb(i, j+1) = velxb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      velxb(i+2, j-2) = velxb(i+2, j-2) + tempb1
      velxb(i+2, j-1) = velxb(i+2, j-1) - 9.d0*tempb1
      velxb(i+2, j+1) = velxb(i+2, j+1) + tempb1
      velxb(i+2, j) = velxb(i+2, j) - 9.d0*tempb1
      velxb(i+1, j-1) = velxb(i+1, j-1) + 9.d0*tempb
      velxb(i+1, j-2) = velxb(i+1, j-2) - tempb
      velxb(i+1, j+1) = velxb(i+1, j+1) - tempb
      lambdab = ty*gvroe1b + tx*fvroe1b
      tyb = lambda*gvroe1b
      uub = gvrou1*gvroe1b + fvrou1*fvroe1b
      vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
      wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
      wyb = mmu*gvrow1b
      tempb1 = twothird*gvrov1b
      mmub = wy*gvrow1b + (two*vy-ux)*tempb1
      vyb = two*mmu*tempb1
      uxb = -(mmu*tempb1)
      uyb = mmu*gvrou1b + mmu*fvrov1b
      vxb = mmu*gvrou1b + mmu*fvrov1b
      txb = lambda*fvroe1b
      wxb = mmu*fvrow1b
      tempb1 = twothird*fvrou1b
      mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (&
&       two*ux-vy)*tempb1 + cpprandtl*lambdab
      uxb = uxb + two*mmu*tempb1
      vyb = vyb - mmu*tempb1
      tempb1 = 0.0625d0*mmub
      mub(i-1, j) = mub(i-1, j) + 9.d0*tempb1
      mub(i-2, j) = mub(i-2, j) - tempb1
      mub(i, j) = mub(i, j) + 9.d0*tempb1
      mub(i+1, j) = mub(i+1, j) - tempb1
      tempb1 = 0.0625d0*wwb
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb1
      velzb(i-2, j) = velzb(i-2, j) - tempb1
      velzb(i, j) = velzb(i, j) + 9.d0*tempb1
      velzb(i+1, j) = velzb(i+1, j) - tempb1
      tempb1 = 0.0625d0*vvb
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb1
      velyb(i-2, j) = velyb(i-2, j) - tempb1
      velyb(i, j) = velyb(i, j) + 9.d0*tempb1
      velyb(i+1, j) = velyb(i+1, j) - tempb1
      tempb1 = 0.0625d0*uub
      velxb(i+1, j) = velxb(i+1, j) + 9.d0*tempb - tempb1
      velxb(i, j) = velxb(i, j) + 9.d0*tempb0 + 9.d0*tempb1
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1
      velxb(i-2, j) = velxb(i-2, j) - tempb1
      ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
      ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
      ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
      ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
      volm1 = volf(i, j, 1)
      tempb1 = volm1*tyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
      nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
      nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
      nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
      tempb1 = volm1*txb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      tlocb(i-2, j-1) = tlocb(i-2, j-1) + tempb1
      tlocb(i-1, j-1) = tlocb(i-1, j-1) - 9.d0*tempb1
      tlocb(i, j-1) = tlocb(i, j-1) - 9.d0*tempb1
      tlocb(i+1, j-1) = tlocb(i+1, j-1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      tlocb(i-2, j+2) = tlocb(i-2, j+2) + tempb1
      tlocb(i-1, j+2) = tlocb(i-1, j+2) - 9.d0*tempb1
      tlocb(i+1, j+2) = tlocb(i+1, j+2) + tempb1
      tlocb(i, j+2) = tlocb(i, j+2) - 9.d0*tempb1
      tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb0
      tlocb(i-2, j) = tlocb(i-2, j) - tempb0
      tlocb(i, j) = tlocb(i, j) + 9.d0*tempb0
      tlocb(i+1, j) = tlocb(i+1, j) - tempb0
      tempb1 = ccross*val_eb
      tlocb(i-1, j+1) = tlocb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
      tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1 - tempb
      tlocb(i, j+1) = tlocb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
      tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1 - tempb
      tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
      tlocb(i-1, j-2) = tlocb(i-1, j-2) - 9.d0*tempb1
      tlocb(i, j-2) = tlocb(i, j-2) - 9.d0*tempb1
      tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0
      tlocb(i-2, j-1) = tlocb(i-2, j-1) - tempb0
      tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb0
      tlocb(i+1, j-1) = tlocb(i+1, j-1) - tempb0
      tempb1 = twentyfourth*val_sb
      tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
      tlocb(i-2, j) = tlocb(i-2, j) - tempb - tempb1
      tlocb(i, j) = tlocb(i, j) + 9.d0*tempb - tempb1
      tempb1 = twentyfourth*val_nb
      tlocb(i+1, j) = tlocb(i+1, j) - tempb - tempb1
      tlocb(i, j) = tlocb(i, j) + 26.d0*tempb1
      tlocb(i-1, j) = tlocb(i-1, j) - tempb1
      tempb1 = volm1*wyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tempb1 = volm1*wxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      velzb(i-2, j-1) = velzb(i-2, j-1) + tempb1
      velzb(i-1, j-1) = velzb(i-1, j-1) - 9.d0*tempb1
      velzb(i, j-1) = velzb(i, j-1) - 9.d0*tempb1
      velzb(i+1, j-1) = velzb(i+1, j-1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velzb(i-2, j+2) = velzb(i-2, j+2) + tempb1
      velzb(i-1, j+2) = velzb(i-1, j+2) - 9.d0*tempb1
      velzb(i+1, j+2) = velzb(i+1, j+2) + tempb1
      velzb(i, j+2) = velzb(i, j+2) - 9.d0*tempb1
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0
      velzb(i-2, j) = velzb(i-2, j) - tempb0
      velzb(i, j) = velzb(i, j) + 9.d0*tempb0
      velzb(i+1, j) = velzb(i+1, j) - tempb0
      tempb1 = ccross*val_eb
      velzb(i-1, j+1) = velzb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
      velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1 - tempb
      velzb(i, j+1) = velzb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
      velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1 - tempb
      velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
      velzb(i-1, j-2) = velzb(i-1, j-2) - 9.d0*tempb1
      velzb(i, j-2) = velzb(i, j-2) - 9.d0*tempb1
      velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0
      velzb(i-2, j-1) = velzb(i-2, j-1) - tempb0
      velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb0
      velzb(i+1, j-1) = velzb(i+1, j-1) - tempb0
      tempb1 = twentyfourth*val_sb
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
      velzb(i-2, j) = velzb(i-2, j) - tempb - tempb1
      velzb(i, j) = velzb(i, j) + 9.d0*tempb - tempb1
      tempb1 = twentyfourth*val_nb
      velzb(i+1, j) = velzb(i+1, j) - tempb - tempb1
      velzb(i, j) = velzb(i, j) + 26.d0*tempb1
      velzb(i-1, j) = velzb(i-1, j) - tempb1
      tempb1 = volm1*vyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tempb1 = volm1*vxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      velyb(i-2, j-1) = velyb(i-2, j-1) + tempb1
      velyb(i-1, j-1) = velyb(i-1, j-1) - 9.d0*tempb1
      velyb(i, j-1) = velyb(i, j-1) - 9.d0*tempb1
      velyb(i+1, j-1) = velyb(i+1, j-1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velyb(i-2, j+2) = velyb(i-2, j+2) + tempb1
      velyb(i-1, j+2) = velyb(i-1, j+2) - 9.d0*tempb1
      velyb(i+1, j+2) = velyb(i+1, j+2) + tempb1
      velyb(i, j+2) = velyb(i, j+2) - 9.d0*tempb1
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0
      velyb(i-2, j) = velyb(i-2, j) - tempb0
      velyb(i, j) = velyb(i, j) + 9.d0*tempb0
      velyb(i+1, j) = velyb(i+1, j) - tempb0
      tempb1 = ccross*val_eb
      velyb(i-1, j+1) = velyb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
      velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1 - tempb
      velyb(i, j+1) = velyb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
      velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1 - tempb
      velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
      velyb(i-1, j-2) = velyb(i-1, j-2) - 9.d0*tempb1
      velyb(i, j-2) = velyb(i, j-2) - 9.d0*tempb1
      velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0
      velyb(i-2, j-1) = velyb(i-2, j-1) - tempb0
      velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb0
      velyb(i+1, j-1) = velyb(i+1, j-1) - tempb0
      tempb1 = twentyfourth*val_sb
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
      velyb(i-2, j) = velyb(i-2, j) - tempb - tempb1
      velyb(i, j) = velyb(i, j) + 9.d0*tempb - tempb1
      tempb1 = twentyfourth*val_nb
      velyb(i+1, j) = velyb(i+1, j) - tempb - tempb1
      velyb(i, j) = velyb(i, j) + 26.d0*tempb1
      velyb(i-1, j) = velyb(i-1, j) - tempb1
      tempb1 = volm1*uyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tempb1 = volm1*uxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velxb(i-2, j+2) = velxb(i-2, j+2) + tempb1
      velxb(i-1, j+2) = velxb(i-1, j+2) - 9.d0*tempb1
      velxb(i+1, j+2) = velxb(i+1, j+2) + tempb1
      velxb(i, j+2) = velxb(i, j+2) - 9.d0*tempb1
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0
      velxb(i-2, j) = velxb(i-2, j) - tempb0
      velxb(i, j) = velxb(i, j) + 9.d0*tempb0
      velxb(i+1, j) = velxb(i+1, j) - tempb0
      tempb0 = ccross*val_eb
      velxb(i-1, j+1) = velxb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb0
      velxb(i-2, j+1) = velxb(i-2, j+1) + tempb0 - tempb
      velxb(i, j+1) = velxb(i, j+1) + 9.d0*tempb - 9.d0*tempb0
      velxb(i+1, j+1) = velxb(i+1, j+1) + tempb0 - tempb
      velxb(i-2, j-2) = velxb(i-2, j-2) + tempb0
      velxb(i-1, j-2) = velxb(i-1, j-2) - 9.d0*tempb0
      velxb(i, j-2) = velxb(i, j-2) - 9.d0*tempb0
      velxb(i+1, j-2) = velxb(i+1, j-2) + tempb0
      tempb = 7.d0*tempb0
      velxb(i-2, j-1) = velxb(i-2, j-1) + tempb1 - tempb
      velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb - 9.d0*tempb1
      velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb - 9.d0*tempb1
      velxb(i+1, j-1) = velxb(i+1, j-1) + tempb1 - tempb
      tempb1 = 7.d0*tempb0
      tempb0 = twentyfourth*val_sb
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1 + 26.d0*tempb0
      velxb(i-2, j) = velxb(i-2, j) - tempb1 - tempb0
      velxb(i, j) = velxb(i, j) + 9.d0*tempb1 - tempb0
      tempb0 = twentyfourth*val_nb
      velxb(i+1, j) = velxb(i+1, j) - tempb1 - tempb0
      velxb(i, j) = velxb(i, j) + 26.d0*tempb0
      velxb(i-1, j) = velxb(i-1, j) - tempb0
      tempb0 = nx(i, j, 2)*fxroe2b
      tempb = ny(i, j, 2)*fxroe2b
      gb(i, j, 5) = gb(i, j, 5) + c1*tempb
      gb(i, j-1, 5) = gb(i, j-1, 5) + c1*tempb
      gb(i, j+1, 5) = gb(i, j+1, 5) + c2*tempb
      gb(i, j-2, 5) = gb(i, j-2, 5) + c2*tempb
      gb(i, j+2, 5) = gb(i, j+2, 5) + c3*tempb
      gb(i, j-3, 5) = gb(i, j-3, 5) + c3*tempb
      fb(i, j, 5) = fb(i, j, 5) + c1*tempb0
      fb(i, j-1, 5) = fb(i, j-1, 5) + c1*tempb0
      fb(i, j+1, 5) = fb(i, j+1, 5) + c2*tempb0
      fb(i, j-2, 5) = fb(i, j-2, 5) + c2*tempb0
      fb(i, j+2, 5) = fb(i, j+2, 5) + c3*tempb0
      fb(i, j-3, 5) = fb(i, j-3, 5) + c3*tempb0
      tempb0 = nx(i, j, 2)*fxrow2b
      tempb = ny(i, j, 2)*fxrow2b
      gb(i, j, 4) = gb(i, j, 4) + c1*tempb
      gb(i, j-1, 4) = gb(i, j-1, 4) + c1*tempb
      gb(i, j+1, 4) = gb(i, j+1, 4) + c2*tempb
      gb(i, j-2, 4) = gb(i, j-2, 4) + c2*tempb
      gb(i, j+2, 4) = gb(i, j+2, 4) + c3*tempb
      gb(i, j-3, 4) = gb(i, j-3, 4) + c3*tempb
      fb(i, j, 4) = fb(i, j, 4) + c1*tempb0
      fb(i, j-1, 4) = fb(i, j-1, 4) + c1*tempb0
      fb(i, j+1, 4) = fb(i, j+1, 4) + c2*tempb0
      fb(i, j-2, 4) = fb(i, j-2, 4) + c2*tempb0
      fb(i, j+2, 4) = fb(i, j+2, 4) + c3*tempb0
      fb(i, j-3, 4) = fb(i, j-3, 4) + c3*tempb0
      tempb0 = nx(i, j, 2)*fxrov2b
      tempb = ny(i, j, 2)*fxrov2b
      gb(i, j, 3) = gb(i, j, 3) + c1*tempb
      gb(i, j-1, 3) = gb(i, j-1, 3) + c1*tempb
      gb(i, j+1, 3) = gb(i, j+1, 3) + c2*tempb
      gb(i, j-2, 3) = gb(i, j-2, 3) + c2*tempb
      gb(i, j+2, 3) = gb(i, j+2, 3) + c3*tempb
      gb(i, j-3, 3) = gb(i, j-3, 3) + c3*tempb
      fb(i, j, 3) = fb(i, j, 3) + c1*tempb0
      fb(i, j-1, 3) = fb(i, j-1, 3) + c1*tempb0
      fb(i, j+1, 3) = fb(i, j+1, 3) + c2*tempb0
      fb(i, j-2, 3) = fb(i, j-2, 3) + c2*tempb0
      fb(i, j+2, 3) = fb(i, j+2, 3) + c3*tempb0
      fb(i, j-3, 3) = fb(i, j-3, 3) + c3*tempb0
      tempb0 = nx(i, j, 2)*fxrou2b
      tempb = ny(i, j, 2)*fxrou2b
      gb(i, j, 2) = gb(i, j, 2) + c1*tempb
      gb(i, j-1, 2) = gb(i, j-1, 2) + c1*tempb
      gb(i, j+1, 2) = gb(i, j+1, 2) + c2*tempb
      gb(i, j-2, 2) = gb(i, j-2, 2) + c2*tempb
      gb(i, j+2, 2) = gb(i, j+2, 2) + c3*tempb
      gb(i, j-3, 2) = gb(i, j-3, 2) + c3*tempb
      fb(i, j, 2) = fb(i, j, 2) + c1*tempb0
      fb(i, j-1, 2) = fb(i, j-1, 2) + c1*tempb0
      fb(i, j+1, 2) = fb(i, j+1, 2) + c2*tempb0
      fb(i, j-2, 2) = fb(i, j-2, 2) + c2*tempb0
      fb(i, j+2, 2) = fb(i, j+2, 2) + c3*tempb0
      fb(i, j-3, 2) = fb(i, j-3, 2) + c3*tempb0
      tempb0 = nx(i, j, 2)*fxro2b
      tempb = ny(i, j, 2)*fxro2b
      gb(i, j, 1) = gb(i, j, 1) + c1*tempb
      gb(i, j-1, 1) = gb(i, j-1, 1) + c1*tempb
      gb(i, j+1, 1) = gb(i, j+1, 1) + c2*tempb
      gb(i, j-2, 1) = gb(i, j-2, 1) + c2*tempb
      gb(i, j+2, 1) = gb(i, j+2, 1) + c3*tempb
      gb(i, j-3, 1) = gb(i, j-3, 1) + c3*tempb
      fb(i, j, 1) = fb(i, j, 1) + c1*tempb0
      fb(i, j-1, 1) = fb(i, j-1, 1) + c1*tempb0
      fb(i, j+1, 1) = fb(i, j+1, 1) + c2*tempb0
      fb(i, j-2, 1) = fb(i, j-2, 1) + c2*tempb0
      fb(i, j+2, 1) = fb(i, j+2, 1) + c3*tempb0
      fb(i, j-3, 1) = fb(i, j-3, 1) + c3*tempb0
      tempb0 = nx(i, j, 1)*fxroe1b
      tempb = ny(i, j, 1)*fxroe1b
      gb(i, j, 5) = gb(i, j, 5) + c1*tempb
      gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb
      gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb
      gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb
      gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb
      gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb
      fb(i, j, 5) = fb(i, j, 5) + c1*tempb0
      fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb0
      fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb0
      fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb0
      fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb0
      fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb0
      tempb0 = nx(i, j, 1)*fxrow1b
      tempb = ny(i, j, 1)*fxrow1b
      gb(i, j, 4) = gb(i, j, 4) + c1*tempb
      gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb
      gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb
      gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb
      gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb
      gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb
      fb(i, j, 4) = fb(i, j, 4) + c1*tempb0
      fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb0
      fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb0
      fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb0
      fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb0
      fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb0
      tempb0 = nx(i, j, 1)*fxrov1b
      tempb = ny(i, j, 1)*fxrov1b
      gb(i, j, 3) = gb(i, j, 3) + c1*tempb
      gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb
      gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb
      gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb
      gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb
      gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb
      fb(i, j, 3) = fb(i, j, 3) + c1*tempb0
      fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb0
      fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb0
      fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb0
      fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb0
      fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb0
      tempb0 = nx(i, j, 1)*fxrou1b
      tempb = ny(i, j, 1)*fxrou1b
      gb(i, j, 2) = gb(i, j, 2) + c1*tempb
      gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb
      gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb
      gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb
      gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb
      gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb
      fb(i, j, 2) = fb(i, j, 2) + c1*tempb0
      fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb0
      fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb0
      fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb0
      fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb0
      fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb0
      tempb0 = nx(i, j, 1)*fxro1b
      tempb = ny(i, j, 1)*fxro1b
      gb(i, j, 1) = gb(i, j, 1) + c1*tempb
      gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb
      gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb
      gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb
      gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb
      gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb
      fb(i, j, 1) = fb(i, j, 1) + c1*tempb0
      fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb0
      fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb0
      fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb0
      fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb0
      fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb0
    END DO
  END DO
  wb = 0.0_8
  pb = 0.0_8
!$BWD-OF II-LOOP 
  DO j=1-gh,jm+gh
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1-gh,im+gh
      ro = w(i, j, 1)
      rom1 = one/ro
      velx(i, j) = w(i, j, 2)*rom1
      vely(i, j) = w(i, j, 3)*rom1
      velz(i, j) = w(i, j, 4)*rom1
!
      ec = half*(velx(i, j)*velx(i, j)+vely(i, j)*vely(i, j)+velz(i, j)*&
&       velz(i, j))
! ec  = HALF*( velx(i,j)*velx(i,j) &
!            + vely(i,j)*vely(i,j))
!
      eloc = (w(i, j, 5)-ec*ro)*rom1
!
      tloc(i, j) = eloc*cvm1
!
      p(i, j) = (gam-one)*ro*eloc
!  p(i,j)  = ro*rgaz*tloc(i,j)
      htot = (w(i, j, 5)+p(i, j))*rom1
!h(i,j,1)  = w(i,j,4)
!h(i,j,2)  = w(i,j,4) * velx(i,j)
!h(i,j,3)  = w(i,j,4) * vely(i,j)
!h(i,j,4)  = w(i,j,4) * velz(i,j) + p(i,j)
!h(i,j,5)  = w(i,j,4) * htot
      temp = tloc(i, j)/(s_suth+tloc(i, j))
      temp0 = SQRT(tloc(i, j))
      tempb = temp0*betas*mub(i, j)/(s_suth+tloc(i, j))
      IF (tloc(i, j) .EQ. 0.0) THEN
        tlocb(i, j) = tlocb(i, j) + (1.0-temp)*tempb
      ELSE
        tlocb(i, j) = tlocb(i, j) + temp*betas*mub(i, j)/(2.0*temp0) + (&
&         1.0-temp)*tempb
      END IF
      mub(i, j) = 0.0_8
      htotb = w(i, j, 3)*gb(i, j, 5) + w(i, j, 2)*fb(i, j, 5)
      pb(i, j) = pb(i, j) + gb(i, j, 3) + fb(i, j, 2) + rom1*htotb
      elocb = ro*(gam-one)*pb(i, j) + cvm1*tlocb(i, j)
      tlocb(i, j) = 0.0_8
      tempb = rom1*elocb
      wb(i, j, 5) = wb(i, j, 5) + rom1*htotb + tempb
      rob = eloc*(gam-one)*pb(i, j) - ec*tempb
      pb(i, j) = 0.0_8
      ecb = -(ro*tempb)
      tempb = half*ecb
      velzb(i, j) = velzb(i, j) + w(i, j, 3)*gb(i, j, 4) + w(i, j, 2)*fb&
&       (i, j, 4) + 2*velz(i, j)*tempb
      velyb(i, j) = velyb(i, j) + w(i, j, 3)*gb(i, j, 3) + w(i, j, 2)*fb&
&       (i, j, 3) + 2*vely(i, j)*tempb
      wb(i, j, 3) = wb(i, j, 3) + htot*gb(i, j, 5) + velz(i, j)*gb(i, j&
&       , 4) + vely(i, j)*gb(i, j, 3) + velx(i, j)*gb(i, j, 2) + gb(i, j&
&       , 1) + rom1*velyb(i, j)
      gb(i, j, 5) = 0.0_8
      gb(i, j, 4) = 0.0_8
      gb(i, j, 3) = 0.0_8
      velxb(i, j) = velxb(i, j) + w(i, j, 3)*gb(i, j, 2) + w(i, j, 2)*fb&
&       (i, j, 2) + 2*velx(i, j)*tempb
      gb(i, j, 2) = 0.0_8
      gb(i, j, 1) = 0.0_8
      wb(i, j, 2) = wb(i, j, 2) + htot*fb(i, j, 5) + velz(i, j)*fb(i, j&
&       , 4) + vely(i, j)*fb(i, j, 3) + velx(i, j)*fb(i, j, 2) + fb(i, j&
&       , 1) + rom1*velxb(i, j)
      fb(i, j, 5) = 0.0_8
      fb(i, j, 4) = 0.0_8
      fb(i, j, 3) = 0.0_8
      fb(i, j, 2) = 0.0_8
      fb(i, j, 1) = 0.0_8
      rom1b = (w(i, j, 5)+p(i, j))*htotb + (w(i, j, 5)-ec*ro)*elocb + w(&
&       i, j, 4)*velzb(i, j) + w(i, j, 3)*velyb(i, j) + w(i, j, 2)*velxb&
&       (i, j)
      wb(i, j, 4) = wb(i, j, 4) + rom1*velzb(i, j)
      velzb(i, j) = 0.0_8
      velyb(i, j) = 0.0_8
      velxb(i, j) = 0.0_8
      rob = rob - one*rom1b/ro**2
      wb(i, j, 1) = wb(i, j, 1) + rob
    END DO
  END DO
END SUBROUTINE FLUX_NUM_DNC5_NOWALL_NODISS_2D_B
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

