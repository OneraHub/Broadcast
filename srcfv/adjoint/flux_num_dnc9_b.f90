! This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (master) -  9 Oct 2020 17:47
!
!  Differentiation of flux_num_dnc9_2d in reverse (adjoint) mode (with options with!SliceDeadControl with!SliceDeadInstrs with!St
!aticTaping):
!   gradient     of useful results: residu
!   with respect to varying inputs: w residu
!   RW status of diff variables: w:out residu:in-out
! =============================================================================
!          consistent fluxes for DNC9 2D
! =============================================================================
!
SUBROUTINE FLUX_NUM_DNC9_2D_B(residu, residub, w, wb, x0, y0, nx, ny, xc&
& , yc, vol, volf, gh, cp, cv, prandtl, gam, rgaz, cs, muref, tref, &
& s_suth, k2, k4, im, jm)
  IMPLICIT NONE
! variables for dimension -----------------------------------------
  INTEGER :: im, jm, gh
! required arguments ----------------------------------------------
! thermo
  REAL*8, INTENT(IN) :: cp, cv, prandtl, gam, rgaz
! dissipation
  REAL*8, INTENT(IN) :: k2, k4
! viscosity
  REAL*8, INTENT(IN) :: cs, muref, tref, s_suth
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: x0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: y0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: nx
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: ny
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: xc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: yc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: vol
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2), INTENT(IN) :: volf
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: w
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: wb
! Returned objects ------------------------------------------------
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(INOUT) :: residu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(INOUT) :: residub
! Non-required arguments -------------------------------------------
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 5, 2) :: hn
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 5, 2) :: hnb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: f, g
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: fb, gb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velx
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velxb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: vely
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velyb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velz
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velzb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tloc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tlocb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: p
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: pb
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mub
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradu, gradv, gradw, &
& gradmu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradub, gradvb
  REAL*8, DIMENSION(5) :: deltar, deltal, t
  INTEGER :: i, j, h
  REAL*8 :: nx_n, nx_s, nx_e, nx_o, volm1, ux, vx, wx, tx
  REAL*8 :: uxb, vxb, wxb, txb
  REAL*8 :: ny_n, ny_s, ny_e, ny_o, uy, vy, wy, ty
  REAL*8 :: uyb, vyb, wyb, tyb
  REAL*8 :: val_n, val_s, val_e, val_o
  REAL*8 :: val_nb, val_sb, val_eb, val_ob
  REAL*8 :: fxro1, fxro2, fxrou1, fxrou2, fxrov1, fxrov2, fxrow1, fxrow2&
& , fxroe1, fxroe2
  REAL*8 :: fxro1b, fxro2b, fxrou1b, fxrou2b, fxrov1b, fxrov2b, fxrow1b&
& , fxrow2b, fxroe1b, fxroe2b
  REAL*8 :: fvro1, fvro2, fvrou1, fvrou2, fvrov1, fvrov2, fvrow1, fvrow2&
& , fvroe1, fvroe2
  REAL*8 :: fvrou1b, fvrou2b, fvrov1b, fvrov2b, fvrow1b, fvrow2b, &
& fvroe1b, fvroe2b
  REAL*8 :: gvro1, gvro2, gvrou1, gvrou2, gvrov1, gvrov2, gvrow1, gvrow2&
& , gvroe1, gvroe2
  REAL*8 :: gvrou1b, gvrou2b, gvrov1b, gvrov2b, gvrow1b, gvrow2b, &
& gvroe1b, gvroe2b
  REAL*8 :: dissro1, dissro2, dissrou1, dissrou2, dissrov1, dissrov2, &
& dissrow1, dissrow2, dissroe1, dissroe2
  REAL*8 :: dissro1b, dissro2b, dissrou1b, dissrou2b, dissrov1b, &
& dissrov2b, dissrow1b, dissrow2b, dissroe1b, dissroe2b
  REAL*8 :: cpprandtl, mmu, lambda, uu, vv, ww, ro, rom1, htot, eloc, ec
  REAL*8 :: mmub, lambdab, uub, vvb, wwb, rob, rom1b, htotb, elocb, ecb
  REAL*8 :: predro1, predrou1, predrov1, predrow1, predroe1, eps2, eps4
  REAL*8 :: predro1b, predrou1b, predrov1b, predrow1b, predroe1b, eps2b&
& , eps4b
  REAL*8 :: predro2, predrou2, predrov2, predrow2, predroe2, rspec
  REAL*8 :: predro2b, predrou2b, predrov2b, predrow2b, predroe2b, rspecb
  REAL*8 :: nxloc, nyloc, sn, invsn, sc1, sc2
  REAL*8 :: divu, divu2, vort2, dxm1, dym1, dxm2, dym2
  REAL*8 :: divub, divu2b, vort2b, dxm1b, dxm2b
  REAL*8 :: gui, gvi, gwi, gmui
  REAL*8 :: guib, gvib
  REAL*8 :: guj, gvj, gwj, gmuj
  REAL*8 :: gujb, gvjb
  REAL*8 :: rhom, rhomr, rhoml, rhom1l, c2l, c2r, rr, r, u, ur, ul, vr, &
& vl, wr, wl, c2x, nx2, ny2
  REAL*8 :: rhomrb, rhomlb, c2lb, c2rb, rrb, rb, ub, urb, ulb, vrb, vlb&
& , c2xb
  REAL*8 :: ab, sq, ducros1, ducros2, k_sensor1, k_sensor2
  REAL*8 :: abb, sqb, ducros1b, ducros2b, k_sensor1b, k_sensor2b
  REAL*8 :: b1, b2, b3, b4, b5, c1, c2, c3, c4, c5, d1, d2, d3, d4, d5, &
& wiggle, denom, betas
! for bnd off-centered schemes
  REAL*8 :: a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10
  REAL*8 :: c9d0, c9d1, c9d2, c9d3, c9d4, c9d5, c9d6, c9d7, c9d8, c9d9, &
& c9d10
  REAL*8 :: c7d0, c7d1, c7d2, c7d3, c7d4, c7d5, c7d6, c7d7, c7d8, c7d9, &
& c7d10
  REAL*8 :: c5d0, c5d1, c5d2, c5d3, c5d4, c5d5, c5d6, c5d7, c5d8, c5d9, &
& c5d10
  REAL*8 :: c3d0, c3d1, c3d2, c3d3, c3d4, c3d5, c3d6, c3d7, c3d8, c3d9, &
& c3d10
  REAL*8 :: pw, ct0, ct1, ct2, coef, omrr, test, diffro, diffrou, &
& diffrov, diffrow, diffroe, v
  REAL*8 :: pwb, coefb, omrrb, diffrob, diffroub, diffrovb, diffrowb, &
& diffroeb, vb
  REAL*8 :: half, one, zero, two, twothird, fourth, twelfth, cvm1
  REAL*8 :: twentyfourth, ccross
  REAL*8 :: mach2, alpha, vn2, cprim
  REAL*8 :: mach2b, alphab, vn2b, cprimb
  INTRINSIC SQRT
  INTRINSIC MIN
  INTRINSIC ABS
  INTRINSIC TANH
  INTRINSIC MAX
  REAL*8 :: x1
  REAL*8 :: x1b
  REAL*8 :: x2
  REAL*8 :: x2b
  REAL*8 :: x3
  REAL*8 :: x3b
  REAL*8 :: x4
  REAL*8 :: x4b
  REAL*8 :: x5
  REAL*8 :: x5b
  REAL*8 :: x6
  REAL*8 :: x6b
  REAL*8 :: x7
  REAL*8 :: x7b
  REAL*8 :: x8
  REAL*8 :: x8b
  REAL*8 :: x9
  REAL*8 :: x9b
  REAL*8 :: x10
  REAL*8 :: x10b
  REAL*8 :: x11
  REAL*8 :: x11b
  REAL*8 :: x12
  REAL*8 :: x12b
  REAL*8 :: x13
  REAL*8 :: x13b
  REAL*8 :: x14
  REAL*8 :: x14b
  REAL*8 :: x15
  REAL*8 :: x15b
  REAL*8 :: x16
  REAL*8 :: x16b
  REAL*8 :: x17
  REAL*8 :: x17b
  REAL*8 :: x18
  REAL*8 :: x18b
  REAL*8 :: x19
  REAL*8 :: x19b
  REAL*8 :: x20
  REAL*8 :: x20b
  REAL*8 :: x21
  REAL*8 :: x21b
  REAL*8 :: x22
  REAL*8 :: x22b
  REAL*8 :: x23
  REAL*8 :: x23b
  REAL*8 :: x24
  REAL*8 :: x24b
  REAL*8 :: x25
  REAL*8 :: x25b
  REAL*8 :: x26
  REAL*8 :: x26b
  REAL*8 :: x27
  REAL*8 :: x27b
  REAL*8 :: x28
  REAL*8 :: x28b
  REAL*8 :: x29
  REAL*8 :: x29b
  REAL*8 :: x30
  REAL*8 :: x30b
  REAL*8 :: x31
  REAL*8 :: x31b
  REAL*8 :: x32
  REAL*8 :: x32b
  REAL*8 :: x33
  REAL*8 :: x33b
  REAL*8 :: abs0
  REAL*8 :: abs0b
  REAL*8 :: abs1
  REAL*8 :: abs1b
  REAL*8 :: abs2
  REAL*8 :: abs2b
  REAL*8 :: abs3
  REAL*8 :: abs3b
  REAL*8 :: abs4
  REAL*8 :: abs4b
  REAL*8 :: abs5
  REAL*8 :: abs5b
  REAL*8 :: abs6
  REAL*8 :: abs6b
  REAL*8 :: abs7
  REAL*8 :: abs7b
  REAL*8 :: abs8
  REAL*8 :: abs8b
  REAL*8 :: abs9
  REAL*8 :: abs9b
  REAL*8 :: abs10
  REAL*8 :: abs10b
  REAL*8 :: abs11
  REAL*8 :: abs11b
  REAL*8 :: abs12
  REAL*8 :: abs12b
  REAL*8 :: abs13
  REAL*8 :: abs13b
  REAL*8 :: abs14
  REAL*8 :: abs14b
  REAL*8 :: abs15
  REAL*8 :: abs15b
  REAL*8 :: abs16
  REAL*8 :: abs16b
  REAL*8 :: abs17
  REAL*8 :: abs17b
  REAL*8 :: abs18
  REAL*8 :: abs18b
  REAL*8 :: abs19
  REAL*8 :: abs19b
  REAL*8 :: abs20
  REAL*8 :: abs20b
  REAL*8 :: abs21
  REAL*8 :: abs21b
  REAL*8 :: abs22
  REAL*8 :: abs22b
  REAL*8 :: abs23
  REAL*8 :: abs23b
  REAL*8 :: abs24
  REAL*8 :: abs24b
  REAL*8 :: abs25
  REAL*8 :: abs25b
  REAL*8 :: abs26
  REAL*8 :: abs26b
  REAL*8 :: abs27
  REAL*8 :: abs27b
  REAL*8 :: abs28
  REAL*8 :: abs28b
  REAL*8 :: abs29
  REAL*8 :: abs29b
  REAL*8 :: abs30
  REAL*8 :: abs30b
  REAL*8 :: abs31
  REAL*8 :: abs31b
  REAL*8 :: abs32
  REAL*8 :: abs32b
  REAL*8 :: abs33
  REAL*8 :: abs33b
  REAL*8 :: abs34
  REAL*8 :: abs34b
  REAL*8 :: abs35
  REAL*8 :: abs35b
  REAL*8 :: abs36
  REAL*8 :: abs36b
  REAL*8 :: abs37
  REAL*8 :: abs37b
  REAL*8 :: abs38
  REAL*8 :: abs38b
  REAL*8 :: abs39
  REAL*8 :: abs39b
  REAL*8 :: abs40
  REAL*8 :: abs40b
  REAL*8 :: abs41
  REAL*8 :: abs41b
  REAL*8 :: abs42
  REAL*8 :: abs42b
  REAL*8 :: abs43
  REAL*8 :: abs43b
  REAL*8 :: temp
  REAL*8 :: tempb
  REAL*8 :: temp0
  REAL*8 :: tempb0
  REAL*8 :: temp1
  REAL*8 :: tempb1
  REAL*8 :: ad_save
  REAL*8 :: ad_save0
  REAL*8 :: ad_save1
  REAL*8 :: ad_save2
  REAL*8 :: ad_save3
  REAL*8 :: ad_save4
  REAL*8 :: ad_save5
  REAL*8 :: ad_save6
  REAL*8 :: ad_save7
  REAL*8 :: ad_save8
  REAL*8 :: ad_save9
  REAL*8 :: ad_save10
  REAL*8 :: ad_save11
  REAL*8 :: ad_save12
  REAL*8 :: ad_save13
  REAL*8 :: ad_save14
  REAL*8 :: ad_save15
  REAL*8 :: ad_save16
  REAL*8 :: ad_save17
  REAL*8 :: ad_save18
  REAL*8 :: ad_save19
  REAL*8 :: ad_save20
  REAL*8 :: ad_save21
  REAL*8 :: ad_save22
  REAL*8 :: ad_save23
  REAL*8 :: ad_save24
  REAL*8 :: ad_save25
  REAL*8 :: ad_save26
  REAL*8 :: ad_save27
  REAL*8 :: ad_save28
  REAL*8 :: ad_save29
  REAL*8 :: ad_save30
  INTEGER :: ad_branch
  INTEGER :: ad_branch0
  INTEGER :: ad_branch1
  INTEGER :: ad_branch2
  INTEGER :: ad_branch3
  INTEGER :: ad_branch4
  INTEGER :: ad_branch5
  INTEGER :: ad_branch6
  INTEGER :: ad_branch7
  INTEGER :: ad_branch8
  INTEGER :: ad_branch9
  INTEGER :: ad_branch10
  INTEGER :: ad_branch11
  INTEGER :: ad_branch12
  INTEGER :: ad_branch13
  INTEGER :: ad_branch14
  REAL*8 :: ad_save31
  REAL*8 :: ad_save32
  REAL*8 :: ad_save33
  REAL*8 :: ad_save34
  REAL*8 :: ad_save35
  REAL*8 :: ad_save36
  REAL*8 :: ad_save37
  REAL*8 :: ad_save38
  REAL*8 :: ad_save39
  REAL*8 :: ad_save40
  REAL*8 :: ad_save41
  REAL*8 :: ad_save42
  REAL*8 :: ad_save43
  REAL*8 :: ad_save44
  REAL*8 :: ad_save45
  REAL*8 :: ad_save46
  REAL*8 :: ad_save47
  REAL*8 :: ad_save48
  REAL*8 :: ad_save49
  REAL*8 :: ad_save50
  REAL*8 :: ad_save51
  REAL*8 :: ad_save52
  REAL*8 :: ad_save53
  REAL*8 :: ad_save54
  REAL*8 :: ad_save55
  REAL*8 :: ad_save56
  REAL*8 :: ad_save57
  REAL*8 :: ad_save58
  REAL*8 :: ad_save59
  REAL*8 :: ad_save60
  REAL*8 :: ad_save61
  REAL*8 :: ad_save62
  INTEGER :: ad_branch15
  INTEGER :: ad_branch16
  INTEGER :: ad_branch17
  INTEGER :: ad_branch18
  INTEGER :: ad_branch19
  INTEGER :: ad_branch20
  INTEGER :: ad_branch21
  INTEGER :: ad_branch22
  INTEGER :: ad_branch23
  INTEGER :: ad_branch24
  INTEGER :: ad_branch25
  INTEGER :: ad_branch26
  INTEGER :: ad_branch27
  INTEGER :: ad_branch28
  INTEGER :: ad_branch29
  INTEGER :: ad_branch30
  REAL*8 :: ad_save63
  REAL*8 :: ad_save64
  REAL*8 :: ad_save65
  REAL*8 :: ad_save66
  REAL*8 :: ad_save67
  REAL*8 :: ad_save68
  REAL*8 :: ad_save69
  REAL*8 :: ad_save70
  REAL*8 :: ad_save71
  REAL*8 :: ad_save72
  REAL*8 :: ad_save73
  REAL*8 :: ad_save74
  REAL*8 :: ad_save75
  REAL*8 :: ad_save76
  REAL*8 :: ad_save77
  REAL*8 :: ad_save78
  REAL*8 :: ad_save79
  REAL*8 :: ad_save80
  REAL*8 :: ad_save81
  REAL*8 :: ad_save82
  REAL*8 :: ad_save83
  REAL*8 :: ad_save84
  REAL*8 :: ad_save85
  REAL*8 :: ad_save86
  REAL*8 :: ad_save87
  REAL*8 :: ad_save88
  REAL*8 :: ad_save89
  REAL*8 :: ad_save90
  REAL*8 :: ad_save91
  REAL*8 :: ad_save92
  REAL*8 :: ad_save93
  REAL*8 :: ad_save94
  REAL*8 :: ad_save95
  REAL*8 :: ad_save96
  REAL*8 :: ad_save97
  REAL*8 :: ad_save98
  REAL*8 :: ad_save99
  REAL*8 :: ad_save100
  REAL*8 :: ad_save101
  REAL*8 :: ad_save102
  REAL*8 :: ad_save103
  REAL*8 :: ad_save104
  REAL*8 :: ad_save105
  REAL*8 :: ad_save106
  REAL*8 :: ad_save107
  REAL*8 :: ad_save108
  REAL*8 :: ad_save109
  REAL*8 :: ad_save110
  REAL*8 :: ad_save111
  REAL*8 :: ad_save112
  REAL*8 :: ad_save113
  REAL*8 :: ad_save114
  REAL*8 :: ad_save115
  REAL*8 :: ad_save116
  REAL*8 :: ad_save117
  REAL*8 :: ad_save118
  REAL*8 :: ad_save119
  REAL*8 :: ad_save120
  REAL*8 :: ad_save121
  REAL*8 :: ad_save122
  REAL*8 :: ad_save123
  REAL*8 :: ad_save124
  REAL*8 :: ad_save125
  REAL*8 :: ad_save126
  REAL*8 :: ad_save127
  REAL*8 :: ad_save128
  REAL*8 :: ad_save129
  REAL*8 :: ad_save130
  REAL*8 :: ad_save131
  REAL*8 :: ad_save132
  REAL*8 :: ad_save133
  REAL*8 :: ad_save134
  REAL*8 :: ad_save135
  REAL*8 :: ad_save136
  REAL*8 :: ad_save137
  REAL*8 :: ad_save138
  REAL*8 :: ad_save139
  REAL*8 :: ad_save140
  REAL*8 :: ad_save141
  INTEGER :: ad_branch31
  INTEGER :: ad_branch32
  INTEGER :: ad_branch33
  INTEGER :: ad_branch34
  INTEGER :: ad_branch35
  INTEGER :: ad_branch36
  INTEGER :: ad_branch37
  INTEGER :: ad_branch38
  INTEGER :: ad_branch39
  INTEGER :: ad_branch40
  INTEGER :: ad_branch41
  INTEGER :: ad_branch42
  INTEGER :: ad_branch43
  INTEGER :: ad_branch44
  INTEGER :: ad_branch45
  INTEGER :: ad_branch46
  REAL*8 :: ad_save142
  REAL*8 :: ad_save143
  REAL*8 :: ad_save144
  REAL*8 :: ad_save145
  REAL*8 :: ad_save146
  REAL*8 :: ad_save147
  REAL*8 :: ad_save148
  REAL*8 :: ad_save149
  REAL*8 :: ad_save150
  REAL*8 :: ad_save151
  REAL*8 :: ad_save152
  REAL*8 :: ad_save153
  REAL*8 :: ad_save154
  REAL*8 :: ad_save155
  REAL*8 :: ad_save156
  REAL*8 :: ad_save157
  REAL*8 :: ad_save158
  REAL*8 :: ad_save159
  REAL*8 :: ad_save160
  REAL*8 :: ad_save161
  REAL*8 :: ad_save162
  REAL*8 :: ad_save163
  REAL*8 :: ad_save164
  REAL*8 :: ad_save165
  REAL*8 :: ad_save166
  REAL*8 :: ad_save167
  REAL*8 :: ad_save168
  REAL*8 :: ad_save169
  REAL*8 :: ad_save170
  REAL*8 :: ad_save171
  REAL*8 :: ad_save172
  REAL*8 :: ad_save173
  REAL*8 :: ad_save174
  REAL*8 :: ad_save175
  REAL*8 :: ad_save176
  REAL*8 :: ad_save177
  REAL*8 :: ad_save178
  REAL*8 :: ad_save179
  REAL*8 :: ad_save180
  REAL*8 :: ad_save181
  REAL*8 :: ad_save182
  REAL*8 :: ad_save183
  REAL*8 :: ad_save184
  REAL*8 :: ad_save185
  REAL*8 :: ad_save186
  REAL*8 :: ad_save187
  REAL*8 :: ad_save188
  REAL*8 :: ad_save189
  REAL*8 :: ad_save190
  REAL*8 :: ad_save191
  REAL*8 :: ad_save192
  REAL*8 :: ad_save193
  REAL*8 :: ad_save194
  REAL*8 :: ad_save195
  REAL*8 :: ad_save196
  REAL*8 :: ad_save197
  REAL*8 :: ad_save198
  REAL*8 :: ad_save199
  REAL*8 :: ad_save200
  REAL*8 :: ad_save201
  REAL*8 :: ad_save202
  REAL*8 :: ad_save203
  REAL*8 :: ad_save204
  REAL*8 :: ad_save205
  REAL*8 :: ad_save206
  REAL*8 :: ad_save207
  REAL*8 :: ad_save208
  REAL*8 :: ad_save209
  REAL*8 :: ad_save210
  REAL*8 :: ad_save211
  REAL*8 :: ad_save212
  REAL*8 :: ad_save213
  REAL*8 :: ad_save214
  REAL*8 :: ad_save215
  REAL*8 :: ad_save216
  REAL*8 :: ad_save217
  REAL*8 :: ad_save218
  REAL*8 :: ad_save219
  REAL*8 :: ad_save220
  INTEGER :: ad_branch47
  INTEGER :: ad_branch48
  INTEGER :: ad_branch49
  INTEGER :: ad_branch50
  INTEGER :: ad_branch51
  INTEGER :: ad_branch52
  INTEGER :: ad_branch53
  INTEGER :: ad_branch54
  INTEGER :: ad_branch55
  INTEGER :: ad_branch56
  INTEGER :: ad_branch57
  INTEGER :: ad_branch58
  INTEGER :: ad_branch59
  INTEGER :: ad_branch60
  INTEGER :: ad_branch61
  INTEGER :: ad_branch62
  REAL*8 :: ad_save221
  REAL*8 :: ad_save222
  REAL*8 :: ad_save223
  REAL*8 :: ad_save224
  REAL*8 :: ad_save225
  REAL*8 :: ad_save226
  REAL*8 :: ad_save227
  REAL*8 :: ad_save228
  REAL*8 :: ad_save229
  REAL*8 :: ad_save230
  REAL*8 :: ad_save231
  REAL*8 :: ad_save232
  REAL*8 :: ad_save233
  REAL*8 :: ad_save234
  REAL*8 :: ad_save235
  REAL*8 :: ad_save236
  REAL*8 :: ad_save237
  REAL*8 :: ad_save238
  REAL*8 :: ad_save239
  REAL*8 :: ad_save240
  REAL*8 :: ad_save241
  REAL*8 :: ad_save242
  REAL*8 :: ad_save243
  REAL*8 :: ad_save244
  REAL*8 :: ad_save245
  REAL*8 :: ad_save246
  REAL*8 :: ad_save247
  REAL*8 :: ad_save248
  REAL*8 :: ad_save249
  REAL*8 :: ad_save250
  REAL*8 :: ad_save251
  REAL*8 :: ad_save252
  REAL*8 :: ad_save253
  REAL*8 :: ad_save254
  REAL*8 :: ad_save255
  REAL*8 :: ad_save256
  REAL*8 :: ad_save257
  REAL*8 :: ad_save258
  REAL*8 :: ad_save259
  REAL*8 :: ad_save260
  REAL*8 :: ad_save261
  REAL*8 :: ad_save262
  REAL*8 :: ad_save263
  REAL*8 :: ad_save264
  REAL*8 :: ad_save265
  REAL*8 :: ad_save266
  REAL*8 :: ad_save267
  REAL*8 :: ad_save268
  REAL*8 :: ad_save269
  REAL*8 :: ad_save270
  REAL*8 :: ad_save271
  REAL*8 :: ad_save272
  REAL*8 :: ad_save273
  REAL*8 :: ad_save274
  REAL*8 :: ad_save275
  REAL*8 :: ad_save276
  REAL*8 :: ad_save277
  REAL*8 :: ad_save278
  REAL*8 :: ad_save279
  REAL*8 :: ad_save280
  REAL*8 :: ad_save281
  REAL*8 :: ad_save282
  REAL*8 :: ad_save283
  REAL*8 :: ad_save284
  REAL*8 :: ad_save285
  REAL*8 :: ad_save286
  REAL*8 :: ad_save287
  REAL*8 :: ad_save288
  REAL*8 :: ad_save289
  REAL*8 :: ad_save290
  REAL*8 :: ad_save291
  REAL*8 :: ad_save292
  REAL*8 :: ad_save293
  REAL*8 :: ad_save294
  INTEGER :: ad_branch63
  INTEGER :: ad_branch64
  INTEGER :: ad_branch65
  INTEGER :: ad_branch66
  INTEGER :: ad_branch67
  INTEGER :: ad_branch68
  INTEGER :: ad_branch69
  INTEGER :: ad_branch70
  INTEGER :: ad_branch71
  INTEGER :: ad_branch72
  INTEGER :: ad_branch73
  INTEGER :: ad_branch74
  INTEGER :: ad_branch75
  INTEGER :: ad_branch76
  INTEGER :: ad_branch77
  INTEGER :: ad_branch78
  REAL*8 :: ad_save295
  REAL*8 :: ad_save296
  REAL*8 :: ad_save297
  REAL*8 :: ad_save298
  REAL*8 :: ad_save299
  REAL*8 :: ad_save300
  REAL*8 :: ad_save301
  REAL*8 :: ad_save302
  REAL*8 :: ad_save303
  REAL*8 :: ad_save304
  REAL*8 :: ad_save305
  REAL*8 :: ad_save306
  REAL*8 :: ad_save307
  REAL*8 :: ad_save308
  REAL*8 :: ad_save309
  REAL*8 :: ad_save310
  REAL*8 :: ad_save311
  REAL*8 :: ad_save312
  REAL*8 :: ad_save313
  REAL*8 :: ad_save314
  REAL*8 :: ad_save315
  REAL*8 :: ad_save316
  REAL*8 :: ad_save317
  REAL*8 :: ad_save318
  REAL*8 :: ad_save319
  REAL*8 :: ad_save320
  REAL*8 :: ad_save321
  REAL*8 :: ad_save322
  REAL*8 :: ad_save323
  REAL*8 :: ad_save324
  REAL*8 :: ad_save325
  REAL*8 :: ad_save326
  REAL*8 :: ad_save327
  REAL*8 :: ad_save328
  REAL*8 :: ad_save329
  REAL*8 :: ad_save330
  REAL*8 :: ad_save331
  REAL*8 :: ad_save332
  REAL*8 :: ad_save333
  REAL*8 :: ad_save334
  REAL*8 :: ad_save335
  REAL*8 :: ad_save336
  REAL*8 :: ad_save337
  REAL*8 :: ad_save338
  REAL*8 :: ad_save339
  REAL*8 :: ad_save340
  REAL*8 :: ad_save341
  REAL*8 :: ad_save342
  REAL*8 :: ad_save343
  REAL*8 :: ad_save344
  REAL*8 :: ad_save345
  REAL*8 :: ad_save346
  REAL*8 :: ad_save347
  REAL*8 :: ad_save348
  INTEGER :: ad_branch79
  INTEGER :: ad_branch80
  INTEGER :: ad_branch81
  INTEGER :: ad_branch82
  INTEGER :: ad_branch83
  INTEGER :: ad_branch84
  INTEGER :: ad_branch85
  INTEGER :: ad_branch86
  REAL*8 :: ad_save349
  REAL*8 :: ad_save350
  REAL*8 :: ad_save351
  REAL*8 :: ad_save352
  REAL*8 :: ad_save353
  REAL*8 :: ad_save354
  REAL*8 :: ad_save355
  REAL*8 :: ad_save356
  REAL*8 :: ad_save357
  REAL*8 :: ad_save358
  REAL*8 :: ad_save359
  REAL*8 :: ad_save360
  REAL*8 :: ad_save361
  REAL*8 :: ad_save362
  REAL*8 :: ad_save363
  REAL*8 :: ad_save364
  REAL*8 :: ad_save365
  REAL*8 :: ad_save366
  REAL*8 :: ad_save367
  REAL*8 :: ad_save368
  REAL*8 :: ad_save369
  REAL*8 :: ad_save370
  REAL*8 :: ad_save371
  REAL*8 :: ad_save372
  REAL*8 :: ad_save373
  REAL*8 :: ad_save374
  REAL*8 :: ad_save375
  REAL*8 :: ad_save376
  REAL*8 :: ad_save377
  REAL*8 :: ad_save378
  REAL*8 :: ad_save379
  REAL*8 :: ad_save380
  REAL*8 :: ad_save381
  REAL*8 :: ad_save382
  REAL*8 :: ad_save383
  REAL*8 :: ad_save384
  REAL*8 :: ad_save385
  REAL*8 :: ad_save386
  REAL*8 :: ad_save387
  REAL*8 :: ad_save388
  REAL*8 :: ad_save389
  REAL*8 :: ad_save390
  INTEGER :: ad_save391
! -----------------------------------------------------------------
!
  half = 0.5d0
  one = 1.d0
  zero = 0.d0
  two = 2.d0
  twothird = two/3.d0
  fourth = 0.25d0
  twelfth = 0.25d0/3.d0
  twentyfourth = one/24.d0
  ccross = twelfth*0.0625d0
  cpprandtl = cp/prandtl
  cvm1 = one/cv
! k2 = 1.d0
! k4 = 1.d0/1260.d0 already in coef for predictor
!
! Coef for grad o10
  b1 = 5.d0/6.d0
  b2 = -(5.d0/21.d0)
  b3 = 5.d0/84.d0
  b4 = -(5.d0/504.d0)
  b5 = 1.d0/1260.d0
!expression for FV
! c5 = a5
! c4 = c5 + a4
! c3 = c4 + a3
! c2 = c3 + a2
! c1 = c2 + a1
  denom = 1.d0/2520.d0
!
  c1 = 1627.d0*denom
  c2 = -(473.d0*denom)
  c3 = 127.d0*denom
  c4 = -(23.d0*denom)
  c5 = 2.d0*denom
! coef for predictor
  denom = 1.d0/1260.d0
!
  d1 = 126.d0*denom
  d2 = 84.d0*denom
  d3 = 36.d0*denom
  d4 = 9.d0*denom
  d5 = denom
  betas = muref*(tref+cs)/(SQRT(tref)*tref)
!$FWD-OF II-LOOP 
! Primitives
  DO j=1-gh,jm+gh
!DIR$ IVDEP
    DO i=1-gh,im+gh
      ro = w(i, j, 1)
      rom1 = one/ro
      velx(i, j) = w(i, j, 2)*rom1
      vely(i, j) = w(i, j, 3)*rom1
      velz(i, j) = w(i, j, 4)*rom1
!
      ec = half*(velx(i, j)*velx(i, j)+vely(i, j)*vely(i, j)+velz(i, j)*&
&       velz(i, j))
! ec  = HALF*( velx(i,j)*velx(i,j) &
!            + vely(i,j)*vely(i,j))
!
      eloc = (w(i, j, 5)-ec*ro)*rom1
!
      tloc(i, j) = eloc*cvm1
!
      p(i, j) = (gam-one)*ro*eloc
!  p(i,j)  = ro*rgaz*tloc(i,j)
      htot = (w(i, j, 5)+p(i, j))*rom1
      f(i, j, 1) = w(i, j, 2)
      f(i, j, 2) = w(i, j, 2)*velx(i, j) + p(i, j)
      f(i, j, 3) = w(i, j, 2)*vely(i, j)
      f(i, j, 4) = w(i, j, 2)*velz(i, j)
      f(i, j, 5) = w(i, j, 2)*htot
      g(i, j, 1) = w(i, j, 3)
      g(i, j, 2) = w(i, j, 3)*velx(i, j)
      g(i, j, 3) = w(i, j, 3)*vely(i, j) + p(i, j)
      g(i, j, 4) = w(i, j, 3)*velz(i, j)
      g(i, j, 5) = w(i, j, 3)*htot
!h(i,j,1)  = w(i,j,4)
!h(i,j,2)  = w(i,j,4) * velx(i,j)
!h(i,j,3)  = w(i,j,4) * vely(i,j)
!h(i,j,4)  = w(i,j,4) * velz(i,j) + p(i,j)
!h(i,j,5)  = w(i,j,4) * htot
      mu(i, j) = betas/(tloc(i, j)+s_suth)*SQRT(tloc(i, j))*tloc(i, j)
    END DO
  END DO
!$FWD-OF II-LOOP 
  DO j=1,jm
!DIR$ IVDEP
    DO i=1,im
!idir
      gui = b1*(velx(i+1, j)-velx(i-1, j)) + b2*(velx(i+2, j)-velx(i-2, &
&       j)) + b3*(velx(i+3, j)-velx(i-3, j)) + b4*(velx(i+4, j)-velx(i-4&
&       , j)) + b5*(velx(i+5, j)-velx(i-5, j))
      gvi = b1*(vely(i+1, j)-vely(i-1, j)) + b2*(vely(i+2, j)-vely(i-2, &
&       j)) + b3*(vely(i+3, j)-vely(i-3, j)) + b4*(vely(i+4, j)-vely(i-4&
&       , j)) + b5*(vely(i+5, j)-vely(i-5, j))
      gwi = b1*(velz(i+1, j)-velz(i-1, j)) + b2*(velz(i+2, j)-velz(i-2, &
&       j)) + b3*(velz(i+3, j)-velz(i-3, j)) + b4*(velz(i+4, j)-velz(i-4&
&       , j)) + b5*(velz(i+5, j)-velz(i-5, j))
      gmui = b1*(mu(i+1, j)-mu(i-1, j)) + b2*(mu(i+2, j)-mu(i-2, j)) + &
&       b3*(mu(i+3, j)-mu(i-3, j)) + b4*(mu(i+4, j)-mu(i-4, j)) + b5*(mu&
&       (i+5, j)-mu(i-5, j))
!jdir
      guj = b1*(velx(i, j+1)-velx(i, j-1)) + b2*(velx(i, j+2)-velx(i, j-&
&       2)) + b3*(velx(i, j+3)-velx(i, j-3)) + b4*(velx(i, j+4)-velx(i, &
&       j-4)) + b5*(velx(i, j+5)-velx(i, j-5))
      gvj = b1*(vely(i, j+1)-vely(i, j-1)) + b2*(vely(i, j+2)-vely(i, j-&
&       2)) + b3*(vely(i, j+3)-vely(i, j-3)) + b4*(vely(i, j+4)-vely(i, &
&       j-4)) + b5*(vely(i, j+5)-vely(i, j-5))
      gwj = b1*(velz(i, j+1)-velz(i, j-1)) + b2*(velz(i, j+2)-velz(i, j-&
&       2)) + b3*(velz(i, j+3)-velz(i, j-3)) + b4*(velz(i, j+4)-velz(i, &
&       j-4)) + b5*(velz(i, j+5)-velz(i, j-5))
      gmuj = b1*(mu(i, j+1)-mu(i, j-1)) + b2*(mu(i, j+2)-mu(i, j-2)) + &
&       b3*(mu(i, j+3)-mu(i, j-3)) + b4*(mu(i, j+4)-mu(i, j-4)) + b5*(mu&
&       (i, j+5)-mu(i, j-5))
      volm1 = one/vol(i, j)
      dxm1 = half*(nx(i, j, 1)+nx(i+1, j, 1))*volm1
      dxm2 = half*(nx(i, j, 2)+nx(i, j+1, 2))*volm1
      dym1 = half*(ny(i, j, 1)+ny(i+1, j, 1))*volm1
      dym2 = half*(ny(i, j, 2)+ny(i, j+1, 2))*volm1
      gradu(i, j, 1) = dxm1*gui + dxm2*guj
      gradv(i, j, 1) = dxm1*gvi + dxm2*gvj
      gradw(i, j, 1) = dxm1*gwi + dxm2*gwj
      gradmu(i, j, 1) = dxm1*gmui + dxm2*gmuj
      gradu(i, j, 2) = dym1*gui + dym2*guj
      gradv(i, j, 2) = dym1*gvi + dym2*gvj
      gradw(i, j, 2) = dym1*gwi + dym2*gwj
      gradmu(i, j, 2) = dym1*gmui + dym2*gmuj
    END DO
  END DO
! trick for ducros in dissipation
  DO i=1,2
    DO h=1,gh
      gradu(:, 1-h, :) = two*gradu(:, 2-h, :) - gradu(:, 3-h, :)
      gradv(:, 1-h, :) = two*gradv(:, 2-h, :) - gradv(:, 3-h, :)
      gradu(:, jm+h, :) = two*gradu(:, jm-1+h, :) - gradu(:, jm-2+h, :)
      gradv(:, jm+h, :) = two*gradv(:, jm-1+h, :) - gradv(:, jm-2+h, :)
      gradu(1-h, :, :) = two*gradu(2-h, :, :) - gradu(3-h, :, :)
      gradv(1-h, :, :) = two*gradv(2-h, :, :) - gradv(3-h, :, :)
      gradu(im+h, :, :) = two*gradu(im-1+h, :, :) - gradu(im-2+h, :, :)
      gradv(im+h, :, :) = two*gradv(im-1+h, :, :) - gradv(im-2+h, :, :)
    END DO
  END DO
!
! Manage Wall Fluxes
! off centered schemes for fluxes near wall
! coef for near wall off-centered fluxes
!  coef are obtained with sympy for FD scheme
!face 9/2:
!{a8: -3/56, a1: -1/63, a5: 6/5, a7: 4/21, a2: 3/28, a9: 1/105, a10: -1/1260, a6: -1/2, a3: -4/7, a0: 1/840, a4: -11/30}
  a0 = 1.d0/840.d0
  a1 = -(1.d0/63.d0)
  a2 = 3.d0/28.d0
  a3 = -(4.d0/7.d0)
  a4 = -(11.d0/30.d0)
  a5 = 6.d0/5.d0
  a6 = -0.5d0
  a7 = 4.d0/21.d0
  a8 = -(3.d0/56.d0)
  a9 = 1.d0/105.d0
  a10 = -(1.d0/1260.d0)
! Phi(9/2) = Phi(11/2) - Sum( ai*fi)
  c9d0 = c5 - a0
  c9d1 = c4 - a1
  c9d2 = c3 - a2
  c9d3 = c2 - a3
  c9d4 = c1 - a4
  c9d5 = c1 - a5
  c9d6 = c2 - a6
  c9d7 = c3 - a7
  c9d8 = c4 - a8
  c9d9 = c5 - a9
  c9d10 = -a10
! face 7/2
! {a8: 3/40, a1: 1/24, a5: -21/20, a7: -1/4, a2: -3/8, a9: -1/72, a10: 1/840, a6: 7/12, a3: -319/420, a0: -1/360, a4: 7/4}
! FD37
  a0 = -(1.d0/360.d0)
  a1 = 1.d0/24.d0
  a2 = -(3.d0/8.d0)
  a3 = -(319.d0/420.d0)
  a4 = 1.75d0
  a5 = -(21.d0/20.d0)
  a6 = 7.d0/12.d0
  a7 = -0.25d0
  a8 = 0.075d0
  a9 = -(1.d0/72.d0)
  a10 = 1.d0/840.d0
! Phi(7/2) = Phi(9/2) - Sum( ai*fi)
  c7d0 = c9d0 - a0
  c7d1 = c9d1 - a1
  c7d2 = c9d2 - a2
  c7d3 = c9d3 - a3
  c7d4 = c9d4 - a4
  c7d5 = c9d5 - a5
  c7d6 = c9d6 - a6
  c7d7 = c9d7 - a7
  c7d8 = c9d8 - a8
  c7d9 = c9d9 - a9
  c7d10 = c9d10 - a10
! face 5/2
! {a8: -1/6, a1: -2/9, a5: 28/15, a7: 8/15, a2: -341/280, a9: 2/63, a10: -1/360, a6: -7/6, a3: 8/3, a0: 1/90, a4: -7/3}
! FD28
  a0 = 1.d0/90.d0
  a1 = -(2.d0/9.d0)
  a2 = -(341.d0/280.d0)
  a3 = 8.d0/3.d0
  a4 = -(7.d0/3.d0)
  a5 = 28.d0/15.d0
  a6 = -(7.d0/6.d0)
  a7 = 8.d0/15.d0
  a8 = -(1.d0/6.d0)
  a9 = 2.d0/63.d0
  a10 = -(1.d0/360.d0)
! Phi(5/2) = Phi(7/2) - Sum( ai*fi) given in Berland
  c5d0 = c7d0 - a0
  c5d1 = c7d1 - a1
  c5d2 = c7d2 - a2
  c5d3 = c7d3 - a3
  c5d4 = c7d4 - a4
  c5d5 = c7d5 - a5
  c5d6 = c7d6 - a6
  c5d7 = c7d7 - a7
  c5d8 = c7d8 - a8
  c5d9 = c7d9 - a9
  c5d10 = c7d10 - a10
! face 3/2
! {a8: 9/14, a1: -4609/2520, a5: -63/10, a7: -2, a2: 9/2, a9: -1/8, a10: 1/90, a6: 21/5, a3: -6, a0: -1/10, a4: 7}
! FD19
  a0 = -0.1d0
  a1 = -(4609.d0/2520.d0)
  a2 = 4.5d0
  a3 = -6.d0
  a4 = 7.d0
  a5 = -6.3d0
  a6 = 21.d0*0.2d0
  a7 = -2.d0
  a8 = 9.d0/14.d0
  a9 = -0.125d0
  a10 = 1.d0/90.d0
! Phi(3/2) = Phi(5/2) - Sum( ai*fi) given in Berland
  c3d0 = c5d0 - a0
  c3d1 = c5d1 - a1
  c3d2 = c5d2 - a2
  c3d3 = c5d3 - a3
  c3d4 = c5d4 - a4
  c3d5 = c5d5 - a5
  c3d6 = c5d6 - a6
  c3d7 = c5d7 - a7
  c3d8 = c5d8 - a8
  c3d9 = c5d9 - a9
  c3d10 = c5d10 - a10
  j = 5
  ad_save109 = predrou1
  ad_save108 = predrou2
  ad_save107 = ww
  ad_save106 = wx
  ad_save105 = predroe1
  ad_save104 = wy
  ad_save103 = predroe2
  ad_save102 = r
  ad_save101 = rhoml
  ad_save100 = tx
  ad_save99 = u
  ad_save98 = ty
  ad_save97 = alpha
  ad_save96 = v
  ad_save95 = rspec
  ad_save94 = rhomr
  ad_save93 = mach2
  ad_save92 = ul
  ad_save91 = predrov1
  ad_save90 = predrov2
  ad_save89 = eps2
  ad_save88 = eps4
  ad_save87 = ur
  ad_save86 = lambda
  ad_save85 = uu
  ad_save84 = mmu
  ad_save83 = predro1
  ad_save82 = ux
  ad_save81 = rr
  ad_save80 = dxm1
  ad_save79 = predro2
  ad_save78 = uy
  ad_save77 = dxm2
  ad_save76 = nyloc
  ad_save75 = nxloc
  ad_save74 = vl
  ad_save73 = predrow1
  ad_save72 = predrow2
  ad_save71 = vr
  ad_save70 = sn
  ad_save69 = vv
  ad_save68 = sq
  ad_save67 = vx
  ad_save66 = vort2
  ad_save65 = vy
  ad_save64 = ducros1
  ad_save63 = omrr
  j = 4
  ad_save188 = predrou1
  ad_save187 = predrou2
  ad_save186 = ww
  ad_save185 = wx
  ad_save184 = predroe1
  ad_save183 = wy
  ad_save182 = predroe2
  ad_save181 = r
  ad_save180 = rhoml
  ad_save179 = tx
  ad_save178 = u
  ad_save177 = ty
  ad_save176 = alpha
  ad_save175 = v
  ad_save174 = rspec
  ad_save173 = rhomr
  ad_save172 = mach2
  ad_save171 = ul
  ad_save170 = predrov1
  ad_save169 = predrov2
  ad_save168 = eps2
  ad_save167 = eps4
  ad_save166 = ur
  ad_save165 = lambda
  ad_save164 = uu
  ad_save163 = mmu
  ad_save162 = predro1
  ad_save161 = ux
  ad_save160 = rr
  ad_save159 = dxm1
  ad_save158 = predro2
  ad_save157 = uy
  ad_save156 = dxm2
  ad_save155 = nyloc
  ad_save154 = nxloc
  ad_save153 = vl
  ad_save152 = predrow1
  ad_save151 = predrow2
  ad_save150 = vr
  ad_save149 = sn
  ad_save148 = vv
  ad_save147 = sq
  ad_save146 = vx
  ad_save145 = vort2
  ad_save144 = vy
  ad_save143 = ducros1
  ad_save142 = omrr
  j = 3
  ad_save267 = predrou1
  ad_save266 = predrou2
  ad_save265 = ww
  ad_save264 = wx
  ad_save263 = predroe1
  ad_save262 = wy
  ad_save261 = predroe2
  ad_save260 = r
  ad_save259 = rhoml
  ad_save258 = tx
  ad_save257 = u
  ad_save256 = ty
  ad_save255 = alpha
  ad_save254 = v
  ad_save253 = rspec
  ad_save252 = rhomr
  ad_save251 = mach2
  ad_save250 = ul
  ad_save249 = predrov1
  ad_save248 = predrov2
  ad_save247 = eps2
  ad_save246 = eps4
  ad_save245 = ur
  ad_save244 = lambda
  ad_save243 = uu
  ad_save242 = mmu
  ad_save241 = predro1
  ad_save240 = ux
  ad_save239 = rr
  ad_save238 = dxm1
  ad_save237 = predro2
  ad_save236 = uy
  ad_save235 = dxm2
  ad_save234 = nyloc
  ad_save233 = nxloc
  ad_save232 = vl
  ad_save231 = predrow1
  ad_save230 = predrow2
  ad_save229 = vr
  ad_save228 = sn
  ad_save227 = vv
  ad_save226 = sq
  ad_save225 = vx
  ad_save224 = vort2
  ad_save223 = vy
  ad_save222 = ducros1
  ad_save221 = omrr
  j = 2
  ad_save341 = predrou1
  ad_save340 = predrou2
  ad_save339 = ww
  ad_save338 = wx
  ad_save337 = predroe1
  ad_save336 = wy
  ad_save335 = predroe2
  ad_save334 = r
  ad_save333 = rhoml
  ad_save332 = tx
  ad_save331 = u
  ad_save330 = ty
  ad_save329 = alpha
  ad_save328 = v
  ad_save327 = rspec
  ad_save326 = rhomr
  ad_save325 = mach2
  ad_save324 = ul
  ad_save323 = predrov1
  ad_save322 = predrov2
  ad_save321 = eps2
  ad_save320 = eps4
  ad_save319 = ur
  ad_save318 = lambda
  ad_save317 = uu
  ad_save316 = mmu
  ad_save315 = predro1
  ad_save314 = ux
  ad_save313 = rr
  ad_save312 = dxm1
  ad_save311 = predro2
  ad_save310 = uy
  ad_save309 = dxm2
  ad_save308 = nyloc
  ad_save307 = nxloc
  ad_save306 = vl
  ad_save305 = predrow1
  ad_save304 = predrow2
  ad_save303 = vr
  ad_save302 = sn
  ad_save301 = vv
  ad_save300 = sq
  ad_save299 = vx
  ad_save298 = vort2
  ad_save297 = vy
  ad_save296 = ducros1
  ad_save295 = omrr
! force dp/dn = 0. at 2nd oder
! 9/8
  ct0 = 1.125d0
!-1/8
  ct1 = -0.125d0
! force dp/dn = 0. at 3rd oder
!ct0 = 225.d0/184.d0
!ct1 = -25.d0/92.d0
!ct2 = 9.d0/184.d0
  j = 1
  ad_save390 = predrou1
  ad_save389 = ww
  ad_save388 = wx
  ad_save387 = predroe1
  ad_save386 = wy
  ad_save385 = r
  ad_save384 = rhoml
  ad_save383 = tx
  ad_save382 = u
  ad_save381 = ty
  ad_save380 = alpha
  ad_save379 = v
  ad_save378 = rspec
  ad_save377 = rhomr
  ad_save376 = mach2
  ad_save375 = ul
  ad_save374 = predrov1
  ad_save373 = eps2
  ad_save372 = eps4
  ad_save371 = ur
  ad_save370 = lambda
  ad_save369 = uu
  ad_save368 = mmu
  ad_save367 = predro1
  ad_save366 = ux
  ad_save365 = rr
  ad_save364 = dxm1
  ad_save363 = uy
  ad_save362 = dxm2
  ad_save361 = nyloc
  ad_save360 = nxloc
  ad_save359 = vl
  ad_save358 = predrow1
  ad_save357 = vr
  ad_save356 = sn
  ad_save355 = vv
  ad_save354 = sq
  ad_save353 = vx
  ad_save352 = vort2
  ad_save351 = vy
  ad_save350 = ducros1
  ad_save349 = omrr
  ad_save391 = j
  hnb = 0.0_8
!$BWD-OF II-LOOP 
  DO j=1,jm
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1,im
      hnb(i, j, 5, 1) = hnb(i, j, 5, 1) + residub(i, j, 5)
      hnb(i+1, j, 5, 1) = hnb(i+1, j, 5, 1) - residub(i, j, 5)
      hnb(i, j, 5, 2) = hnb(i, j, 5, 2) + residub(i, j, 5)
      hnb(i, j+1, 5, 2) = hnb(i, j+1, 5, 2) - residub(i, j, 5)
      residub(i, j, 5) = 0.0_8
      hnb(i, j, 4, 1) = hnb(i, j, 4, 1) + residub(i, j, 4)
      hnb(i+1, j, 4, 1) = hnb(i+1, j, 4, 1) - residub(i, j, 4)
      hnb(i, j, 4, 2) = hnb(i, j, 4, 2) + residub(i, j, 4)
      hnb(i, j+1, 4, 2) = hnb(i, j+1, 4, 2) - residub(i, j, 4)
      residub(i, j, 4) = 0.0_8
      hnb(i, j, 3, 1) = hnb(i, j, 3, 1) + residub(i, j, 3)
      hnb(i+1, j, 3, 1) = hnb(i+1, j, 3, 1) - residub(i, j, 3)
      hnb(i, j, 3, 2) = hnb(i, j, 3, 2) + residub(i, j, 3)
      hnb(i, j+1, 3, 2) = hnb(i, j+1, 3, 2) - residub(i, j, 3)
      residub(i, j, 3) = 0.0_8
      hnb(i, j, 2, 1) = hnb(i, j, 2, 1) + residub(i, j, 2)
      hnb(i+1, j, 2, 1) = hnb(i+1, j, 2, 1) - residub(i, j, 2)
      hnb(i, j, 2, 2) = hnb(i, j, 2, 2) + residub(i, j, 2)
      hnb(i, j+1, 2, 2) = hnb(i, j+1, 2, 2) - residub(i, j, 2)
      residub(i, j, 2) = 0.0_8
      hnb(i, j, 1, 1) = hnb(i, j, 1, 1) + residub(i, j, 1)
      hnb(i+1, j, 1, 1) = hnb(i+1, j, 1, 1) - residub(i, j, 1)
      hnb(i, j, 1, 2) = hnb(i, j, 1, 2) + residub(i, j, 1)
      hnb(i, j+1, 1, 2) = hnb(i, j+1, 1, 2) - residub(i, j, 1)
      residub(i, j, 1) = 0.0_8
    END DO
  END DO
  j = ad_save391
  j = 1
  wb = 0.0_8
  fb = 0.0_8
  gb = 0.0_8
  pb = 0.0_8
  velxb = 0.0_8
  velyb = 0.0_8
  velzb = 0.0_8
  gradub = 0.0_8
  gradvb = 0.0_8
  tlocb = 0.0_8
  mub = 0.0_8
!$BWD-OF II-LOOP 
!DIR$ IVDEP
  DO i=1,im+1
! for idir (only works for infinite Wall)
    predro1 = -(d5*w(i-5, j, 1)) + d4*w(i-4, j, 1) - d3*w(i-3, j, 1) + &
&     d2*w(i-2, j, 1) - d1*w(i-1, j, 1) + d1*w(i, j, 1) - d2*w(i+1, j, 1&
&     ) + d3*w(i+2, j, 1) - d4*w(i+3, j, 1) + d5*w(i+4, j, 1)
    predrou1 = -(d5*w(i-5, j, 2)) + d4*w(i-4, j, 2) - d3*w(i-3, j, 2) + &
&     d2*w(i-2, j, 2) - d1*w(i-1, j, 2) + d1*w(i, j, 2) - d2*w(i+1, j, 2&
&     ) + d3*w(i+2, j, 2) - d4*w(i+3, j, 2) + d5*w(i+4, j, 2)
    predrov1 = -(d5*w(i-5, j, 3)) + d4*w(i-4, j, 3) - d3*w(i-3, j, 3) + &
&     d2*w(i-2, j, 3) - d1*w(i-1, j, 3) + d1*w(i, j, 3) - d2*w(i+1, j, 3&
&     ) + d3*w(i+2, j, 3) - d4*w(i+3, j, 3) + d5*w(i+4, j, 3)
    predrow1 = -(d5*w(i-5, j, 4)) + d4*w(i-4, j, 4) - d3*w(i-3, j, 4) + &
&     d2*w(i-2, j, 4) - d1*w(i-1, j, 4) + d1*w(i, j, 4) - d2*w(i+1, j, 4&
&     ) + d3*w(i+2, j, 4) - d4*w(i+3, j, 4) + d5*w(i+4, j, 4)
    predroe1 = -(d5*w(i-5, j, 5)) + d4*w(i-4, j, 5) - d3*w(i-3, j, 5) + &
&     d2*w(i-2, j, 5) - d1*w(i-1, j, 5) + d1*w(i, j, 5) - d2*w(i+1, j, 5&
&     ) + d3*w(i+2, j, 5) - d4*w(i+3, j, 5) + d5*w(i+4, j, 5)
! grad for viscous fluxes o2 - 3p
!
    volm1 = volf(i, j, 1)
! Normals
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    val_n = velx(i, j)
    val_s = velx(i-1, j)
    val_e = fourth*(velx(i, j)+velx(i, j-1)+velx(i-1, j)+velx(i-1, j-1))
    val_o = fourth*(velx(i, j)+velx(i, j+1)+velx(i-1, j)+velx(i-1, j+1))
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = vely(i, j)
    val_s = vely(i-1, j)
    val_e = fourth*(vely(i, j)+vely(i, j-1)+vely(i-1, j)+vely(i-1, j-1))
    val_o = fourth*(vely(i, j)+vely(i, j+1)+vely(i-1, j)+vely(i-1, j+1))
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = velz(i, j)
    val_s = velz(i-1, j)
    val_e = fourth*(velz(i, j)+velz(i, j-1)+velz(i-1, j)+velz(i-1, j-1))
    val_o = fourth*(velz(i, j)+velz(i, j+1)+velz(i-1, j)+velz(i-1, j+1))
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = tloc(i, j)
    val_s = tloc(i-1, j)
    val_e = fourth*(tloc(i, j)+tloc(i, j-1)+tloc(i-1, j)+tloc(i-1, j-1))
    val_o = fourth*(tloc(i, j)+tloc(i, j+1)+tloc(i-1, j)+tloc(i-1, j+1))
!
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
    uu = half*(velx(i, j)+velx(i-1, j))
    vv = half*(vely(i, j)+vely(i-1, j))
    ww = half*(velz(i, j)+velz(i-1, j))
!
    mmu = half*(mu(i, j)+mu(i-1, j))
    lambda = half*(mu(i, j)+mu(i-1, j))*cpprandtl
!
    fvrou1 = twothird*mmu*(two*ux-vy)
    fvrov1 = mmu*(uy+vx)
    fvrow1 = mmu*wx
!
    gvrou1 = mmu*(uy+vx)
    gvrov1 = twothird*mmu*(-ux+two*vy)
    gvrow1 = mmu*wy
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! #include "rhs/spectralradius_i.F"
! correction Rossow JCP 2000
!1st direction
    rhomr = w(i, j, 1)
    ur = w(i, j, 2)/rhomr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i-1, j, 1)
    ul = w(i-1, j, 2)/rhoml
    vl = w(i-1, j, 3)/rhoml
    c2l = gam*rgaz*tloc(i-1, j)
!
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    u = ul*rr + ur*omrr
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_branch79 = 0
      mach2 = one
    ELSE
      mach2 = vn2/c2x
      ad_branch79 = 1
    END IF
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    x11 = nx(i, j, 1)*u + ny(i, j, 1)*v
    IF (x11 .GE. 0.) THEN
      ab = x11
      ad_branch80 = 0
    ELSE
      ab = -x11
      ad_branch80 = 1
    END IF
    sq = SQRT(cprim*nx2)
!
    rspec = ab + sq
    IF (p(i-1, j) - two*p(i, j) + p(i+1, j) .GE. 0.) THEN
      abs20 = p(i-1, j) - two*p(i, j) + p(i+1, j)
      ad_branch81 = 1
    ELSE
      abs20 = -(p(i-1, j)-two*p(i, j)+p(i+1, j))
      ad_branch81 = 0
    END IF
    x32 = p(i-1, j) + two*p(i, j) + p(i+1, j)
    IF (x32 .GE. 0.) THEN
      abs42 = x32
      ad_branch82 = 0
    ELSE
      abs42 = -x32
      ad_branch82 = 1
    END IF
!
!1st direction
    k_sensor1 = abs20/abs42
    IF (p(i-2, j) - two*p(i-1, j) + p(i, j) .GE. 0.) THEN
      abs21 = p(i-2, j) - two*p(i-1, j) + p(i, j)
      ad_branch83 = 1
    ELSE
      abs21 = -(p(i-2, j)-two*p(i-1, j)+p(i, j))
      ad_branch83 = 0
    END IF
    x33 = p(i-2, j) + two*p(i-1, j) + p(i, j)
    IF (x33 .GE. 0.) THEN
      abs43 = x33
      ad_branch84 = 0
    ELSE
      abs43 = -x33
      ad_branch84 = 1
    END IF
    k_sensor2 = abs21/abs43
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    divu2 = divu*divu
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    ducros1 = divu2/(divu2+vort2+1d-15)
    dxm1 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    ad_save342 = divu2
    divu2 = divu*divu
    vort2 = (gradv(i-1, j, 1)-gradu(i-1, j, 2))*(gradv(i-1, j, 1)-gradu(&
&     i-1, j, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch85 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch85 = 1
    END IF
!     ! extension of shock capturing
!
!    k_sensor1 = ABS(p(i,j) - TWO*p(i+1,j) + p(i+2,j)) / &
!                ABS(p(i,j) + TWO*p(i+1,j) + p(i+2,j))
!
!    k_sensor2 = ABS(p(i-3,j) - TWO*p(i-2,j) + p(i-1,j)) / &
!                ABS(p(i-3,j) + TWO*p(i-2,j) + p(i-1,j))
!
!    divu2     = (gradu(i+1,j,1)+gradv(i+1,j,2)) * (gradu(i+1,j,1)+gradv(i+1,j,2))
!    vort2     = (gradv(i+1,j,1)-gradu(i+1,j,2)) * (gradv(i+1,j,1)-gradu(i+1,j,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i-2,j,1)+gradv(i-2,j,2)) * (gradu(i-2,j,1)+gradv(i-2,j,2))
!    vort2     = (gradv(i-2,j,1)-gradu(i-2,j,2)) * (gradv(i-2,j,1)-gradu(i-2,j,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                      k_sensor2*ducros2, coef)
!
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      eps4 = k4 - 12.d0*eps2
      ad_branch86 = 0
    ELSE
      ad_branch86 = 1
      eps4 = zero
    END IF
    diffro = half*(w(i, j, 1)-w(i-1, j, 1))
    diffrou = half*(w(i, j, 2)-w(i-1, j, 2))
    diffrov = half*(w(i, j, 3)-w(i-1, j, 3))
    diffrow = half*(w(i, j, 4)-w(i-1, j, 4))
    diffroe = half*(w(i, j, 5)-w(i-1, j, 5))
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_diri.F"
!     endif
    sc1 = nx(i, j, 1)
    sc2 = ny(i, j, 1)
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    nxloc = sc1*invsn
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
!jdir
!Euler part
!pw = p(i,j)
!!  ! order 3
!!  pw = ct0*p(i,j  ) +&
!!       ct1*p(i,j+1) +&
!!       ct2*p(i,j+2)
! fxro2  = ZERO
! fxrou2 = ZERO
! fxrow2 = ZERO
! fxroe2 = ZERO
!ns part
! viscosity is taken at the first center
    mmu = mu(i, j)
!
! compute gradient-------------------------------------
! vel_wall = 0 ==> dveli/dxi = 2 * velcenter_i *nxi/vol
    ad_save343 = ux
    ux = two*velx(i, j)*nx(i, j, 2)*volf(i, j, 2)
    ad_save344 = vx
    vx = two*vely(i, j)*nx(i, j, 2)*volf(i, j, 2)
    ad_save345 = wx
    wx = two*velz(i, j)*nx(i, j, 2)*volf(i, j, 2)
    ad_save346 = uy
    uy = two*velx(i, j)*ny(i, j, 2)*volf(i, j, 2)
    ad_save347 = vy
    vy = two*vely(i, j)*ny(i, j, 2)*volf(i, j, 2)
    ad_save348 = wy
    wy = two*velz(i, j)*ny(i, j, 2)*volf(i, j, 2)
! ux = ZERO
! vx = ZERO
! wx = ZERO
!
! set viscous fluxes at wall----------------------------
! dir normal to the wall
! adiab
!
!
!adiab
!
    hnb(i, j, 5, 2) = 0.0_8
    fvrow2b = -(nx(i, j, 2)*hnb(i, j, 4, 2))
    gvrow2b = -(ny(i, j, 2)*hnb(i, j, 4, 2))
    hnb(i, j, 4, 2) = 0.0_8
    fxrov2b = ny(i, j, 2)*hnb(i, j, 3, 2) + nx(i, j, 2)*hnb(i, j, 2, 2)
    fvrov2b = -(nx(i, j, 2)*hnb(i, j, 3, 2))
    gvrov2b = -(ny(i, j, 2)*hnb(i, j, 3, 2))
    hnb(i, j, 3, 2) = 0.0_8
    fvrou2b = -(nx(i, j, 2)*hnb(i, j, 2, 2))
    gvrou2b = -(ny(i, j, 2)*hnb(i, j, 2, 2))
    hnb(i, j, 2, 2) = 0.0_8
    hnb(i, j, 1, 2) = 0.0_8
    wyb = mmu*gvrow2b
    tempb1 = twothird*gvrov2b
    mmub = wy*gvrow2b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    uyb = mmu*gvrou2b + mmu*fvrov2b
    vxb = mmu*gvrou2b + mmu*fvrov2b
    wxb = mmu*fvrow2b
    tempb1 = twothird*fvrou2b
    mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (two*&
&     ux-vy)*tempb1
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    wy = ad_save348
    velzb(i, j) = velzb(i, j) + two*ny(i, j, 2)*volf(i, j, 2)*wyb + two*&
&     nx(i, j, 2)*volf(i, j, 2)*wxb
    vy = ad_save347
    velyb(i, j) = velyb(i, j) + two*ny(i, j, 2)*volf(i, j, 2)*vyb + two*&
&     nx(i, j, 2)*volf(i, j, 2)*vxb
    uy = ad_save346
    velxb(i, j) = velxb(i, j) + two*ny(i, j, 2)*volf(i, j, 2)*uyb + two*&
&     nx(i, j, 2)*volf(i, j, 2)*uxb
    wx = ad_save345
    vx = ad_save344
    ux = ad_save343
    mub(i, j) = mub(i, j) + mmub
    mmu = half*(mu(i, j)+mu(i-1, j))
    pwb = fxrov2b
    pb(i, j) = pb(i, j) + ct0*pwb
    pb(i, j+1) = pb(i, j+1) + ct1*pwb
    fxroe1b = hnb(i, j, 5, 1)
    dissroe1b = -hnb(i, j, 5, 1)
    fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
    gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
    hnb(i, j, 5, 1) = 0.0_8
    fxrow1b = hnb(i, j, 4, 1)
    dissrow1b = -hnb(i, j, 4, 1)
    fvrow1b = -(nxloc*sn*hnb(i, j, 4, 1))
    gvrow1b = -(nyloc*sn*hnb(i, j, 4, 1))
    hnb(i, j, 4, 1) = 0.0_8
    fxrov1b = hnb(i, j, 3, 1)
    dissrov1b = -hnb(i, j, 3, 1)
    fvrov1b = -(nxloc*sn*hnb(i, j, 3, 1))
    gvrov1b = -(nyloc*sn*hnb(i, j, 3, 1))
    hnb(i, j, 3, 1) = 0.0_8
    fxrou1b = hnb(i, j, 2, 1)
    dissrou1b = -hnb(i, j, 2, 1)
    fvrou1b = -(nxloc*sn*hnb(i, j, 2, 1))
    gvrou1b = -(nyloc*sn*hnb(i, j, 2, 1))
    hnb(i, j, 2, 1) = 0.0_8
    fxro1b = hnb(i, j, 1, 1)
    dissro1b = -hnb(i, j, 1, 1)
    hnb(i, j, 1, 1) = 0.0_8
    rspecb = (eps2*diffroe+eps4*predroe1)*dissroe1b + (eps2*diffrow+eps4&
&     *predrow1)*dissrow1b + (eps2*diffrov+eps4*predrov1)*dissrov1b + (&
&     eps2*diffrou+eps4*predrou1)*dissrou1b + (eps2*diffro+eps4*predro1)&
&     *dissro1b
    tempb1 = rspec*dissroe1b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe1*tempb1
    predroe1b = eps4*tempb1
    tempb1 = rspec*dissrow1b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow1*tempb1
    predrow1b = eps4*tempb1
    tempb1 = rspec*dissrov1b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    eps4b = eps4b + predrov1*tempb1
    predrov1b = eps4*tempb1
    tempb1 = rspec*dissrou1b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    eps4b = eps4b + predrou1*tempb1
    predrou1b = eps4*tempb1
    tempb1 = rspec*dissro1b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    eps4b = eps4b + predro1*tempb1
    predro1b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i-1, j, 5) = wb(i-1, j, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i-1, j, 4) = wb(i-1, j, 4) - half*diffrowb
    wb(i, j, 3) = wb(i, j, 3) + half*diffrovb
    wb(i-1, j, 3) = wb(i-1, j, 3) - half*diffrovb
    wb(i, j, 2) = wb(i, j, 2) + half*diffroub
    wb(i-1, j, 2) = wb(i-1, j, 2) - half*diffroub
    wb(i, j, 1) = wb(i, j, 1) + half*diffrob
    wb(i-1, j, 1) = wb(i-1, j, 1) - half*diffrob
    IF (ad_branch86 .EQ. 0) eps2b = eps2b - 12.d0*eps4b
    coefb = k2*eps2b
    IF (ad_branch85 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      dxm1b = 0.0_8
      k_sensor1b = 0.0_8
      ducros1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = k_sensor1*dxm1*coefb
      dxm1b = k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i-1, j, 1)-gradu(i-1, j, 2))*vort2b
    gradvb(i-1, j, 1) = gradvb(i-1, j, 1) + tempb1
    gradub(i-1, j, 2) = gradub(i-1, j, 2) - tempb1
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    divu2 = ad_save342
    divub = divub + 2*divu*divu2b
    gradub(i-1, j, 1) = gradub(i-1, j, 1) + divub
    gradvb(i-1, j, 2) = gradvb(i-1, j, 2) + divub
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm1b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = sqb - temp1*tempb1
    tempb1 = ducros1b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i, j, 1)-gradu(i, j, 2))*vort2b
    gradvb(i, j, 1) = gradvb(i, j, 1) + tempb1
    gradub(i, j, 2) = gradub(i, j, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j, 1) = gradub(i, j, 1) + divub
    gradvb(i, j, 2) = gradvb(i, j, 2) + divub
    abs21b = k_sensor2b/abs43
    abs43b = -(abs21*k_sensor2b/abs43**2)
    IF (ad_branch84 .EQ. 0) THEN
      x33b = abs43b
    ELSE
      x33b = -abs43b
    END IF
    pb(i-2, j) = pb(i-2, j) + x33b
    pb(i-1, j) = pb(i-1, j) + two*x33b
    pb(i, j) = pb(i, j) + x33b
    IF (ad_branch83 .EQ. 0) THEN
      pb(i-1, j) = pb(i-1, j) + two*abs21b
      pb(i-2, j) = pb(i-2, j) - abs21b
      pb(i, j) = pb(i, j) - abs21b
    ELSE
      pb(i-2, j) = pb(i-2, j) + abs21b
      pb(i-1, j) = pb(i-1, j) - two*abs21b
      pb(i, j) = pb(i, j) + abs21b
    END IF
    abs20b = k_sensor1b/abs42
    abs42b = -(abs20*k_sensor1b/abs42**2)
    IF (ad_branch82 .EQ. 0) THEN
      x32b = abs42b
    ELSE
      x32b = -abs42b
    END IF
    pb(i-1, j) = pb(i-1, j) + x32b
    pb(i, j) = pb(i, j) + two*x32b
    pb(i+1, j) = pb(i+1, j) + x32b
    IF (ad_branch81 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs20b
      pb(i-1, j) = pb(i-1, j) - abs20b
      pb(i+1, j) = pb(i+1, j) - abs20b
    ELSE
      pb(i-1, j) = pb(i-1, j) + abs20b
      pb(i, j) = pb(i, j) - two*abs20b
      pb(i+1, j) = pb(i+1, j) + abs20b
    END IF
    abb = rspecb
    sqb = sqb + rspecb
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch80 .EQ. 0) THEN
      x11b = abb
    ELSE
      x11b = -abb
    END IF
    ub = nx(i, j, 1)*x11b
    vb = ny(i, j, 1)*x11b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    IF (ad_branch79 .NE. 0) THEN
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    fvrov1b = fvrov1b + vv*fvroe1b
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    vlb = rr*vb
    vrb = omrr*vb
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i-1, j, 3)*vlb/rhoml**2 - w(i-1, &
&     j, 2)*ulb/rhoml**2
    wb(i-1, j, 3) = wb(i-1, j, 3) + vlb/rhoml - d1*predrov1b
    wb(i-1, j, 2) = wb(i-1, j, 2) + ulb/rhoml - d1*predrou1b
    wb(i-1, j, 1) = wb(i-1, j, 1) + rhomlb - d1*predro1b
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + d1*predrov1b
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + d1*predrou1b
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + d1*predro1b
    lambdab = ty*gvroe1b + tx*fvroe1b
    tyb = lambda*gvroe1b
    uub = gvrou1*gvroe1b + fvrou1*fvroe1b
    gvrou1b = gvrou1b + uu*gvroe1b
    vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
    gvrov1b = gvrov1b + vv*gvroe1b
    wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
    gvrow1b = gvrow1b + ww*gvroe1b
    wyb = mmu*gvrow1b
    tempb1 = twothird*gvrov1b
    mmub = wy*gvrow1b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    uyb = mmu*gvrou1b + mmu*fvrov1b
    vxb = mmu*gvrou1b + mmu*fvrov1b
    txb = lambda*fvroe1b
    fvrou1b = fvrou1b + uu*fvroe1b
    fvrow1b = fvrow1b + ww*fvroe1b
    wxb = mmu*fvrow1b
    tempb1 = twothird*fvrou1b
    mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (two*&
&     ux-vy)*tempb1
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    tempb1 = half*cpprandtl*lambdab
    mub(i, j) = mub(i, j) + tempb1 + half*mmub
    mub(i-1, j) = mub(i-1, j) + tempb1 + half*mmub
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    tlocb(i-1, j) = tlocb(i-1, j) + gam*rgaz*c2lb + tempb1
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb + tempb1
    tlocb(i, j+1) = tlocb(i, j+1) + tempb1
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    tlocb(i, j) = tlocb(i, j) + tempb1 + val_nb
    tlocb(i, j-1) = tlocb(i, j-1) + tempb1
    tlocb(i-1, j) = tlocb(i-1, j) + tempb1 + val_sb
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + tempb1
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    velzb(i, j) = velzb(i, j) + half*wwb + tempb1
    velzb(i-1, j) = velzb(i-1, j) + half*wwb + tempb1
    velzb(i, j+1) = velzb(i, j+1) + tempb1
    velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    velzb(i, j) = velzb(i, j) + tempb1 + val_nb
    velzb(i, j-1) = velzb(i, j-1) + tempb1
    velzb(i-1, j) = velzb(i-1, j) + tempb1 + val_sb
    velzb(i-1, j-1) = velzb(i-1, j-1) + tempb1
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    velyb(i, j) = velyb(i, j) + half*vvb + tempb1
    velyb(i-1, j) = velyb(i-1, j) + half*vvb + tempb1
    velyb(i, j+1) = velyb(i, j+1) + tempb1
    velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    velyb(i, j) = velyb(i, j) + tempb1 + val_nb
    velyb(i, j-1) = velyb(i, j-1) + tempb1
    velyb(i-1, j) = velyb(i-1, j) + tempb1 + val_sb
    velyb(i-1, j-1) = velyb(i-1, j-1) + tempb1
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    velxb(i, j) = velxb(i, j) + half*uub + tempb1
    velxb(i-1, j) = velxb(i-1, j) + half*uub + tempb1
    velxb(i, j+1) = velxb(i, j+1) + tempb1
    velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    velxb(i, j) = velxb(i, j) + tempb1 + val_nb
    velxb(i, j-1) = velxb(i, j-1) + tempb1
    velxb(i-1, j) = velxb(i-1, j) + tempb1 + val_sb
    velxb(i-1, j-1) = velxb(i-1, j-1) + tempb1
    wb(i-4, j, 5) = wb(i-4, j, 5) + d4*predroe1b
    wb(i-5, j, 5) = wb(i-5, j, 5) - d5*predroe1b
    wb(i-3, j, 5) = wb(i-3, j, 5) - d3*predroe1b
    wb(i-2, j, 5) = wb(i-2, j, 5) + d2*predroe1b
    wb(i-1, j, 5) = wb(i-1, j, 5) - d1*predroe1b
    wb(i, j, 5) = wb(i, j, 5) + d1*predroe1b
    wb(i+1, j, 5) = wb(i+1, j, 5) - d2*predroe1b
    wb(i+2, j, 5) = wb(i+2, j, 5) + d3*predroe1b
    wb(i+4, j, 5) = wb(i+4, j, 5) + d5*predroe1b
    wb(i+3, j, 5) = wb(i+3, j, 5) - d4*predroe1b
    wb(i-4, j, 4) = wb(i-4, j, 4) + d4*predrow1b
    wb(i-5, j, 4) = wb(i-5, j, 4) - d5*predrow1b
    wb(i-3, j, 4) = wb(i-3, j, 4) - d3*predrow1b
    wb(i-2, j, 4) = wb(i-2, j, 4) + d2*predrow1b
    wb(i-1, j, 4) = wb(i-1, j, 4) - d1*predrow1b
    wb(i, j, 4) = wb(i, j, 4) + d1*predrow1b
    wb(i+1, j, 4) = wb(i+1, j, 4) - d2*predrow1b
    wb(i+2, j, 4) = wb(i+2, j, 4) + d3*predrow1b
    wb(i+4, j, 4) = wb(i+4, j, 4) + d5*predrow1b
    wb(i+3, j, 4) = wb(i+3, j, 4) - d4*predrow1b
    wb(i-4, j, 3) = wb(i-4, j, 3) + d4*predrov1b
    wb(i-5, j, 3) = wb(i-5, j, 3) - d5*predrov1b
    wb(i-3, j, 3) = wb(i-3, j, 3) - d3*predrov1b
    wb(i-2, j, 3) = wb(i-2, j, 3) + d2*predrov1b
    wb(i+1, j, 3) = wb(i+1, j, 3) - d2*predrov1b
    wb(i+2, j, 3) = wb(i+2, j, 3) + d3*predrov1b
    wb(i+4, j, 3) = wb(i+4, j, 3) + d5*predrov1b
    wb(i+3, j, 3) = wb(i+3, j, 3) - d4*predrov1b
    wb(i-4, j, 2) = wb(i-4, j, 2) + d4*predrou1b
    wb(i-5, j, 2) = wb(i-5, j, 2) - d5*predrou1b
    wb(i-3, j, 2) = wb(i-3, j, 2) - d3*predrou1b
    wb(i-2, j, 2) = wb(i-2, j, 2) + d2*predrou1b
    wb(i+1, j, 2) = wb(i+1, j, 2) - d2*predrou1b
    wb(i+2, j, 2) = wb(i+2, j, 2) + d3*predrou1b
    wb(i+4, j, 2) = wb(i+4, j, 2) + d5*predrou1b
    wb(i+3, j, 2) = wb(i+3, j, 2) - d4*predrou1b
    wb(i-4, j, 1) = wb(i-4, j, 1) + d4*predro1b
    wb(i-5, j, 1) = wb(i-5, j, 1) - d5*predro1b
    wb(i-3, j, 1) = wb(i-3, j, 1) - d3*predro1b
    wb(i-2, j, 1) = wb(i-2, j, 1) + d2*predro1b
    wb(i+1, j, 1) = wb(i+1, j, 1) - d2*predro1b
    wb(i+2, j, 1) = wb(i+2, j, 1) + d3*predro1b
    wb(i+4, j, 1) = wb(i+4, j, 1) + d5*predro1b
    wb(i+3, j, 1) = wb(i+3, j, 1) - d4*predro1b
    tempb1 = nx(i, j, 1)*fxroe1b
    tempb0 = ny(i, j, 1)*fxroe1b
    gb(i, j, 5) = gb(i, j, 5) + c1*tempb0
    gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb0
    gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb0
    gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb0
    gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb0
    gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb0
    gb(i+3, j, 5) = gb(i+3, j, 5) + c4*tempb0
    gb(i-4, j, 5) = gb(i-4, j, 5) + c4*tempb0
    gb(i+4, j, 5) = gb(i+4, j, 5) + c5*tempb0
    gb(i-5, j, 5) = gb(i-5, j, 5) + c5*tempb0
    fb(i, j, 5) = fb(i, j, 5) + c1*tempb1
    fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb1
    fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb1
    fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb1
    fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb1
    fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb1
    fb(i+3, j, 5) = fb(i+3, j, 5) + c4*tempb1
    fb(i-4, j, 5) = fb(i-4, j, 5) + c4*tempb1
    fb(i+4, j, 5) = fb(i+4, j, 5) + c5*tempb1
    fb(i-5, j, 5) = fb(i-5, j, 5) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrow1b
    tempb0 = ny(i, j, 1)*fxrow1b
    gb(i, j, 4) = gb(i, j, 4) + c1*tempb0
    gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb0
    gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb0
    gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb0
    gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb0
    gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb0
    gb(i+3, j, 4) = gb(i+3, j, 4) + c4*tempb0
    gb(i-4, j, 4) = gb(i-4, j, 4) + c4*tempb0
    gb(i+4, j, 4) = gb(i+4, j, 4) + c5*tempb0
    gb(i-5, j, 4) = gb(i-5, j, 4) + c5*tempb0
    fb(i, j, 4) = fb(i, j, 4) + c1*tempb1
    fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb1
    fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb1
    fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb1
    fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb1
    fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb1
    fb(i+3, j, 4) = fb(i+3, j, 4) + c4*tempb1
    fb(i-4, j, 4) = fb(i-4, j, 4) + c4*tempb1
    fb(i+4, j, 4) = fb(i+4, j, 4) + c5*tempb1
    fb(i-5, j, 4) = fb(i-5, j, 4) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrov1b
    tempb0 = ny(i, j, 1)*fxrov1b
    gb(i, j, 3) = gb(i, j, 3) + c1*tempb0
    gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb0
    gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb0
    gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb0
    gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb0
    gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb0
    gb(i+3, j, 3) = gb(i+3, j, 3) + c4*tempb0
    gb(i-4, j, 3) = gb(i-4, j, 3) + c4*tempb0
    gb(i+4, j, 3) = gb(i+4, j, 3) + c5*tempb0
    gb(i-5, j, 3) = gb(i-5, j, 3) + c5*tempb0
    fb(i, j, 3) = fb(i, j, 3) + c1*tempb1
    fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb1
    fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb1
    fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb1
    fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb1
    fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb1
    fb(i+3, j, 3) = fb(i+3, j, 3) + c4*tempb1
    fb(i-4, j, 3) = fb(i-4, j, 3) + c4*tempb1
    fb(i+4, j, 3) = fb(i+4, j, 3) + c5*tempb1
    fb(i-5, j, 3) = fb(i-5, j, 3) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrou1b
    tempb0 = ny(i, j, 1)*fxrou1b
    gb(i, j, 2) = gb(i, j, 2) + c1*tempb0
    gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb0
    gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb0
    gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb0
    gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb0
    gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb0
    gb(i+3, j, 2) = gb(i+3, j, 2) + c4*tempb0
    gb(i-4, j, 2) = gb(i-4, j, 2) + c4*tempb0
    gb(i+4, j, 2) = gb(i+4, j, 2) + c5*tempb0
    gb(i-5, j, 2) = gb(i-5, j, 2) + c5*tempb0
    fb(i, j, 2) = fb(i, j, 2) + c1*tempb1
    fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb1
    fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb1
    fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb1
    fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb1
    fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb1
    fb(i+3, j, 2) = fb(i+3, j, 2) + c4*tempb1
    fb(i-4, j, 2) = fb(i-4, j, 2) + c4*tempb1
    fb(i+4, j, 2) = fb(i+4, j, 2) + c5*tempb1
    fb(i-5, j, 2) = fb(i-5, j, 2) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxro1b
    tempb0 = ny(i, j, 1)*fxro1b
    gb(i, j, 1) = gb(i, j, 1) + c1*tempb0
    gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb0
    gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb0
    gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb0
    gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb0
    gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb0
    gb(i+3, j, 1) = gb(i+3, j, 1) + c4*tempb0
    gb(i-4, j, 1) = gb(i-4, j, 1) + c4*tempb0
    gb(i+4, j, 1) = gb(i+4, j, 1) + c5*tempb0
    gb(i-5, j, 1) = gb(i-5, j, 1) + c5*tempb0
    fb(i, j, 1) = fb(i, j, 1) + c1*tempb1
    fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb1
    fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb1
    fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb1
    fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb1
    fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb1
    fb(i+3, j, 1) = fb(i+3, j, 1) + c4*tempb1
    fb(i-4, j, 1) = fb(i-4, j, 1) + c4*tempb1
    fb(i+4, j, 1) = fb(i+4, j, 1) + c5*tempb1
    fb(i-5, j, 1) = fb(i-5, j, 1) + c5*tempb1
  END DO
  omrr = ad_save349
  ducros1 = ad_save350
  vy = ad_save351
  vort2 = ad_save352
  vx = ad_save353
  sq = ad_save354
  vv = ad_save355
  sn = ad_save356
  vr = ad_save357
  predrow1 = ad_save358
  vl = ad_save359
  nxloc = ad_save360
  nyloc = ad_save361
  dxm2 = ad_save362
  uy = ad_save363
  dxm1 = ad_save364
  rr = ad_save365
  ux = ad_save366
  predro1 = ad_save367
  mmu = ad_save368
  uu = ad_save369
  lambda = ad_save370
  ur = ad_save371
  eps4 = ad_save372
  eps2 = ad_save373
  predrov1 = ad_save374
  ul = ad_save375
  mach2 = ad_save376
  rhomr = ad_save377
  rspec = ad_save378
  v = ad_save379
  alpha = ad_save380
  ty = ad_save381
  u = ad_save382
  tx = ad_save383
  rhoml = ad_save384
  r = ad_save385
  wy = ad_save386
  predroe1 = ad_save387
  wx = ad_save388
  ww = ad_save389
  predrou1 = ad_save390
  j = 2
!$BWD-OF II-LOOP 
!DIR$ IVDEP
  DO i=1,im+1
    predro1 = -(d5*w(i-5, j, 1)) + d4*w(i-4, j, 1) - d3*w(i-3, j, 1) + &
&     d2*w(i-2, j, 1) - d1*w(i-1, j, 1) + d1*w(i, j, 1) - d2*w(i+1, j, 1&
&     ) + d3*w(i+2, j, 1) - d4*w(i+3, j, 1) + d5*w(i+4, j, 1)
    predrou1 = -(d5*w(i-5, j, 2)) + d4*w(i-4, j, 2) - d3*w(i-3, j, 2) + &
&     d2*w(i-2, j, 2) - d1*w(i-1, j, 2) + d1*w(i, j, 2) - d2*w(i+1, j, 2&
&     ) + d3*w(i+2, j, 2) - d4*w(i+3, j, 2) + d5*w(i+4, j, 2)
    predrov1 = -(d5*w(i-5, j, 3)) + d4*w(i-4, j, 3) - d3*w(i-3, j, 3) + &
&     d2*w(i-2, j, 3) - d1*w(i-1, j, 3) + d1*w(i, j, 3) - d2*w(i+1, j, 3&
&     ) + d3*w(i+2, j, 3) - d4*w(i+3, j, 3) + d5*w(i+4, j, 3)
    predrow1 = -(d5*w(i-5, j, 4)) + d4*w(i-4, j, 4) - d3*w(i-3, j, 4) + &
&     d2*w(i-2, j, 4) - d1*w(i-1, j, 4) + d1*w(i, j, 4) - d2*w(i+1, j, 4&
&     ) + d3*w(i+2, j, 4) - d4*w(i+3, j, 4) + d5*w(i+4, j, 4)
    predroe1 = -(d5*w(i-5, j, 5)) + d4*w(i-4, j, 5) - d3*w(i-3, j, 5) + &
&     d2*w(i-2, j, 5) - d1*w(i-1, j, 5) + d1*w(i, j, 5) - d2*w(i+1, j, 5&
&     ) + d3*w(i+2, j, 5) - d4*w(i+3, j, 5) + d5*w(i+4, j, 5)
    predro2 = -(d5*w(i, j-5, 1)) + d4*w(i, j-4, 1) - d3*w(i, j-3, 1) + &
&     d2*w(i, j-2, 1) - d1*w(i, j-1, 1) + d1*w(i, j, 1) - d2*w(i, j+1, 1&
&     ) + d3*w(i, j+2, 1) - d4*w(i, j+3, 1) + d5*w(i, j+4, 1)
    predrou2 = -(d5*w(i, j-5, 2)) + d4*w(i, j-4, 2) - d3*w(i, j-3, 2) + &
&     d2*w(i, j-2, 2) - d1*w(i, j-1, 2) + d1*w(i, j, 2) - d2*w(i, j+1, 2&
&     ) + d3*w(i, j+2, 2) - d4*w(i, j+3, 2) + d5*w(i, j+4, 2)
    predrov2 = -(d5*w(i, j-5, 3)) + d4*w(i, j-4, 3) - d3*w(i, j-3, 3) + &
&     d2*w(i, j-2, 3) - d1*w(i, j-1, 3) + d1*w(i, j, 3) - d2*w(i, j+1, 3&
&     ) + d3*w(i, j+2, 3) - d4*w(i, j+3, 3) + d5*w(i, j+4, 3)
    predrow2 = -(d5*w(i, j-5, 4)) + d4*w(i, j-4, 4) - d3*w(i, j-3, 4) + &
&     d2*w(i, j-2, 4) - d1*w(i, j-1, 4) + d1*w(i, j, 4) - d2*w(i, j+1, 4&
&     ) + d3*w(i, j+2, 4) - d4*w(i, j+3, 4) + d5*w(i, j+4, 4)
    predroe2 = -(d5*w(i, j-5, 5)) + d4*w(i, j-4, 5) - d3*w(i, j-3, 5) + &
&     d2*w(i, j-2, 5) - d1*w(i, j-1, 5) + d1*w(i, j, 5) - d2*w(i, j+1, 5&
&     ) + d3*w(i, j+2, 5) - d4*w(i, j+3, 5) + d5*w(i, j+4, 5)
! grad for viscous fluxes o2 - 3p
!
    volm1 = volf(i, j, 1)
! Normals
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    val_n = velx(i, j)
    val_s = velx(i-1, j)
    val_e = fourth*(velx(i, j)+velx(i, j-1)+velx(i-1, j)+velx(i-1, j-1))
    val_o = fourth*(velx(i, j)+velx(i, j+1)+velx(i-1, j)+velx(i-1, j+1))
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = vely(i, j)
    val_s = vely(i-1, j)
    val_e = fourth*(vely(i, j)+vely(i, j-1)+vely(i-1, j)+vely(i-1, j-1))
    val_o = fourth*(vely(i, j)+vely(i, j+1)+vely(i-1, j)+vely(i-1, j+1))
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = velz(i, j)
    val_s = velz(i-1, j)
    val_e = fourth*(velz(i, j)+velz(i, j-1)+velz(i-1, j)+velz(i-1, j-1))
    val_o = fourth*(velz(i, j)+velz(i, j+1)+velz(i-1, j)+velz(i-1, j+1))
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = tloc(i, j)
    val_s = tloc(i-1, j)
    val_e = fourth*(tloc(i, j)+tloc(i, j-1)+tloc(i-1, j)+tloc(i-1, j-1))
    val_o = fourth*(tloc(i, j)+tloc(i, j+1)+tloc(i-1, j)+tloc(i-1, j+1))
!
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
!
    mmu = half*(mu(i, j)+mu(i-1, j))
!
    fvrou1 = twothird*mmu*(two*ux-vy)
    fvrov1 = mmu*(uy+vx)
    fvrow1 = mmu*wx
!
    gvrou1 = mmu*(uy+vx)
    gvrov1 = twothird*mmu*(-ux+two*vy)
    gvrow1 = mmu*wy
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! grad for viscous fluxes o2 - 3p
!
    volm1 = volf(i, j, 2)
    nx_n = half*(nx(i+1, j-1, 1)+nx(i+1, j, 1))
    nx_s = -(half*(nx(i, j-1, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i, j+1, 2)+nx(i, j, 2))
    nx_e = -(half*(nx(i, j-1, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j-1, 1)+ny(i+1, j, 1))
    ny_s = -(half*(ny(i, j-1, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i, j+1, 2)+ny(i, j, 2))
    ny_e = -(half*(ny(i, j-1, 2)+ny(i, j, 2)))
    val_n = fourth*(velx(i, j)+velx(i+1, j)+velx(i, j-1)+velx(i+1, j-1))
    val_s = fourth*(velx(i, j)+velx(i-1, j)+velx(i, j-1)+velx(i-1, j-1))
    val_o = velx(i, j)
    val_e = velx(i, j-1)
    ad_save268 = ux
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save269 = uy
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = fourth*(vely(i, j)+vely(i+1, j)+vely(i, j-1)+vely(i+1, j-1))
    val_s = fourth*(vely(i, j)+vely(i-1, j)+vely(i, j-1)+vely(i-1, j-1))
    val_o = vely(i, j)
    val_e = vely(i, j-1)
    ad_save270 = vx
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save271 = vy
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = fourth*(velz(i, j)+velz(i+1, j)+velz(i, j-1)+velz(i+1, j-1))
    val_s = fourth*(velz(i, j)+velz(i-1, j)+velz(i, j-1)+velz(i-1, j-1))
    val_o = velz(i, j)
    val_e = velz(i, j-1)
    ad_save272 = wx
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save273 = wy
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = fourth*(tloc(i, j)+tloc(i+1, j)+tloc(i, j-1)+tloc(i+1, j-1))
    val_s = fourth*(tloc(i, j)+tloc(i-1, j)+tloc(i, j-1)+tloc(i-1, j-1))
    val_o = tloc(i, j)
    val_e = tloc(i, j-1)
    ad_save274 = tx
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save275 = ty
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    uu = half*(velx(i, j)+velx(i, j-1))
    vv = half*(vely(i, j)+vely(i, j-1))
    ww = half*(velz(i, j)+velz(i, j-1))
!
    mmu = half*(mu(i, j)+mu(i, j-1))
    lambda = half*(mu(i, j)+mu(i, j-1))*cpprandtl
!
    fvrou2 = twothird*mmu*(two*ux-vy)
    fvrov2 = mmu*(uy+vx)
    fvrow2 = mmu*wx
    gvrou2 = mmu*(uy+vx)
    gvrov2 = twothird*mmu*(-ux+two*vy)
    gvrow2 = mmu*wy
!!  fvrou2 = TWOTHIRD*mmu*( TWO*ux -     vy  -  wz  )
!!  fvrov2 =          mmu*(     uy +     vx         )
!!  fvrow2 =          mmu*(     uz           +  wx  )
!!  fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2 + ww * fvrow2)
!!
!!  gvrou2 =          mmu*(     uy +     vx       )
!!  gvrov2 = TWOTHIRD*mmu*(    -ux + TWO*vy -  wz )
!!  gvrow2 =          mmu*(              vz +  wy )
!!  gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2 + ww*gvrow2)
! #include "rhs/spectralradius_i.F"
! correction Rossow JCP 2000
!1st direction
    rhomr = w(i, j, 1)
    ur = w(i, j, 2)/rhomr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i-1, j, 1)
    ul = w(i-1, j, 2)/rhoml
    vl = w(i-1, j, 3)/rhoml
    c2l = gam*rgaz*tloc(i-1, j)
!
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    u = ul*rr + ur*omrr
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_branch63 = 0
      mach2 = one
    ELSE
      mach2 = vn2/c2x
      ad_branch63 = 1
    END IF
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    x9 = nx(i, j, 1)*u + ny(i, j, 1)*v
    IF (x9 .GE. 0.) THEN
      ab = x9
      ad_branch64 = 0
    ELSE
      ab = -x9
      ad_branch64 = 1
    END IF
    sq = SQRT(cprim*nx2)
!
    rspec = ab + sq
    IF (p(i-1, j) - two*p(i, j) + p(i+1, j) .GE. 0.) THEN
      abs16 = p(i-1, j) - two*p(i, j) + p(i+1, j)
      ad_branch65 = 1
    ELSE
      abs16 = -(p(i-1, j)-two*p(i, j)+p(i+1, j))
      ad_branch65 = 0
    END IF
    x28 = p(i-1, j) + two*p(i, j) + p(i+1, j)
    IF (x28 .GE. 0.) THEN
      abs38 = x28
      ad_branch66 = 0
    ELSE
      abs38 = -x28
      ad_branch66 = 1
    END IF
!
!1st direction
    k_sensor1 = abs16/abs38
    IF (p(i-2, j) - two*p(i-1, j) + p(i, j) .GE. 0.) THEN
      abs17 = p(i-2, j) - two*p(i-1, j) + p(i, j)
      ad_branch67 = 1
    ELSE
      abs17 = -(p(i-2, j)-two*p(i-1, j)+p(i, j))
      ad_branch67 = 0
    END IF
    x29 = p(i-2, j) + two*p(i-1, j) + p(i, j)
    IF (x29 .GE. 0.) THEN
      abs39 = x29
      ad_branch68 = 0
    ELSE
      abs39 = -x29
      ad_branch68 = 1
    END IF
    k_sensor2 = abs17/abs39
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    divu2 = divu*divu
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    ducros1 = divu2/(divu2+vort2+1d-15)
    dxm1 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    ad_save276 = divu2
    divu2 = divu*divu
    vort2 = (gradv(i-1, j, 1)-gradu(i-1, j, 2))*(gradv(i-1, j, 1)-gradu(&
&     i-1, j, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch69 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch69 = 1
    END IF
!     ! extension of shock capturing
!
!    k_sensor1 = ABS(p(i,j) - TWO*p(i+1,j) + p(i+2,j)) / &
!                ABS(p(i,j) + TWO*p(i+1,j) + p(i+2,j))
!
!    k_sensor2 = ABS(p(i-3,j) - TWO*p(i-2,j) + p(i-1,j)) / &
!                ABS(p(i-3,j) + TWO*p(i-2,j) + p(i-1,j))
!
!    divu2     = (gradu(i+1,j,1)+gradv(i+1,j,2)) * (gradu(i+1,j,1)+gradv(i+1,j,2))
!    vort2     = (gradv(i+1,j,1)-gradu(i+1,j,2)) * (gradv(i+1,j,1)-gradu(i+1,j,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i-2,j,1)+gradv(i-2,j,2)) * (gradu(i-2,j,1)+gradv(i-2,j,2))
!    vort2     = (gradv(i-2,j,1)-gradu(i-2,j,2)) * (gradv(i-2,j,1)-gradu(i-2,j,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                      k_sensor2*ducros2, coef)
!
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      eps4 = k4 - 12.d0*eps2
      ad_branch70 = 0
    ELSE
      ad_branch70 = 1
      eps4 = zero
    END IF
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_diri.F"
!     endif
! #include "rhs/spectralradius_j.F"
! correction Rossow JCP 2000
!2st direction
    rhomr = w(i, j, 1)
    ad_save277 = ur
    ur = w(i, j, 2)/rhomr
    ad_save278 = vr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i, j-1, 1)
    ul = w(i, j-1, 2)/rhoml
    vl = w(i, j-1, 3)/rhoml
    c2l = gam*rgaz*tloc(i, j-1)
!
    ad_save279 = r
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    ad_save280 = u
    u = ul*rr + ur*omrr
    ad_save281 = v
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    nx2 = nx(i, j, 2)*nx(i, j, 2) + ny(i, j, 2)*ny(i, j, 2)
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_save282 = mach2
      mach2 = one
      ad_branch71 = 0
    ELSE
      ad_save283 = mach2
      mach2 = vn2/c2x
      ad_branch71 = 1
    END IF
    ad_save284 = alpha
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    x10 = nx(i, j, 2)*u + ny(i, j, 2)*v
    IF (x10 .GE. 0.) THEN
      ab = x10
      ad_branch72 = 0
    ELSE
      ab = -x10
      ad_branch72 = 1
    END IF
    ad_save285 = sq
    sq = SQRT(cprim*nx2)
!
    ad_save286 = rspec
    rspec = ab + sq
    IF (p(i, j-1) - two*p(i, j) + p(i, j+1) .GE. 0.) THEN
      abs18 = p(i, j-1) - two*p(i, j) + p(i, j+1)
      ad_branch73 = 1
    ELSE
      abs18 = -(p(i, j-1)-two*p(i, j)+p(i, j+1))
      ad_branch73 = 0
    END IF
    x30 = p(i, j-1) + two*p(i, j) + p(i, j+1)
    IF (x30 .GE. 0.) THEN
      abs40 = x30
      ad_branch74 = 0
    ELSE
      abs40 = -x30
      ad_branch74 = 1
    END IF
!
! 2nd direction
    k_sensor1 = abs18/abs40
    IF (p(i, j-2) - two*p(i, j-1) + p(i, j) .GE. 0.) THEN
      abs19 = p(i, j-2) - two*p(i, j-1) + p(i, j)
      ad_branch75 = 1
    ELSE
      abs19 = -(p(i, j-2)-two*p(i, j-1)+p(i, j))
      ad_branch75 = 0
    END IF
    x31 = p(i, j-2) + two*p(i, j-1) + p(i, j)
    IF (x31 .GE. 0.) THEN
      abs41 = x31
      ad_branch76 = 0
    ELSE
      abs41 = -x31
      ad_branch76 = 1
    END IF
    k_sensor2 = abs19/abs41
!     ducros1 is done in dissipation_ducros_x
    divu = gradu(i, j-1, 1) + gradv(i, j-1, 2)
    divu2 = divu*divu
    ad_save287 = vort2
    vort2 = (gradv(i, j-1, 1)-gradu(i, j-1, 2))*(gradv(i, j-1, 1)-gradu(&
&     i, j-1, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
!sq = sound/dx
    ad_save288 = dxm2
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch77 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch77 = 1
    END IF
! extension of shock capturing
!    k_sensor1 = ABS(p(i,j) - TWO*p(i,j+1) + p(i,j+2)) / &
!                ABS(p(i,j) + TWO*p(i,j+1) + p(i,j+2))
!
!    k_sensor2 = ABS(p(i,j-3) - TWO*p(i,j-2) + p(i,j-1)) / &
!                ABS(p(i,j-3) + TWO*p(i,j-2) + p(i,j-1))
!
!    divu2     = (gradu(i,j+1,1)+gradv(i,j+1,2)) * (gradu(i,j+1,1)+gradv(i,j+1,2))
!    vort2     = (gradv(i,j+1,1)-gradu(i,j+1,2)) * (gradv(i,j+1,1)-gradu(i,j+1,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i,j-2,1)+gradv(i,j-2,2)) * (gradu(i,j-2,1)+gradv(i,j-2,2))
!    vort2     = (gradv(i,j-2,1)-gradu(i,j-2,2)) * (gradv(i,j-2,1)-gradu(i,j-2,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                     k_sensor2*ducros2, coef)
    ad_save289 = eps2
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      ad_save290 = eps4
      eps4 = k4 - 12.d0*eps2
      ad_branch78 = 0
    ELSE
      ad_save291 = eps4
      eps4 = zero
      ad_branch78 = 1
    END IF
    diffro = half*(w(i, j, 1)-w(i, j-1, 1))
    diffrou = half*(w(i, j, 2)-w(i, j-1, 2))
    diffrov = half*(w(i, j, 3)-w(i, j-1, 3))
    diffrow = half*(w(i, j, 4)-w(i, j-1, 4))
    diffroe = half*(w(i, j, 5)-w(i, j-1, 5))
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_dirj.F"
!     endif
!
    sc1 = nx(i, j, 1)
    sc2 = ny(i, j, 1)
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    nxloc = sc1*invsn
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
    sc1 = nx(i, j, 2)
    sc2 = ny(i, j, 2)
    ad_save292 = sn
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    ad_save293 = nxloc
    nxloc = sc1*invsn
    ad_save294 = nyloc
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,2) = ZERO
!
    fxroe2b = hnb(i, j, 5, 2)
    dissroe2b = -hnb(i, j, 5, 2)
    fvroe2b = -(nxloc*sn*hnb(i, j, 5, 2))
    gvroe2b = -(nyloc*sn*hnb(i, j, 5, 2))
    hnb(i, j, 5, 2) = 0.0_8
    fxrow2b = hnb(i, j, 4, 2)
    dissrow2b = -hnb(i, j, 4, 2)
    fvrow2b = -(nxloc*sn*hnb(i, j, 4, 2))
    gvrow2b = -(nyloc*sn*hnb(i, j, 4, 2))
    hnb(i, j, 4, 2) = 0.0_8
    fxrov2b = hnb(i, j, 3, 2)
    dissrov2b = -hnb(i, j, 3, 2)
    fvrov2b = -(nxloc*sn*hnb(i, j, 3, 2))
    gvrov2b = -(nyloc*sn*hnb(i, j, 3, 2))
    hnb(i, j, 3, 2) = 0.0_8
    fxrou2b = hnb(i, j, 2, 2)
    dissrou2b = -hnb(i, j, 2, 2)
    fvrou2b = -(nxloc*sn*hnb(i, j, 2, 2))
    gvrou2b = -(nyloc*sn*hnb(i, j, 2, 2))
    hnb(i, j, 2, 2) = 0.0_8
    fxro2b = hnb(i, j, 1, 2)
    dissro2b = -hnb(i, j, 1, 2)
    hnb(i, j, 1, 2) = 0.0_8
    nyloc = ad_save294
    nxloc = ad_save293
    sn = ad_save292
    fxroe1b = hnb(i, j, 5, 1)
    dissroe1b = -hnb(i, j, 5, 1)
    fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
    gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
    hnb(i, j, 5, 1) = 0.0_8
    fxrow1b = hnb(i, j, 4, 1)
    dissrow1b = -hnb(i, j, 4, 1)
    fvrow1b = -(nxloc*sn*hnb(i, j, 4, 1))
    gvrow1b = -(nyloc*sn*hnb(i, j, 4, 1))
    hnb(i, j, 4, 1) = 0.0_8
    fxrov1b = hnb(i, j, 3, 1)
    dissrov1b = -hnb(i, j, 3, 1)
    fvrov1b = -(nxloc*sn*hnb(i, j, 3, 1))
    gvrov1b = -(nyloc*sn*hnb(i, j, 3, 1))
    hnb(i, j, 3, 1) = 0.0_8
    fxrou1b = hnb(i, j, 2, 1)
    dissrou1b = -hnb(i, j, 2, 1)
    fvrou1b = -(nxloc*sn*hnb(i, j, 2, 1))
    gvrou1b = -(nyloc*sn*hnb(i, j, 2, 1))
    hnb(i, j, 2, 1) = 0.0_8
    fxro1b = hnb(i, j, 1, 1)
    dissro1b = -hnb(i, j, 1, 1)
    hnb(i, j, 1, 1) = 0.0_8
    rspecb = (eps2*diffroe+eps4*predroe2)*dissroe2b + (eps2*diffrow+eps4&
&     *predrow2)*dissrow2b + (eps2*diffrov+eps4*predrov2)*dissrov2b + (&
&     eps2*diffrou+eps4*predrou2)*dissrou2b + (eps2*diffro+eps4*predro2)&
&     *dissro2b
    tempb1 = rspec*dissroe2b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe2*tempb1
    predroe2b = eps4*tempb1
    tempb1 = rspec*dissrow2b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow2*tempb1
    predrow2b = eps4*tempb1
    tempb1 = rspec*dissrov2b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    eps4b = eps4b + predrov2*tempb1
    predrov2b = eps4*tempb1
    tempb1 = rspec*dissrou2b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    eps4b = eps4b + predrou2*tempb1
    predrou2b = eps4*tempb1
    tempb1 = rspec*dissro2b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    eps4b = eps4b + predro2*tempb1
    predro2b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i, j-1, 5) = wb(i, j-1, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i, j-1, 4) = wb(i, j-1, 4) - half*diffrowb
    wb(i, j, 3) = wb(i, j, 3) + half*diffrovb
    wb(i, j-1, 3) = wb(i, j-1, 3) - half*diffrovb
    wb(i, j, 2) = wb(i, j, 2) + half*diffroub
    wb(i, j-1, 2) = wb(i, j-1, 2) - half*diffroub
    wb(i, j, 1) = wb(i, j, 1) + half*diffrob
    wb(i, j-1, 1) = wb(i, j-1, 1) - half*diffrob
    IF (ad_branch78 .EQ. 0) THEN
      eps4 = ad_save290
      eps2b = eps2b - 12.d0*eps4b
    ELSE
      eps4 = ad_save291
    END IF
    eps2 = ad_save289
    coefb = k2*eps2b
    IF (ad_branch77 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      dxm1b = 0.0_8
      k_sensor1b = 0.0_8
      ducros1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = k_sensor1*dxm1*coefb
      dxm1b = k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    dxm2 = ad_save288
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    vort2 = ad_save287
    tempb1 = 2*(gradv(i, j-1, 1)-gradu(i, j-1, 2))*vort2b
    gradvb(i, j-1, 1) = gradvb(i, j-1, 1) + tempb1
    gradub(i, j-1, 2) = gradub(i, j-1, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j-1, 1) = gradub(i, j-1, 1) + divub
    gradvb(i, j-1, 2) = gradvb(i, j-1, 2) + divub
    abs19b = k_sensor2b/abs41
    abs41b = -(abs19*k_sensor2b/abs41**2)
    IF (ad_branch76 .EQ. 0) THEN
      x31b = abs41b
    ELSE
      x31b = -abs41b
    END IF
    pb(i, j-2) = pb(i, j-2) + x31b
    pb(i, j-1) = pb(i, j-1) + two*x31b
    pb(i, j) = pb(i, j) + x31b
    IF (ad_branch75 .EQ. 0) THEN
      pb(i, j-1) = pb(i, j-1) + two*abs19b
      pb(i, j-2) = pb(i, j-2) - abs19b
      pb(i, j) = pb(i, j) - abs19b
    ELSE
      pb(i, j-2) = pb(i, j-2) + abs19b
      pb(i, j-1) = pb(i, j-1) - two*abs19b
      pb(i, j) = pb(i, j) + abs19b
    END IF
    abs18b = k_sensor1b/abs40
    abs40b = -(abs18*k_sensor1b/abs40**2)
    IF (ad_branch74 .EQ. 0) THEN
      x30b = abs40b
    ELSE
      x30b = -abs40b
    END IF
    pb(i, j-1) = pb(i, j-1) + x30b
    pb(i, j) = pb(i, j) + two*x30b
    pb(i, j+1) = pb(i, j+1) + x30b
    IF (ad_branch73 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs18b
      pb(i, j-1) = pb(i, j-1) - abs18b
      pb(i, j+1) = pb(i, j+1) - abs18b
    ELSE
      pb(i, j-1) = pb(i, j-1) + abs18b
      pb(i, j) = pb(i, j) - two*abs18b
      pb(i, j+1) = pb(i, j+1) + abs18b
    END IF
    rspec = ad_save286
    abb = rspecb
    sqb = sqb + rspecb
    sq = ad_save285
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch72 .EQ. 0) THEN
      x10b = abb
    ELSE
      x10b = -abb
    END IF
    ub = nx(i, j, 2)*x10b
    vb = ny(i, j, 2)*x10b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    alpha = ad_save284
    IF (ad_branch71 .EQ. 0) THEN
      mach2 = ad_save282
    ELSE
      mach2 = ad_save283
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    diffro = half*(w(i, j, 1)-w(i-1, j, 1))
    diffrou = half*(w(i, j, 2)-w(i-1, j, 2))
    diffrov = half*(w(i, j, 3)-w(i-1, j, 3))
    diffrow = half*(w(i, j, 4)-w(i-1, j, 4))
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    v = ad_save281
    vlb = rr*vb
    vrb = omrr*vb
    u = ad_save280
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    r = ad_save279
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i, j-1, 3)*vlb/rhoml**2 - w(i, j-&
&     1, 2)*ulb/rhoml**2
    tlocb(i, j-1) = tlocb(i, j-1) + gam*rgaz*c2lb
    wb(i, j-1, 3) = wb(i, j-1, 3) + vlb/rhoml
    wb(i, j-1, 2) = wb(i, j-1, 2) + ulb/rhoml
    wb(i, j-1, 1) = wb(i, j-1, 1) + rhomlb
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb
    rhoml = w(i-1, j, 1)
    rr = one/(one+r)
    vl = w(i-1, j, 3)/rhoml
    omrr = one - rr
    vr = ad_save278
    ul = w(i-1, j, 2)/rhoml
    ur = ad_save277
    diffroe = half*(w(i, j, 5)-w(i-1, j, 5))
    rspecb = (eps2*diffroe+eps4*predroe1)*dissroe1b + (eps2*diffrow+eps4&
&     *predrow1)*dissrow1b + (eps2*diffrov+eps4*predrov1)*dissrov1b + (&
&     eps2*diffrou+eps4*predrou1)*dissrou1b + (eps2*diffro+eps4*predro1)&
&     *dissro1b
    tempb1 = rspec*dissroe1b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe1*tempb1
    predroe1b = eps4*tempb1
    tempb1 = rspec*dissrow1b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow1*tempb1
    predrow1b = eps4*tempb1
    tempb1 = rspec*dissrov1b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + half*diffrovb
    eps4b = eps4b + predrov1*tempb1
    predrov1b = eps4*tempb1
    tempb1 = rspec*dissrou1b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + half*diffroub
    rhomr = w(i, j, 1)
    eps4b = eps4b + predrou1*tempb1
    predrou1b = eps4*tempb1
    tempb1 = rspec*dissro1b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + half*diffrob
    eps4b = eps4b + predro1*tempb1
    predro1b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i-1, j, 5) = wb(i-1, j, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i-1, j, 4) = wb(i-1, j, 4) - half*diffrowb
    wb(i-1, j, 3) = wb(i-1, j, 3) - half*diffrovb
    wb(i-1, j, 2) = wb(i-1, j, 2) - half*diffroub
    wb(i-1, j, 1) = wb(i-1, j, 1) - half*diffrob
    IF (ad_branch70 .EQ. 0) eps2b = eps2b - 12.d0*eps4b
    coefb = k2*eps2b
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    divu2 = divu*divu
    k_sensor1 = abs16/abs38
    k_sensor2 = abs17/abs39
    ducros2 = divu2/(divu2+vort2+1d-15)
    IF (ad_branch69 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      k_sensor1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = ducros1b + k_sensor1*dxm1*coefb
      dxm1b = dxm1b + k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i-1, j, 1)-gradu(i-1, j, 2))*vort2b
    gradvb(i-1, j, 1) = gradvb(i-1, j, 1) + tempb1
    gradub(i-1, j, 2) = gradub(i-1, j, 2) - tempb1
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    divu2 = ad_save276
    divub = divub + 2*divu*divu2b
    gradub(i-1, j, 1) = gradub(i-1, j, 1) + divub
    gradvb(i-1, j, 2) = gradvb(i-1, j, 2) + divub
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm1b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = sqb - temp1*tempb1
    tempb1 = ducros1b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i, j, 1)-gradu(i, j, 2))*vort2b
    gradvb(i, j, 1) = gradvb(i, j, 1) + tempb1
    gradub(i, j, 2) = gradub(i, j, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j, 1) = gradub(i, j, 1) + divub
    gradvb(i, j, 2) = gradvb(i, j, 2) + divub
    abs17b = k_sensor2b/abs39
    abs39b = -(abs17*k_sensor2b/abs39**2)
    IF (ad_branch68 .EQ. 0) THEN
      x29b = abs39b
    ELSE
      x29b = -abs39b
    END IF
    pb(i-2, j) = pb(i-2, j) + x29b
    pb(i-1, j) = pb(i-1, j) + two*x29b
    pb(i, j) = pb(i, j) + x29b
    IF (ad_branch67 .EQ. 0) THEN
      pb(i-1, j) = pb(i-1, j) + two*abs17b
      pb(i-2, j) = pb(i-2, j) - abs17b
      pb(i, j) = pb(i, j) - abs17b
    ELSE
      pb(i-2, j) = pb(i-2, j) + abs17b
      pb(i-1, j) = pb(i-1, j) - two*abs17b
      pb(i, j) = pb(i, j) + abs17b
    END IF
    abs16b = k_sensor1b/abs38
    abs38b = -(abs16*k_sensor1b/abs38**2)
    IF (ad_branch66 .EQ. 0) THEN
      x28b = abs38b
    ELSE
      x28b = -abs38b
    END IF
    pb(i-1, j) = pb(i-1, j) + x28b
    pb(i, j) = pb(i, j) + two*x28b
    pb(i+1, j) = pb(i+1, j) + x28b
    IF (ad_branch65 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs16b
      pb(i-1, j) = pb(i-1, j) - abs16b
      pb(i+1, j) = pb(i+1, j) - abs16b
    ELSE
      pb(i-1, j) = pb(i-1, j) + abs16b
      pb(i, j) = pb(i, j) - two*abs16b
      pb(i+1, j) = pb(i+1, j) + abs16b
    END IF
    abb = rspecb
    sqb = sqb + rspecb
    c2r = gam*rgaz*tloc(i, j)
    c2l = gam*rgaz*tloc(i-1, j)
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    cprim = alpha*alpha*vn2 + mach2*c2x
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch64 .EQ. 0) THEN
      x9b = abb
    ELSE
      x9b = -abb
    END IF
    ub = nx(i, j, 1)*x9b
    vb = ny(i, j, 1)*x9b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    IF (ad_branch63 .NE. 0) THEN
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    fvrov2b = fvrov2b + vv*fvroe2b
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    vlb = rr*vb
    vrb = omrr*vb
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i-1, j, 3)*vlb/rhoml**2 - w(i-1, &
&     j, 2)*ulb/rhoml**2
    wb(i-1, j, 3) = wb(i-1, j, 3) + vlb/rhoml - d1*predrov1b
    wb(i-1, j, 2) = wb(i-1, j, 2) + ulb/rhoml - d1*predrou1b
    wb(i-1, j, 1) = wb(i-1, j, 1) + rhomlb - d1*predro1b
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + d1*predrov2b + d1*predrov1b
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + d1*predrou2b + d1*predrou1b
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + d1*predro2b + d1*predro1b
    lambdab = ty*gvroe2b + tx*fvroe2b
    tyb = lambda*gvroe2b
    uub = gvrou2*gvroe2b + fvrou2*fvroe2b
    gvrou2b = gvrou2b + uu*gvroe2b
    vvb = gvrov2*gvroe2b + fvrov2*fvroe2b
    gvrov2b = gvrov2b + vv*gvroe2b
    wwb = gvrow2*gvroe2b + fvrow2*fvroe2b
    gvrow2b = gvrow2b + ww*gvroe2b
    wyb = mmu*gvrow2b
    tempb1 = twothird*gvrov2b
    mmub = wy*gvrow2b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    uyb = mmu*gvrou2b + mmu*fvrov2b
    vxb = mmu*gvrou2b + mmu*fvrov2b
    txb = lambda*fvroe2b
    fvrou2b = fvrou2b + uu*fvroe2b
    fvrow2b = fvrow2b + ww*fvroe2b
    wxb = mmu*fvrow2b
    tempb1 = twothird*fvrou2b
    mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (two*&
&     ux-vy)*tempb1
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    tempb1 = half*cpprandtl*lambdab
    mub(i, j) = mub(i, j) + tempb1 + half*mmub
    mub(i, j-1) = mub(i, j-1) + tempb1 + half*mmub
    ty = ad_save275
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tx = ad_save274
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_sb
    tlocb(i-1, j) = tlocb(i-1, j) + gam*rgaz*c2lb + tempb1
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb + val_ob + tempb1
    tlocb(i, j-1) = tlocb(i, j-1) + val_eb + tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + tempb1
    tempb1 = fourth*val_nb
    tlocb(i, j) = tlocb(i, j) + tempb1
    tlocb(i+1, j) = tlocb(i+1, j) + tempb1
    tlocb(i, j-1) = tlocb(i, j-1) + tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + tempb1
    mmu = half*(mu(i, j)+mu(i-1, j))
    wy = ad_save273
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    wx = ad_save272
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_sb
    velzb(i, j) = velzb(i, j) + half*wwb + val_ob + tempb1
    velzb(i, j-1) = velzb(i, j-1) + half*wwb + val_eb + tempb1
    velzb(i-1, j) = velzb(i-1, j) + tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) + tempb1
    tempb1 = fourth*val_nb
    velzb(i, j) = velzb(i, j) + tempb1
    velzb(i+1, j) = velzb(i+1, j) + tempb1
    velzb(i, j-1) = velzb(i, j-1) + tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + tempb1
    vy = ad_save271
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    vx = ad_save270
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_sb
    velyb(i, j) = velyb(i, j) + half*vvb + val_ob + tempb1
    velyb(i, j-1) = velyb(i, j-1) + half*vvb + val_eb + tempb1
    velyb(i-1, j) = velyb(i-1, j) + tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) + tempb1
    tempb1 = fourth*val_nb
    velyb(i, j) = velyb(i, j) + tempb1
    velyb(i+1, j) = velyb(i+1, j) + tempb1
    velyb(i, j-1) = velyb(i, j-1) + tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + tempb1
    uy = ad_save269
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    ux = ad_save268
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_sb
    velxb(i, j) = velxb(i, j) + half*uub + val_ob + tempb1
    velxb(i, j-1) = velxb(i, j-1) + half*uub + val_eb + tempb1
    velxb(i-1, j) = velxb(i-1, j) + tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) + tempb1
    tempb1 = fourth*val_nb
    velxb(i, j) = velxb(i, j) + tempb1
    velxb(i+1, j) = velxb(i+1, j) + tempb1
    velxb(i, j-1) = velxb(i, j-1) + tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + tempb1
    ww = half*(velz(i, j)+velz(i-1, j))
    lambda = half*(mu(i, j)+mu(i-1, j))*cpprandtl
    uu = half*(velx(i, j)+velx(i-1, j))
    vv = half*(vely(i, j)+vely(i-1, j))
    lambdab = ty*gvroe1b + tx*fvroe1b
    tyb = lambda*gvroe1b
    uub = gvrou1*gvroe1b + fvrou1*fvroe1b
    gvrou1b = gvrou1b + uu*gvroe1b
    vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
    gvrov1b = gvrov1b + vv*gvroe1b
    wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
    gvrow1b = gvrow1b + ww*gvroe1b
    wyb = mmu*gvrow1b
    tempb1 = twothird*gvrov1b
    mmub = wy*gvrow1b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    txb = lambda*fvroe1b
    fvrou1b = fvrou1b + uu*fvroe1b
    fvrov1b = fvrov1b + vv*fvroe1b
    uyb = mmu*gvrou1b + mmu*fvrov1b
    vxb = mmu*gvrou1b + mmu*fvrov1b
    fvrow1b = fvrow1b + ww*fvroe1b
    wxb = mmu*fvrow1b
    tempb1 = twothird*fvrou1b
    mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (two*&
&     ux-vy)*tempb1
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    tempb1 = half*cpprandtl*lambdab
    mub(i, j) = mub(i, j) + tempb1 + half*mmub
    mub(i-1, j) = mub(i-1, j) + tempb1 + half*mmub
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    volm1 = volf(i, j, 1)
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    tlocb(i, j) = tlocb(i, j) + tempb1
    tlocb(i, j+1) = tlocb(i, j+1) + tempb1
    tlocb(i-1, j) = tlocb(i-1, j) + tempb1
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    tlocb(i, j) = tlocb(i, j) + tempb1 + val_nb
    tlocb(i, j-1) = tlocb(i, j-1) + tempb1
    tlocb(i-1, j) = tlocb(i-1, j) + tempb1 + val_sb
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + tempb1
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    velzb(i, j) = velzb(i, j) + half*wwb + tempb1
    velzb(i-1, j) = velzb(i-1, j) + half*wwb + tempb1
    velzb(i, j+1) = velzb(i, j+1) + tempb1
    velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    velzb(i, j) = velzb(i, j) + tempb1 + val_nb
    velzb(i, j-1) = velzb(i, j-1) + tempb1
    velzb(i-1, j) = velzb(i-1, j) + tempb1 + val_sb
    velzb(i-1, j-1) = velzb(i-1, j-1) + tempb1
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    velyb(i, j) = velyb(i, j) + half*vvb + tempb1
    velyb(i-1, j) = velyb(i-1, j) + half*vvb + tempb1
    velyb(i, j+1) = velyb(i, j+1) + tempb1
    velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    velyb(i, j) = velyb(i, j) + tempb1 + val_nb
    velyb(i, j-1) = velyb(i, j-1) + tempb1
    velyb(i-1, j) = velyb(i-1, j) + tempb1 + val_sb
    velyb(i-1, j-1) = velyb(i-1, j-1) + tempb1
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = fourth*val_ob
    velxb(i, j) = velxb(i, j) + half*uub + tempb1
    velxb(i-1, j) = velxb(i-1, j) + half*uub + tempb1
    velxb(i, j+1) = velxb(i, j+1) + tempb1
    velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1
    tempb1 = fourth*val_eb
    velxb(i, j) = velxb(i, j) + tempb1 + val_nb
    velxb(i, j-1) = velxb(i, j-1) + tempb1
    velxb(i-1, j) = velxb(i-1, j) + tempb1 + val_sb
    velxb(i-1, j-1) = velxb(i-1, j-1) + tempb1
    wb(i, j-4, 5) = wb(i, j-4, 5) + d4*predroe2b
    wb(i, j-5, 5) = wb(i, j-5, 5) - d5*predroe2b
    wb(i, j-3, 5) = wb(i, j-3, 5) - d3*predroe2b
    wb(i, j-2, 5) = wb(i, j-2, 5) + d2*predroe2b
    wb(i, j-1, 5) = wb(i, j-1, 5) - d1*predroe2b
    wb(i, j, 5) = wb(i, j, 5) + d1*predroe2b + d1*predroe1b
    wb(i, j+1, 5) = wb(i, j+1, 5) - d2*predroe2b
    wb(i, j+2, 5) = wb(i, j+2, 5) + d3*predroe2b
    wb(i, j+4, 5) = wb(i, j+4, 5) + d5*predroe2b
    wb(i, j+3, 5) = wb(i, j+3, 5) - d4*predroe2b
    wb(i, j-4, 4) = wb(i, j-4, 4) + d4*predrow2b
    wb(i, j-5, 4) = wb(i, j-5, 4) - d5*predrow2b
    wb(i, j-3, 4) = wb(i, j-3, 4) - d3*predrow2b
    wb(i, j-2, 4) = wb(i, j-2, 4) + d2*predrow2b
    wb(i, j-1, 4) = wb(i, j-1, 4) - d1*predrow2b
    wb(i, j, 4) = wb(i, j, 4) + d1*predrow2b + d1*predrow1b
    wb(i, j+1, 4) = wb(i, j+1, 4) - d2*predrow2b
    wb(i, j+2, 4) = wb(i, j+2, 4) + d3*predrow2b
    wb(i, j+4, 4) = wb(i, j+4, 4) + d5*predrow2b
    wb(i, j+3, 4) = wb(i, j+3, 4) - d4*predrow2b
    wb(i, j-4, 3) = wb(i, j-4, 3) + d4*predrov2b
    wb(i, j-5, 3) = wb(i, j-5, 3) - d5*predrov2b
    wb(i, j-3, 3) = wb(i, j-3, 3) - d3*predrov2b
    wb(i, j-2, 3) = wb(i, j-2, 3) + d2*predrov2b
    wb(i, j-1, 3) = wb(i, j-1, 3) - d1*predrov2b
    wb(i, j+1, 3) = wb(i, j+1, 3) - d2*predrov2b
    wb(i, j+2, 3) = wb(i, j+2, 3) + d3*predrov2b
    wb(i, j+4, 3) = wb(i, j+4, 3) + d5*predrov2b
    wb(i, j+3, 3) = wb(i, j+3, 3) - d4*predrov2b
    wb(i, j-4, 2) = wb(i, j-4, 2) + d4*predrou2b
    wb(i, j-5, 2) = wb(i, j-5, 2) - d5*predrou2b
    wb(i, j-3, 2) = wb(i, j-3, 2) - d3*predrou2b
    wb(i, j-2, 2) = wb(i, j-2, 2) + d2*predrou2b
    wb(i, j-1, 2) = wb(i, j-1, 2) - d1*predrou2b
    wb(i, j+1, 2) = wb(i, j+1, 2) - d2*predrou2b
    wb(i, j+2, 2) = wb(i, j+2, 2) + d3*predrou2b
    wb(i, j+4, 2) = wb(i, j+4, 2) + d5*predrou2b
    wb(i, j+3, 2) = wb(i, j+3, 2) - d4*predrou2b
    wb(i, j-4, 1) = wb(i, j-4, 1) + d4*predro2b
    wb(i, j-5, 1) = wb(i, j-5, 1) - d5*predro2b
    wb(i, j-3, 1) = wb(i, j-3, 1) - d3*predro2b
    wb(i, j-2, 1) = wb(i, j-2, 1) + d2*predro2b
    wb(i, j-1, 1) = wb(i, j-1, 1) - d1*predro2b
    wb(i, j+1, 1) = wb(i, j+1, 1) - d2*predro2b
    wb(i, j+2, 1) = wb(i, j+2, 1) + d3*predro2b
    wb(i, j+4, 1) = wb(i, j+4, 1) + d5*predro2b
    wb(i, j+3, 1) = wb(i, j+3, 1) - d4*predro2b
    wb(i-4, j, 5) = wb(i-4, j, 5) + d4*predroe1b
    wb(i-5, j, 5) = wb(i-5, j, 5) - d5*predroe1b
    wb(i-3, j, 5) = wb(i-3, j, 5) - d3*predroe1b
    wb(i-2, j, 5) = wb(i-2, j, 5) + d2*predroe1b
    wb(i-1, j, 5) = wb(i-1, j, 5) - d1*predroe1b
    wb(i+1, j, 5) = wb(i+1, j, 5) - d2*predroe1b
    wb(i+2, j, 5) = wb(i+2, j, 5) + d3*predroe1b
    wb(i+4, j, 5) = wb(i+4, j, 5) + d5*predroe1b
    wb(i+3, j, 5) = wb(i+3, j, 5) - d4*predroe1b
    wb(i-4, j, 4) = wb(i-4, j, 4) + d4*predrow1b
    wb(i-5, j, 4) = wb(i-5, j, 4) - d5*predrow1b
    wb(i-3, j, 4) = wb(i-3, j, 4) - d3*predrow1b
    wb(i-2, j, 4) = wb(i-2, j, 4) + d2*predrow1b
    wb(i-1, j, 4) = wb(i-1, j, 4) - d1*predrow1b
    wb(i+1, j, 4) = wb(i+1, j, 4) - d2*predrow1b
    wb(i+2, j, 4) = wb(i+2, j, 4) + d3*predrow1b
    wb(i+4, j, 4) = wb(i+4, j, 4) + d5*predrow1b
    wb(i+3, j, 4) = wb(i+3, j, 4) - d4*predrow1b
    wb(i-4, j, 3) = wb(i-4, j, 3) + d4*predrov1b
    wb(i-5, j, 3) = wb(i-5, j, 3) - d5*predrov1b
    wb(i-3, j, 3) = wb(i-3, j, 3) - d3*predrov1b
    wb(i-2, j, 3) = wb(i-2, j, 3) + d2*predrov1b
    wb(i+1, j, 3) = wb(i+1, j, 3) - d2*predrov1b
    wb(i+2, j, 3) = wb(i+2, j, 3) + d3*predrov1b
    wb(i+4, j, 3) = wb(i+4, j, 3) + d5*predrov1b
    wb(i+3, j, 3) = wb(i+3, j, 3) - d4*predrov1b
    wb(i-4, j, 2) = wb(i-4, j, 2) + d4*predrou1b
    wb(i-5, j, 2) = wb(i-5, j, 2) - d5*predrou1b
    wb(i-3, j, 2) = wb(i-3, j, 2) - d3*predrou1b
    wb(i-2, j, 2) = wb(i-2, j, 2) + d2*predrou1b
    wb(i+1, j, 2) = wb(i+1, j, 2) - d2*predrou1b
    wb(i+2, j, 2) = wb(i+2, j, 2) + d3*predrou1b
    wb(i+4, j, 2) = wb(i+4, j, 2) + d5*predrou1b
    wb(i+3, j, 2) = wb(i+3, j, 2) - d4*predrou1b
    wb(i-4, j, 1) = wb(i-4, j, 1) + d4*predro1b
    wb(i-5, j, 1) = wb(i-5, j, 1) - d5*predro1b
    wb(i-3, j, 1) = wb(i-3, j, 1) - d3*predro1b
    wb(i-2, j, 1) = wb(i-2, j, 1) + d2*predro1b
    wb(i+1, j, 1) = wb(i+1, j, 1) - d2*predro1b
    wb(i+2, j, 1) = wb(i+2, j, 1) + d3*predro1b
    wb(i+4, j, 1) = wb(i+4, j, 1) + d5*predro1b
    wb(i+3, j, 1) = wb(i+3, j, 1) - d4*predro1b
    tempb1 = nx(i, j, 2)*fxroe2b
    tempb0 = ny(i, j, 2)*fxroe2b
    gb(i, 1, 5) = gb(i, 1, 5) + c3d0*tempb0
    gb(i, 2, 5) = gb(i, 2, 5) + c3d1*tempb0
    gb(i, 3, 5) = gb(i, 3, 5) + c3d2*tempb0
    gb(i, 4, 5) = gb(i, 4, 5) + c3d3*tempb0
    gb(i, 5, 5) = gb(i, 5, 5) + c3d4*tempb0
    gb(i, 6, 5) = gb(i, 6, 5) + c3d5*tempb0
    gb(i, 7, 5) = gb(i, 7, 5) + c3d6*tempb0
    gb(i, 8, 5) = gb(i, 8, 5) + c3d7*tempb0
    gb(i, 9, 5) = gb(i, 9, 5) + c3d8*tempb0
    gb(i, 10, 5) = gb(i, 10, 5) + c3d9*tempb0
    gb(i, 11, 5) = gb(i, 11, 5) + c3d10*tempb0
    fb(i, 1, 5) = fb(i, 1, 5) + c3d0*tempb1
    fb(i, 2, 5) = fb(i, 2, 5) + c3d1*tempb1
    fb(i, 3, 5) = fb(i, 3, 5) + c3d2*tempb1
    fb(i, 4, 5) = fb(i, 4, 5) + c3d3*tempb1
    fb(i, 5, 5) = fb(i, 5, 5) + c3d4*tempb1
    fb(i, 6, 5) = fb(i, 6, 5) + c3d5*tempb1
    fb(i, 7, 5) = fb(i, 7, 5) + c3d6*tempb1
    fb(i, 8, 5) = fb(i, 8, 5) + c3d7*tempb1
    fb(i, 9, 5) = fb(i, 9, 5) + c3d8*tempb1
    fb(i, 10, 5) = fb(i, 10, 5) + c3d9*tempb1
    fb(i, 11, 5) = fb(i, 11, 5) + c3d10*tempb1
    tempb1 = nx(i, j, 2)*fxrow2b
    tempb0 = ny(i, j, 2)*fxrow2b
    gb(i, 1, 4) = gb(i, 1, 4) + c3d0*tempb0
    gb(i, 2, 4) = gb(i, 2, 4) + c3d1*tempb0
    gb(i, 3, 4) = gb(i, 3, 4) + c3d2*tempb0
    gb(i, 4, 4) = gb(i, 4, 4) + c3d3*tempb0
    gb(i, 5, 4) = gb(i, 5, 4) + c3d4*tempb0
    gb(i, 6, 4) = gb(i, 6, 4) + c3d5*tempb0
    gb(i, 7, 4) = gb(i, 7, 4) + c3d6*tempb0
    gb(i, 8, 4) = gb(i, 8, 4) + c3d7*tempb0
    gb(i, 9, 4) = gb(i, 9, 4) + c3d8*tempb0
    gb(i, 10, 4) = gb(i, 10, 4) + c3d9*tempb0
    gb(i, 11, 4) = gb(i, 11, 4) + c3d10*tempb0
    fb(i, 1, 4) = fb(i, 1, 4) + c3d0*tempb1
    fb(i, 2, 4) = fb(i, 2, 4) + c3d1*tempb1
    fb(i, 3, 4) = fb(i, 3, 4) + c3d2*tempb1
    fb(i, 4, 4) = fb(i, 4, 4) + c3d3*tempb1
    fb(i, 5, 4) = fb(i, 5, 4) + c3d4*tempb1
    fb(i, 6, 4) = fb(i, 6, 4) + c3d5*tempb1
    fb(i, 7, 4) = fb(i, 7, 4) + c3d6*tempb1
    fb(i, 8, 4) = fb(i, 8, 4) + c3d7*tempb1
    fb(i, 9, 4) = fb(i, 9, 4) + c3d8*tempb1
    fb(i, 10, 4) = fb(i, 10, 4) + c3d9*tempb1
    fb(i, 11, 4) = fb(i, 11, 4) + c3d10*tempb1
    tempb1 = nx(i, j, 2)*fxrov2b
    tempb0 = ny(i, j, 2)*fxrov2b
    gb(i, 1, 3) = gb(i, 1, 3) + c3d0*tempb0
    gb(i, 2, 3) = gb(i, 2, 3) + c3d1*tempb0
    gb(i, 3, 3) = gb(i, 3, 3) + c3d2*tempb0
    gb(i, 4, 3) = gb(i, 4, 3) + c3d3*tempb0
    gb(i, 5, 3) = gb(i, 5, 3) + c3d4*tempb0
    gb(i, 6, 3) = gb(i, 6, 3) + c3d5*tempb0
    gb(i, 7, 3) = gb(i, 7, 3) + c3d6*tempb0
    gb(i, 8, 3) = gb(i, 8, 3) + c3d7*tempb0
    gb(i, 9, 3) = gb(i, 9, 3) + c3d8*tempb0
    gb(i, 10, 3) = gb(i, 10, 3) + c3d9*tempb0
    gb(i, 11, 3) = gb(i, 11, 3) + c3d10*tempb0
    fb(i, 1, 3) = fb(i, 1, 3) + c3d0*tempb1
    fb(i, 2, 3) = fb(i, 2, 3) + c3d1*tempb1
    fb(i, 3, 3) = fb(i, 3, 3) + c3d2*tempb1
    fb(i, 4, 3) = fb(i, 4, 3) + c3d3*tempb1
    fb(i, 5, 3) = fb(i, 5, 3) + c3d4*tempb1
    fb(i, 6, 3) = fb(i, 6, 3) + c3d5*tempb1
    fb(i, 7, 3) = fb(i, 7, 3) + c3d6*tempb1
    fb(i, 8, 3) = fb(i, 8, 3) + c3d7*tempb1
    fb(i, 9, 3) = fb(i, 9, 3) + c3d8*tempb1
    fb(i, 10, 3) = fb(i, 10, 3) + c3d9*tempb1
    fb(i, 11, 3) = fb(i, 11, 3) + c3d10*tempb1
    tempb1 = nx(i, j, 2)*fxrou2b
    tempb0 = ny(i, j, 2)*fxrou2b
    gb(i, 1, 2) = gb(i, 1, 2) + c3d0*tempb0
    gb(i, 2, 2) = gb(i, 2, 2) + c3d1*tempb0
    gb(i, 3, 2) = gb(i, 3, 2) + c3d2*tempb0
    gb(i, 4, 2) = gb(i, 4, 2) + c3d3*tempb0
    gb(i, 5, 2) = gb(i, 5, 2) + c3d4*tempb0
    gb(i, 6, 2) = gb(i, 6, 2) + c3d5*tempb0
    gb(i, 7, 2) = gb(i, 7, 2) + c3d6*tempb0
    gb(i, 8, 2) = gb(i, 8, 2) + c3d7*tempb0
    gb(i, 9, 2) = gb(i, 9, 2) + c3d8*tempb0
    gb(i, 10, 2) = gb(i, 10, 2) + c3d9*tempb0
    gb(i, 11, 2) = gb(i, 11, 2) + c3d10*tempb0
    fb(i, 1, 2) = fb(i, 1, 2) + c3d0*tempb1
    fb(i, 2, 2) = fb(i, 2, 2) + c3d1*tempb1
    fb(i, 3, 2) = fb(i, 3, 2) + c3d2*tempb1
    fb(i, 4, 2) = fb(i, 4, 2) + c3d3*tempb1
    fb(i, 5, 2) = fb(i, 5, 2) + c3d4*tempb1
    fb(i, 6, 2) = fb(i, 6, 2) + c3d5*tempb1
    fb(i, 7, 2) = fb(i, 7, 2) + c3d6*tempb1
    fb(i, 8, 2) = fb(i, 8, 2) + c3d7*tempb1
    fb(i, 9, 2) = fb(i, 9, 2) + c3d8*tempb1
    fb(i, 10, 2) = fb(i, 10, 2) + c3d9*tempb1
    fb(i, 11, 2) = fb(i, 11, 2) + c3d10*tempb1
    tempb1 = nx(i, j, 2)*fxro2b
    tempb0 = ny(i, j, 2)*fxro2b
    gb(i, 1, 1) = gb(i, 1, 1) + c3d0*tempb0
    gb(i, 2, 1) = gb(i, 2, 1) + c3d1*tempb0
    gb(i, 3, 1) = gb(i, 3, 1) + c3d2*tempb0
    gb(i, 4, 1) = gb(i, 4, 1) + c3d3*tempb0
    gb(i, 5, 1) = gb(i, 5, 1) + c3d4*tempb0
    gb(i, 6, 1) = gb(i, 6, 1) + c3d5*tempb0
    gb(i, 7, 1) = gb(i, 7, 1) + c3d6*tempb0
    gb(i, 8, 1) = gb(i, 8, 1) + c3d7*tempb0
    gb(i, 9, 1) = gb(i, 9, 1) + c3d8*tempb0
    gb(i, 10, 1) = gb(i, 10, 1) + c3d9*tempb0
    gb(i, 11, 1) = gb(i, 11, 1) + c3d10*tempb0
    fb(i, 1, 1) = fb(i, 1, 1) + c3d0*tempb1
    fb(i, 2, 1) = fb(i, 2, 1) + c3d1*tempb1
    fb(i, 3, 1) = fb(i, 3, 1) + c3d2*tempb1
    fb(i, 4, 1) = fb(i, 4, 1) + c3d3*tempb1
    fb(i, 5, 1) = fb(i, 5, 1) + c3d4*tempb1
    fb(i, 6, 1) = fb(i, 6, 1) + c3d5*tempb1
    fb(i, 7, 1) = fb(i, 7, 1) + c3d6*tempb1
    fb(i, 8, 1) = fb(i, 8, 1) + c3d7*tempb1
    fb(i, 9, 1) = fb(i, 9, 1) + c3d8*tempb1
    fb(i, 10, 1) = fb(i, 10, 1) + c3d9*tempb1
    fb(i, 11, 1) = fb(i, 11, 1) + c3d10*tempb1
    tempb1 = nx(i, j, 1)*fxroe1b
    tempb0 = ny(i, j, 1)*fxroe1b
    gb(i, j, 5) = gb(i, j, 5) + c1*tempb0
    gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb0
    gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb0
    gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb0
    gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb0
    gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb0
    gb(i+3, j, 5) = gb(i+3, j, 5) + c4*tempb0
    gb(i-4, j, 5) = gb(i-4, j, 5) + c4*tempb0
    gb(i+4, j, 5) = gb(i+4, j, 5) + c5*tempb0
    gb(i-5, j, 5) = gb(i-5, j, 5) + c5*tempb0
    fb(i, j, 5) = fb(i, j, 5) + c1*tempb1
    fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb1
    fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb1
    fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb1
    fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb1
    fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb1
    fb(i+3, j, 5) = fb(i+3, j, 5) + c4*tempb1
    fb(i-4, j, 5) = fb(i-4, j, 5) + c4*tempb1
    fb(i+4, j, 5) = fb(i+4, j, 5) + c5*tempb1
    fb(i-5, j, 5) = fb(i-5, j, 5) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrow1b
    tempb0 = ny(i, j, 1)*fxrow1b
    gb(i, j, 4) = gb(i, j, 4) + c1*tempb0
    gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb0
    gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb0
    gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb0
    gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb0
    gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb0
    gb(i+3, j, 4) = gb(i+3, j, 4) + c4*tempb0
    gb(i-4, j, 4) = gb(i-4, j, 4) + c4*tempb0
    gb(i+4, j, 4) = gb(i+4, j, 4) + c5*tempb0
    gb(i-5, j, 4) = gb(i-5, j, 4) + c5*tempb0
    fb(i, j, 4) = fb(i, j, 4) + c1*tempb1
    fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb1
    fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb1
    fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb1
    fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb1
    fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb1
    fb(i+3, j, 4) = fb(i+3, j, 4) + c4*tempb1
    fb(i-4, j, 4) = fb(i-4, j, 4) + c4*tempb1
    fb(i+4, j, 4) = fb(i+4, j, 4) + c5*tempb1
    fb(i-5, j, 4) = fb(i-5, j, 4) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrov1b
    tempb0 = ny(i, j, 1)*fxrov1b
    gb(i, j, 3) = gb(i, j, 3) + c1*tempb0
    gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb0
    gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb0
    gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb0
    gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb0
    gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb0
    gb(i+3, j, 3) = gb(i+3, j, 3) + c4*tempb0
    gb(i-4, j, 3) = gb(i-4, j, 3) + c4*tempb0
    gb(i+4, j, 3) = gb(i+4, j, 3) + c5*tempb0
    gb(i-5, j, 3) = gb(i-5, j, 3) + c5*tempb0
    fb(i, j, 3) = fb(i, j, 3) + c1*tempb1
    fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb1
    fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb1
    fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb1
    fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb1
    fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb1
    fb(i+3, j, 3) = fb(i+3, j, 3) + c4*tempb1
    fb(i-4, j, 3) = fb(i-4, j, 3) + c4*tempb1
    fb(i+4, j, 3) = fb(i+4, j, 3) + c5*tempb1
    fb(i-5, j, 3) = fb(i-5, j, 3) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrou1b
    tempb0 = ny(i, j, 1)*fxrou1b
    gb(i, j, 2) = gb(i, j, 2) + c1*tempb0
    gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb0
    gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb0
    gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb0
    gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb0
    gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb0
    gb(i+3, j, 2) = gb(i+3, j, 2) + c4*tempb0
    gb(i-4, j, 2) = gb(i-4, j, 2) + c4*tempb0
    gb(i+4, j, 2) = gb(i+4, j, 2) + c5*tempb0
    gb(i-5, j, 2) = gb(i-5, j, 2) + c5*tempb0
    fb(i, j, 2) = fb(i, j, 2) + c1*tempb1
    fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb1
    fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb1
    fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb1
    fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb1
    fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb1
    fb(i+3, j, 2) = fb(i+3, j, 2) + c4*tempb1
    fb(i-4, j, 2) = fb(i-4, j, 2) + c4*tempb1
    fb(i+4, j, 2) = fb(i+4, j, 2) + c5*tempb1
    fb(i-5, j, 2) = fb(i-5, j, 2) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxro1b
    tempb0 = ny(i, j, 1)*fxro1b
    gb(i, j, 1) = gb(i, j, 1) + c1*tempb0
    gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb0
    gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb0
    gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb0
    gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb0
    gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb0
    gb(i+3, j, 1) = gb(i+3, j, 1) + c4*tempb0
    gb(i-4, j, 1) = gb(i-4, j, 1) + c4*tempb0
    gb(i+4, j, 1) = gb(i+4, j, 1) + c5*tempb0
    gb(i-5, j, 1) = gb(i-5, j, 1) + c5*tempb0
    fb(i, j, 1) = fb(i, j, 1) + c1*tempb1
    fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb1
    fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb1
    fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb1
    fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb1
    fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb1
    fb(i+3, j, 1) = fb(i+3, j, 1) + c4*tempb1
    fb(i-4, j, 1) = fb(i-4, j, 1) + c4*tempb1
    fb(i+4, j, 1) = fb(i+4, j, 1) + c5*tempb1
    fb(i-5, j, 1) = fb(i-5, j, 1) + c5*tempb1
  END DO
  omrr = ad_save295
  ducros1 = ad_save296
  vy = ad_save297
  vort2 = ad_save298
  vx = ad_save299
  sq = ad_save300
  vv = ad_save301
  sn = ad_save302
  vr = ad_save303
  predrow2 = ad_save304
  predrow1 = ad_save305
  vl = ad_save306
  nxloc = ad_save307
  nyloc = ad_save308
  dxm2 = ad_save309
  uy = ad_save310
  predro2 = ad_save311
  dxm1 = ad_save312
  rr = ad_save313
  ux = ad_save314
  predro1 = ad_save315
  mmu = ad_save316
  uu = ad_save317
  lambda = ad_save318
  ur = ad_save319
  eps4 = ad_save320
  eps2 = ad_save321
  predrov2 = ad_save322
  predrov1 = ad_save323
  ul = ad_save324
  mach2 = ad_save325
  rhomr = ad_save326
  rspec = ad_save327
  v = ad_save328
  alpha = ad_save329
  ty = ad_save330
  u = ad_save331
  tx = ad_save332
  rhoml = ad_save333
  r = ad_save334
  predroe2 = ad_save335
  wy = ad_save336
  predroe1 = ad_save337
  wx = ad_save338
  ww = ad_save339
  predrou2 = ad_save340
  predrou1 = ad_save341
  j = 3
!$BWD-OF II-LOOP 
!DIR$ IVDEP
  DO i=1,im+1
    predro1 = -(d5*w(i-5, j, 1)) + d4*w(i-4, j, 1) - d3*w(i-3, j, 1) + &
&     d2*w(i-2, j, 1) - d1*w(i-1, j, 1) + d1*w(i, j, 1) - d2*w(i+1, j, 1&
&     ) + d3*w(i+2, j, 1) - d4*w(i+3, j, 1) + d5*w(i+4, j, 1)
    predrou1 = -(d5*w(i-5, j, 2)) + d4*w(i-4, j, 2) - d3*w(i-3, j, 2) + &
&     d2*w(i-2, j, 2) - d1*w(i-1, j, 2) + d1*w(i, j, 2) - d2*w(i+1, j, 2&
&     ) + d3*w(i+2, j, 2) - d4*w(i+3, j, 2) + d5*w(i+4, j, 2)
    predrov1 = -(d5*w(i-5, j, 3)) + d4*w(i-4, j, 3) - d3*w(i-3, j, 3) + &
&     d2*w(i-2, j, 3) - d1*w(i-1, j, 3) + d1*w(i, j, 3) - d2*w(i+1, j, 3&
&     ) + d3*w(i+2, j, 3) - d4*w(i+3, j, 3) + d5*w(i+4, j, 3)
    predrow1 = -(d5*w(i-5, j, 4)) + d4*w(i-4, j, 4) - d3*w(i-3, j, 4) + &
&     d2*w(i-2, j, 4) - d1*w(i-1, j, 4) + d1*w(i, j, 4) - d2*w(i+1, j, 4&
&     ) + d3*w(i+2, j, 4) - d4*w(i+3, j, 4) + d5*w(i+4, j, 4)
    predroe1 = -(d5*w(i-5, j, 5)) + d4*w(i-4, j, 5) - d3*w(i-3, j, 5) + &
&     d2*w(i-2, j, 5) - d1*w(i-1, j, 5) + d1*w(i, j, 5) - d2*w(i+1, j, 5&
&     ) + d3*w(i+2, j, 5) - d4*w(i+3, j, 5) + d5*w(i+4, j, 5)
    predro2 = -(d5*w(i, j-5, 1)) + d4*w(i, j-4, 1) - d3*w(i, j-3, 1) + &
&     d2*w(i, j-2, 1) - d1*w(i, j-1, 1) + d1*w(i, j, 1) - d2*w(i, j+1, 1&
&     ) + d3*w(i, j+2, 1) - d4*w(i, j+3, 1) + d5*w(i, j+4, 1)
    predrou2 = -(d5*w(i, j-5, 2)) + d4*w(i, j-4, 2) - d3*w(i, j-3, 2) + &
&     d2*w(i, j-2, 2) - d1*w(i, j-1, 2) + d1*w(i, j, 2) - d2*w(i, j+1, 2&
&     ) + d3*w(i, j+2, 2) - d4*w(i, j+3, 2) + d5*w(i, j+4, 2)
    predrov2 = -(d5*w(i, j-5, 3)) + d4*w(i, j-4, 3) - d3*w(i, j-3, 3) + &
&     d2*w(i, j-2, 3) - d1*w(i, j-1, 3) + d1*w(i, j, 3) - d2*w(i, j+1, 3&
&     ) + d3*w(i, j+2, 3) - d4*w(i, j+3, 3) + d5*w(i, j+4, 3)
    predrow2 = -(d5*w(i, j-5, 4)) + d4*w(i, j-4, 4) - d3*w(i, j-3, 4) + &
&     d2*w(i, j-2, 4) - d1*w(i, j-1, 4) + d1*w(i, j, 4) - d2*w(i, j+1, 4&
&     ) + d3*w(i, j+2, 4) - d4*w(i, j+3, 4) + d5*w(i, j+4, 4)
    predroe2 = -(d5*w(i, j-5, 5)) + d4*w(i, j-4, 5) - d3*w(i, j-3, 5) + &
&     d2*w(i, j-2, 5) - d1*w(i, j-1, 5) + d1*w(i, j, 5) - d2*w(i, j+1, 5&
&     ) + d3*w(i, j+2, 5) - d4*w(i, j+3, 5) + d5*w(i, j+4, 5)
! grad for viscous fluxes o4 - 5p
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccros = TWELFTH*0.0625d0
    volm1 = volf(i, j, 1)
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    val_n = twentyfourth*(-velx(i+1, j)+26.d0*velx(i, j)-velx(i-1, j))
    val_s = twentyfourth*(-velx(i, j)+26.d0*velx(i-1, j)-velx(i-2, j))
    val_e = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-1, j-2)+9.d0*velx(i, j&
&     -2)-velx(i+1, j-2))+7.d0*(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0&
&     *velx(i, j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j&
&     )+9.d0*velx(i, j)-velx(i+1, j))-(-velx(i-2, j+1)+9.d0*velx(i-1, j+&
&     1)+9.d0*velx(i, j+1)-velx(i+1, j+1)))
    val_o = ccross*(-(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0*velx(i, j&
&     -1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*&
&     velx(i, j)-velx(i+1, j))+7.d0*(-velx(i-2, j+1)+9.d0*velx(i-1, j+1)&
&     +9.d0*velx(i, j+1)-velx(i+1, j+1))-(-velx(i-2, j+2)+9.d0*velx(i-1&
&     , j+2)+9.d0*velx(i, j+2)-velx(i+1, j+2)))
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-vely(i+1, j)+26.d0*vely(i, j)-vely(i-1, j))
    val_s = twentyfourth*(-vely(i, j)+26.d0*vely(i-1, j)-vely(i-2, j))
    val_e = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-1, j-2)+9.d0*vely(i, j&
&     -2)-vely(i+1, j-2))+7.d0*(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0&
&     *vely(i, j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j&
&     )+9.d0*vely(i, j)-vely(i+1, j))-(-vely(i-2, j+1)+9.d0*vely(i-1, j+&
&     1)+9.d0*vely(i, j+1)-vely(i+1, j+1)))
    val_o = ccross*(-(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0*vely(i, j&
&     -1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*&
&     vely(i, j)-vely(i+1, j))+7.d0*(-vely(i-2, j+1)+9.d0*vely(i-1, j+1)&
&     +9.d0*vely(i, j+1)-vely(i+1, j+1))-(-vely(i-2, j+2)+9.d0*vely(i-1&
&     , j+2)+9.d0*vely(i, j+2)-vely(i+1, j+2)))
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-velz(i+1, j)+26.d0*velz(i, j)-velz(i-1, j))
    val_s = twentyfourth*(-velz(i, j)+26.d0*velz(i-1, j)-velz(i-2, j))
    val_e = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-1, j-2)+9.d0*velz(i, j&
&     -2)-velz(i+1, j-2))+7.d0*(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0&
&     *velz(i, j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j&
&     )+9.d0*velz(i, j)-velz(i+1, j))-(-velz(i-2, j+1)+9.d0*velz(i-1, j+&
&     1)+9.d0*velz(i, j+1)-velz(i+1, j+1)))
    val_o = ccross*(-(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0*velz(i, j&
&     -1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*&
&     velz(i, j)-velz(i+1, j))+7.d0*(-velz(i-2, j+1)+9.d0*velz(i-1, j+1)&
&     +9.d0*velz(i, j+1)-velz(i+1, j+1))-(-velz(i-2, j+2)+9.d0*velz(i-1&
&     , j+2)+9.d0*velz(i, j+2)-velz(i+1, j+2)))
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-tloc(i+1, j)+26.d0*tloc(i, j)-tloc(i-1, j))
    val_s = twentyfourth*(-tloc(i, j)+26.d0*tloc(i-1, j)-tloc(i-2, j))
    val_e = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-1, j-2)+9.d0*tloc(i, j&
&     -2)-tloc(i+1, j-2))+7.d0*(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0&
&     *tloc(i, j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j&
&     )+9.d0*tloc(i, j)-tloc(i+1, j))-(-tloc(i-2, j+1)+9.d0*tloc(i-1, j+&
&     1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1)))
    val_o = ccross*(-(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i, j&
&     -1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j)+9.d0*&
&     tloc(i, j)-tloc(i+1, j))+7.d0*(-tloc(i-2, j+1)+9.d0*tloc(i-1, j+1)&
&     +9.d0*tloc(i, j+1)-tloc(i+1, j+1))-(-tloc(i-2, j+2)+9.d0*tloc(i-1&
&     , j+2)+9.d0*tloc(i, j+2)-tloc(i+1, j+2)))
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
    uu = 0.0625d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*velx(i, j)-velx(&
&     i+1, j))
    vv = 0.0625d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*vely(i, j)-vely(&
&     i+1, j))
    ww = 0.0625d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*velz(i, j)-velz(&
&     i+1, j))
!
    mmu = 0.0625d0*(-mu(i-2, j)+9.d0*mu(i-1, j)+9.d0*mu(i, j)-mu(i+1, j)&
&     )
    lambda = mmu*cpprandtl
!
    fvrou1 = twothird*mmu*(two*ux-vy)
    fvrov1 = mmu*(uy+vx)
    fvrow1 = mmu*wx
! fvroe1 = (lambda*tx + uu*fvrou1 + vv*fvrov1)
!
    gvrou1 = mmu*(uy+vx)
    gvrov1 = twothird*mmu*(-ux+two*vy)
    gvrow1 = mmu*wy
! gvroe1 = (lambda*ty + uu*gvrou1 + vv*gvrov1)
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! grad for viscous fluxes o4 - 5p
!
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccross = TWELFTH*0.0625d0
    volm1 = volf(i, j, 2)
    nx_n = half*(nx(i+1, j-1, 1)+nx(i+1, j, 1))
    nx_s = -(half*(nx(i, j-1, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i, j+1, 2)+nx(i, j, 2))
    nx_e = -(half*(nx(i, j-1, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j-1, 1)+ny(i+1, j, 1))
    ny_s = -(half*(ny(i, j-1, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i, j+1, 2)+ny(i, j, 2))
    ny_e = -(half*(ny(i, j-1, 2)+ny(i, j, 2)))
    val_n = ccross*(-(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+9.d0*velx(i-1&
&     , j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*&
&     velx(i, j)-velx(i, j+1))+7.d0*(-velx(i+1, j-2)+9.d0*velx(i+1, j-1)&
&     +9.d0*velx(i+1, j)-velx(i+1, j+1))-(-velx(i+2, j-2)+9.d0*velx(i+2&
&     , j-1)+9.d0*velx(i+2, j)-velx(i+2, j+1)))
    val_s = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-2, j-1)+9.d0*velx(i-2&
&     , j)-velx(i-2, j+1))+7.d0*(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+&
&     9.d0*velx(i-1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i&
&     , j-1)+9.d0*velx(i, j)-velx(i, j+1))-(-velx(i+1, j-2)+9.d0*velx(i+&
&     1, j-1)+9.d0*velx(i+1, j)-velx(i+1, j+1)))
    val_e = twentyfourth*(-velx(i, j)+26.d0*velx(i, j-1)-velx(i, j-2))
    val_o = twentyfourth*(-velx(i, j+1)+26.d0*velx(i, j)-velx(i, j-1))
    ad_save189 = ux
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save190 = uy
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+9.d0*vely(i-1&
&     , j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*&
&     vely(i, j)-vely(i, j+1))+7.d0*(-vely(i+1, j-2)+9.d0*vely(i+1, j-1)&
&     +9.d0*vely(i+1, j)-vely(i+1, j+1))-(-vely(i+2, j-2)+9.d0*vely(i+2&
&     , j-1)+9.d0*vely(i+2, j)-vely(i+2, j+1)))
    val_s = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-2, j-1)+9.d0*vely(i-2&
&     , j)-vely(i-2, j+1))+7.d0*(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+&
&     9.d0*vely(i-1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i&
&     , j-1)+9.d0*vely(i, j)-vely(i, j+1))-(-vely(i+1, j-2)+9.d0*vely(i+&
&     1, j-1)+9.d0*vely(i+1, j)-vely(i+1, j+1)))
    val_e = twentyfourth*(-vely(i, j)+26.d0*vely(i, j-1)-vely(i, j-2))
    val_o = twentyfourth*(-vely(i, j+1)+26.d0*vely(i, j)-vely(i, j-1))
    ad_save191 = vx
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save192 = vy
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+9.d0*velz(i-1&
&     , j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*&
&     velz(i, j)-velz(i, j+1))+7.d0*(-velz(i+1, j-2)+9.d0*velz(i+1, j-1)&
&     +9.d0*velz(i+1, j)-velz(i+1, j+1))-(-velz(i+2, j-2)+9.d0*velz(i+2&
&     , j-1)+9.d0*velz(i+2, j)-velz(i+2, j+1)))
    val_s = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-2, j-1)+9.d0*velz(i-2&
&     , j)-velz(i-2, j+1))+7.d0*(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+&
&     9.d0*velz(i-1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i&
&     , j-1)+9.d0*velz(i, j)-velz(i, j+1))-(-velz(i+1, j-2)+9.d0*velz(i+&
&     1, j-1)+9.d0*velz(i+1, j)-velz(i+1, j+1)))
    val_e = twentyfourth*(-velz(i, j)+26.d0*velz(i, j-1)-velz(i, j-2))
    val_o = twentyfourth*(-velz(i, j+1)+26.d0*velz(i, j)-velz(i, j-1))
    ad_save193 = wx
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save194 = wy
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i-1&
&     , j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i, j-1)+9.d0*&
&     tloc(i, j)-tloc(i, j+1))+7.d0*(-tloc(i+1, j-2)+9.d0*tloc(i+1, j-1)&
&     +9.d0*tloc(i+1, j)-tloc(i+1, j+1))-(-tloc(i+2, j-2)+9.d0*tloc(i+2&
&     , j-1)+9.d0*tloc(i+2, j)-tloc(i+2, j+1)))
    val_s = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-2, j-1)+9.d0*tloc(i-2&
&     , j)-tloc(i-2, j+1))+7.d0*(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+&
&     9.d0*tloc(i-1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i&
&     , j-1)+9.d0*tloc(i, j)-tloc(i, j+1))-(-tloc(i+1, j-2)+9.d0*tloc(i+&
&     1, j-1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1)))
    val_e = twentyfourth*(-tloc(i, j)+26.d0*tloc(i, j-1)-tloc(i, j-2))
    val_o = twentyfourth*(-tloc(i, j+1)+26.d0*tloc(i, j)-tloc(i, j-1))
    ad_save195 = tx
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save196 = ty
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    ad_save197 = uu
    uu = 0.0625d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*velx(i, j)-velx(&
&     i, j+1))
    ad_save198 = vv
    vv = 0.0625d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*vely(i, j)-vely(&
&     i, j+1))
    ad_save199 = ww
    ww = 0.0625d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*velz(i, j)-velz(&
&     i, j+1))
!
    ad_save200 = mmu
    mmu = 0.0625d0*(-mu(i, j-2)+9.d0*mu(i, j-1)+9.d0*mu(i, j)-mu(i, j+1)&
&     )
    ad_save201 = lambda
    lambda = mmu*cpprandtl
!
    fvrou2 = twothird*mmu*(two*ux-vy)
    fvrov2 = mmu*(uy+vx)
    fvrow2 = mmu*wx
! fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2)
    gvrou2 = mmu*(uy+vx)
    gvrov2 = twothird*mmu*(-ux+two*vy)
    gvrow2 = mmu*wy
! gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2)
!!  fvrou2 = TWOTHIRD*mmu*( TWO*ux -     vy  -  wz  )
!!  fvrov2 =          mmu*(     uy +     vx         )
!!  fvrow2 =          mmu*(     uz           +  wx  )
!!  fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2 + ww * fvrow2)
!!
!!  gvrou2 =          mmu*(     uy +     vx       )
!!  gvrov2 = TWOTHIRD*mmu*(    -ux + TWO*vy -  wz )
!!  gvrow2 =          mmu*(              vz +  wy )
!!  gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2 + ww*gvrow2)
! #include "rhs/spectralradius_i.F"
! correction Rossow JCP 2000
!1st direction
    rhomr = w(i, j, 1)
    ur = w(i, j, 2)/rhomr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i-1, j, 1)
    ul = w(i-1, j, 2)/rhoml
    vl = w(i-1, j, 3)/rhoml
    c2l = gam*rgaz*tloc(i-1, j)
!
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    u = ul*rr + ur*omrr
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_branch47 = 0
      mach2 = one
    ELSE
      mach2 = vn2/c2x
      ad_branch47 = 1
    END IF
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    x7 = nx(i, j, 1)*u + ny(i, j, 1)*v
    IF (x7 .GE. 0.) THEN
      ab = x7
      ad_branch48 = 0
    ELSE
      ab = -x7
      ad_branch48 = 1
    END IF
    sq = SQRT(cprim*nx2)
!
    rspec = ab + sq
    IF (p(i-1, j) - two*p(i, j) + p(i+1, j) .GE. 0.) THEN
      abs12 = p(i-1, j) - two*p(i, j) + p(i+1, j)
      ad_branch49 = 1
    ELSE
      abs12 = -(p(i-1, j)-two*p(i, j)+p(i+1, j))
      ad_branch49 = 0
    END IF
    x24 = p(i-1, j) + two*p(i, j) + p(i+1, j)
    IF (x24 .GE. 0.) THEN
      abs34 = x24
      ad_branch50 = 0
    ELSE
      abs34 = -x24
      ad_branch50 = 1
    END IF
!
!1st direction
    k_sensor1 = abs12/abs34
    IF (p(i-2, j) - two*p(i-1, j) + p(i, j) .GE. 0.) THEN
      abs13 = p(i-2, j) - two*p(i-1, j) + p(i, j)
      ad_branch51 = 1
    ELSE
      abs13 = -(p(i-2, j)-two*p(i-1, j)+p(i, j))
      ad_branch51 = 0
    END IF
    x25 = p(i-2, j) + two*p(i-1, j) + p(i, j)
    IF (x25 .GE. 0.) THEN
      abs35 = x25
      ad_branch52 = 0
    ELSE
      abs35 = -x25
      ad_branch52 = 1
    END IF
    k_sensor2 = abs13/abs35
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    divu2 = divu*divu
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    ducros1 = divu2/(divu2+vort2+1d-15)
    dxm1 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    ad_save202 = divu2
    divu2 = divu*divu
    vort2 = (gradv(i-1, j, 1)-gradu(i-1, j, 2))*(gradv(i-1, j, 1)-gradu(&
&     i-1, j, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch53 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch53 = 1
    END IF
!     ! extension of shock capturing
!
!    k_sensor1 = ABS(p(i,j) - TWO*p(i+1,j) + p(i+2,j)) / &
!                ABS(p(i,j) + TWO*p(i+1,j) + p(i+2,j))
!
!    k_sensor2 = ABS(p(i-3,j) - TWO*p(i-2,j) + p(i-1,j)) / &
!                ABS(p(i-3,j) + TWO*p(i-2,j) + p(i-1,j))
!
!    divu2     = (gradu(i+1,j,1)+gradv(i+1,j,2)) * (gradu(i+1,j,1)+gradv(i+1,j,2))
!    vort2     = (gradv(i+1,j,1)-gradu(i+1,j,2)) * (gradv(i+1,j,1)-gradu(i+1,j,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i-2,j,1)+gradv(i-2,j,2)) * (gradu(i-2,j,1)+gradv(i-2,j,2))
!    vort2     = (gradv(i-2,j,1)-gradu(i-2,j,2)) * (gradv(i-2,j,1)-gradu(i-2,j,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                      k_sensor2*ducros2, coef)
!
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      eps4 = k4 - 12.d0*eps2
      ad_branch54 = 0
    ELSE
      ad_branch54 = 1
      eps4 = zero
    END IF
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_diri.F"
!     endif
! #include "rhs/spectralradius_j.F"
! correction Rossow JCP 2000
!2st direction
    rhomr = w(i, j, 1)
    ad_save203 = ur
    ur = w(i, j, 2)/rhomr
    ad_save204 = vr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i, j-1, 1)
    ul = w(i, j-1, 2)/rhoml
    vl = w(i, j-1, 3)/rhoml
    c2l = gam*rgaz*tloc(i, j-1)
!
    ad_save205 = r
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    ad_save206 = u
    u = ul*rr + ur*omrr
    ad_save207 = v
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    nx2 = nx(i, j, 2)*nx(i, j, 2) + ny(i, j, 2)*ny(i, j, 2)
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_save208 = mach2
      mach2 = one
      ad_branch55 = 0
    ELSE
      ad_save209 = mach2
      mach2 = vn2/c2x
      ad_branch55 = 1
    END IF
    ad_save210 = alpha
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    x8 = nx(i, j, 2)*u + ny(i, j, 2)*v
    IF (x8 .GE. 0.) THEN
      ab = x8
      ad_branch56 = 0
    ELSE
      ab = -x8
      ad_branch56 = 1
    END IF
    ad_save211 = sq
    sq = SQRT(cprim*nx2)
!
    ad_save212 = rspec
    rspec = ab + sq
    IF (p(i, j-1) - two*p(i, j) + p(i, j+1) .GE. 0.) THEN
      abs14 = p(i, j-1) - two*p(i, j) + p(i, j+1)
      ad_branch57 = 1
    ELSE
      abs14 = -(p(i, j-1)-two*p(i, j)+p(i, j+1))
      ad_branch57 = 0
    END IF
    x26 = p(i, j-1) + two*p(i, j) + p(i, j+1)
    IF (x26 .GE. 0.) THEN
      abs36 = x26
      ad_branch58 = 0
    ELSE
      abs36 = -x26
      ad_branch58 = 1
    END IF
!
! 2nd direction
    k_sensor1 = abs14/abs36
    IF (p(i, j-2) - two*p(i, j-1) + p(i, j) .GE. 0.) THEN
      abs15 = p(i, j-2) - two*p(i, j-1) + p(i, j)
      ad_branch59 = 1
    ELSE
      abs15 = -(p(i, j-2)-two*p(i, j-1)+p(i, j))
      ad_branch59 = 0
    END IF
    x27 = p(i, j-2) + two*p(i, j-1) + p(i, j)
    IF (x27 .GE. 0.) THEN
      abs37 = x27
      ad_branch60 = 0
    ELSE
      abs37 = -x27
      ad_branch60 = 1
    END IF
    k_sensor2 = abs15/abs37
!     ducros1 is done in dissipation_ducros_x
    divu = gradu(i, j-1, 1) + gradv(i, j-1, 2)
    divu2 = divu*divu
    ad_save213 = vort2
    vort2 = (gradv(i, j-1, 1)-gradu(i, j-1, 2))*(gradv(i, j-1, 1)-gradu(&
&     i, j-1, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
!sq = sound/dx
    ad_save214 = dxm2
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch61 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch61 = 1
    END IF
! extension of shock capturing
!    k_sensor1 = ABS(p(i,j) - TWO*p(i,j+1) + p(i,j+2)) / &
!                ABS(p(i,j) + TWO*p(i,j+1) + p(i,j+2))
!
!    k_sensor2 = ABS(p(i,j-3) - TWO*p(i,j-2) + p(i,j-1)) / &
!                ABS(p(i,j-3) + TWO*p(i,j-2) + p(i,j-1))
!
!    divu2     = (gradu(i,j+1,1)+gradv(i,j+1,2)) * (gradu(i,j+1,1)+gradv(i,j+1,2))
!    vort2     = (gradv(i,j+1,1)-gradu(i,j+1,2)) * (gradv(i,j+1,1)-gradu(i,j+1,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i,j-2,1)+gradv(i,j-2,2)) * (gradu(i,j-2,1)+gradv(i,j-2,2))
!    vort2     = (gradv(i,j-2,1)-gradu(i,j-2,2)) * (gradv(i,j-2,1)-gradu(i,j-2,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                     k_sensor2*ducros2, coef)
    ad_save215 = eps2
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      ad_save216 = eps4
      eps4 = k4 - 12.d0*eps2
      ad_branch62 = 0
    ELSE
      ad_save217 = eps4
      eps4 = zero
      ad_branch62 = 1
    END IF
    diffro = half*(w(i, j, 1)-w(i, j-1, 1))
    diffrou = half*(w(i, j, 2)-w(i, j-1, 2))
    diffrov = half*(w(i, j, 3)-w(i, j-1, 3))
    diffrow = half*(w(i, j, 4)-w(i, j-1, 4))
    diffroe = half*(w(i, j, 5)-w(i, j-1, 5))
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_dirj.F"
!     endif
!
    sc1 = nx(i, j, 1)
    sc2 = ny(i, j, 1)
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    nxloc = sc1*invsn
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
    sc1 = nx(i, j, 2)
    sc2 = ny(i, j, 2)
    ad_save218 = sn
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    ad_save219 = nxloc
    nxloc = sc1*invsn
    ad_save220 = nyloc
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,2) = ZERO
!
    fxroe2b = hnb(i, j, 5, 2)
    dissroe2b = -hnb(i, j, 5, 2)
    fvroe2b = -(nxloc*sn*hnb(i, j, 5, 2))
    gvroe2b = -(nyloc*sn*hnb(i, j, 5, 2))
    hnb(i, j, 5, 2) = 0.0_8
    fxrow2b = hnb(i, j, 4, 2)
    dissrow2b = -hnb(i, j, 4, 2)
    fvrow2b = -(nxloc*sn*hnb(i, j, 4, 2))
    gvrow2b = -(nyloc*sn*hnb(i, j, 4, 2))
    hnb(i, j, 4, 2) = 0.0_8
    fxrov2b = hnb(i, j, 3, 2)
    dissrov2b = -hnb(i, j, 3, 2)
    fvrov2b = -(nxloc*sn*hnb(i, j, 3, 2))
    gvrov2b = -(nyloc*sn*hnb(i, j, 3, 2))
    hnb(i, j, 3, 2) = 0.0_8
    fxrou2b = hnb(i, j, 2, 2)
    dissrou2b = -hnb(i, j, 2, 2)
    fvrou2b = -(nxloc*sn*hnb(i, j, 2, 2))
    gvrou2b = -(nyloc*sn*hnb(i, j, 2, 2))
    hnb(i, j, 2, 2) = 0.0_8
    fxro2b = hnb(i, j, 1, 2)
    dissro2b = -hnb(i, j, 1, 2)
    hnb(i, j, 1, 2) = 0.0_8
    nyloc = ad_save220
    nxloc = ad_save219
    sn = ad_save218
    fxroe1b = hnb(i, j, 5, 1)
    dissroe1b = -hnb(i, j, 5, 1)
    fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
    gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
    hnb(i, j, 5, 1) = 0.0_8
    fxrow1b = hnb(i, j, 4, 1)
    dissrow1b = -hnb(i, j, 4, 1)
    fvrow1b = -(nxloc*sn*hnb(i, j, 4, 1))
    gvrow1b = -(nyloc*sn*hnb(i, j, 4, 1))
    hnb(i, j, 4, 1) = 0.0_8
    fxrov1b = hnb(i, j, 3, 1)
    dissrov1b = -hnb(i, j, 3, 1)
    fvrov1b = -(nxloc*sn*hnb(i, j, 3, 1))
    gvrov1b = -(nyloc*sn*hnb(i, j, 3, 1))
    hnb(i, j, 3, 1) = 0.0_8
    fxrou1b = hnb(i, j, 2, 1)
    dissrou1b = -hnb(i, j, 2, 1)
    fvrou1b = -(nxloc*sn*hnb(i, j, 2, 1))
    gvrou1b = -(nyloc*sn*hnb(i, j, 2, 1))
    hnb(i, j, 2, 1) = 0.0_8
    fxro1b = hnb(i, j, 1, 1)
    dissro1b = -hnb(i, j, 1, 1)
    hnb(i, j, 1, 1) = 0.0_8
    rspecb = (eps2*diffroe+eps4*predroe2)*dissroe2b + (eps2*diffrow+eps4&
&     *predrow2)*dissrow2b + (eps2*diffrov+eps4*predrov2)*dissrov2b + (&
&     eps2*diffrou+eps4*predrou2)*dissrou2b + (eps2*diffro+eps4*predro2)&
&     *dissro2b
    tempb1 = rspec*dissroe2b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe2*tempb1
    predroe2b = eps4*tempb1
    tempb1 = rspec*dissrow2b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow2*tempb1
    predrow2b = eps4*tempb1
    tempb1 = rspec*dissrov2b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    eps4b = eps4b + predrov2*tempb1
    predrov2b = eps4*tempb1
    tempb1 = rspec*dissrou2b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    eps4b = eps4b + predrou2*tempb1
    predrou2b = eps4*tempb1
    tempb1 = rspec*dissro2b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    eps4b = eps4b + predro2*tempb1
    predro2b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i, j-1, 5) = wb(i, j-1, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i, j-1, 4) = wb(i, j-1, 4) - half*diffrowb
    wb(i, j, 3) = wb(i, j, 3) + half*diffrovb
    wb(i, j-1, 3) = wb(i, j-1, 3) - half*diffrovb
    wb(i, j, 2) = wb(i, j, 2) + half*diffroub
    wb(i, j-1, 2) = wb(i, j-1, 2) - half*diffroub
    wb(i, j, 1) = wb(i, j, 1) + half*diffrob
    wb(i, j-1, 1) = wb(i, j-1, 1) - half*diffrob
    IF (ad_branch62 .EQ. 0) THEN
      eps4 = ad_save216
      eps2b = eps2b - 12.d0*eps4b
    ELSE
      eps4 = ad_save217
    END IF
    eps2 = ad_save215
    coefb = k2*eps2b
    IF (ad_branch61 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      dxm1b = 0.0_8
      k_sensor1b = 0.0_8
      ducros1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = k_sensor1*dxm1*coefb
      dxm1b = k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    dxm2 = ad_save214
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    vort2 = ad_save213
    tempb1 = 2*(gradv(i, j-1, 1)-gradu(i, j-1, 2))*vort2b
    gradvb(i, j-1, 1) = gradvb(i, j-1, 1) + tempb1
    gradub(i, j-1, 2) = gradub(i, j-1, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j-1, 1) = gradub(i, j-1, 1) + divub
    gradvb(i, j-1, 2) = gradvb(i, j-1, 2) + divub
    abs15b = k_sensor2b/abs37
    abs37b = -(abs15*k_sensor2b/abs37**2)
    IF (ad_branch60 .EQ. 0) THEN
      x27b = abs37b
    ELSE
      x27b = -abs37b
    END IF
    pb(i, j-2) = pb(i, j-2) + x27b
    pb(i, j-1) = pb(i, j-1) + two*x27b
    pb(i, j) = pb(i, j) + x27b
    IF (ad_branch59 .EQ. 0) THEN
      pb(i, j-1) = pb(i, j-1) + two*abs15b
      pb(i, j-2) = pb(i, j-2) - abs15b
      pb(i, j) = pb(i, j) - abs15b
    ELSE
      pb(i, j-2) = pb(i, j-2) + abs15b
      pb(i, j-1) = pb(i, j-1) - two*abs15b
      pb(i, j) = pb(i, j) + abs15b
    END IF
    abs14b = k_sensor1b/abs36
    abs36b = -(abs14*k_sensor1b/abs36**2)
    IF (ad_branch58 .EQ. 0) THEN
      x26b = abs36b
    ELSE
      x26b = -abs36b
    END IF
    pb(i, j-1) = pb(i, j-1) + x26b
    pb(i, j) = pb(i, j) + two*x26b
    pb(i, j+1) = pb(i, j+1) + x26b
    IF (ad_branch57 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs14b
      pb(i, j-1) = pb(i, j-1) - abs14b
      pb(i, j+1) = pb(i, j+1) - abs14b
    ELSE
      pb(i, j-1) = pb(i, j-1) + abs14b
      pb(i, j) = pb(i, j) - two*abs14b
      pb(i, j+1) = pb(i, j+1) + abs14b
    END IF
    rspec = ad_save212
    abb = rspecb
    sqb = sqb + rspecb
    sq = ad_save211
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch56 .EQ. 0) THEN
      x8b = abb
    ELSE
      x8b = -abb
    END IF
    ub = nx(i, j, 2)*x8b
    vb = ny(i, j, 2)*x8b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    alpha = ad_save210
    IF (ad_branch55 .EQ. 0) THEN
      mach2 = ad_save208
    ELSE
      mach2 = ad_save209
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    diffro = half*(w(i, j, 1)-w(i-1, j, 1))
    diffrou = half*(w(i, j, 2)-w(i-1, j, 2))
    diffrov = half*(w(i, j, 3)-w(i-1, j, 3))
    diffrow = half*(w(i, j, 4)-w(i-1, j, 4))
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    v = ad_save207
    vlb = rr*vb
    vrb = omrr*vb
    u = ad_save206
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    r = ad_save205
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i, j-1, 3)*vlb/rhoml**2 - w(i, j-&
&     1, 2)*ulb/rhoml**2
    tlocb(i, j-1) = tlocb(i, j-1) + gam*rgaz*c2lb
    wb(i, j-1, 3) = wb(i, j-1, 3) + vlb/rhoml
    wb(i, j-1, 2) = wb(i, j-1, 2) + ulb/rhoml
    wb(i, j-1, 1) = wb(i, j-1, 1) + rhomlb
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb
    rhoml = w(i-1, j, 1)
    rr = one/(one+r)
    vl = w(i-1, j, 3)/rhoml
    omrr = one - rr
    vr = ad_save204
    ul = w(i-1, j, 2)/rhoml
    ur = ad_save203
    diffroe = half*(w(i, j, 5)-w(i-1, j, 5))
    rspecb = (eps2*diffroe+eps4*predroe1)*dissroe1b + (eps2*diffrow+eps4&
&     *predrow1)*dissrow1b + (eps2*diffrov+eps4*predrov1)*dissrov1b + (&
&     eps2*diffrou+eps4*predrou1)*dissrou1b + (eps2*diffro+eps4*predro1)&
&     *dissro1b
    tempb1 = rspec*dissroe1b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe1*tempb1
    predroe1b = eps4*tempb1
    tempb1 = rspec*dissrow1b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow1*tempb1
    predrow1b = eps4*tempb1
    tempb1 = rspec*dissrov1b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + half*diffrovb
    eps4b = eps4b + predrov1*tempb1
    predrov1b = eps4*tempb1
    tempb1 = rspec*dissrou1b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + half*diffroub
    rhomr = w(i, j, 1)
    eps4b = eps4b + predrou1*tempb1
    predrou1b = eps4*tempb1
    tempb1 = rspec*dissro1b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + half*diffrob
    eps4b = eps4b + predro1*tempb1
    predro1b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i-1, j, 5) = wb(i-1, j, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i-1, j, 4) = wb(i-1, j, 4) - half*diffrowb
    wb(i-1, j, 3) = wb(i-1, j, 3) - half*diffrovb
    wb(i-1, j, 2) = wb(i-1, j, 2) - half*diffroub
    wb(i-1, j, 1) = wb(i-1, j, 1) - half*diffrob
    IF (ad_branch54 .EQ. 0) eps2b = eps2b - 12.d0*eps4b
    coefb = k2*eps2b
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    divu2 = divu*divu
    k_sensor1 = abs12/abs34
    k_sensor2 = abs13/abs35
    ducros2 = divu2/(divu2+vort2+1d-15)
    IF (ad_branch53 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      k_sensor1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = ducros1b + k_sensor1*dxm1*coefb
      dxm1b = dxm1b + k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i-1, j, 1)-gradu(i-1, j, 2))*vort2b
    gradvb(i-1, j, 1) = gradvb(i-1, j, 1) + tempb1
    gradub(i-1, j, 2) = gradub(i-1, j, 2) - tempb1
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    divu2 = ad_save202
    divub = divub + 2*divu*divu2b
    gradub(i-1, j, 1) = gradub(i-1, j, 1) + divub
    gradvb(i-1, j, 2) = gradvb(i-1, j, 2) + divub
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm1b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = sqb - temp1*tempb1
    tempb1 = ducros1b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i, j, 1)-gradu(i, j, 2))*vort2b
    gradvb(i, j, 1) = gradvb(i, j, 1) + tempb1
    gradub(i, j, 2) = gradub(i, j, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j, 1) = gradub(i, j, 1) + divub
    gradvb(i, j, 2) = gradvb(i, j, 2) + divub
    abs13b = k_sensor2b/abs35
    abs35b = -(abs13*k_sensor2b/abs35**2)
    IF (ad_branch52 .EQ. 0) THEN
      x25b = abs35b
    ELSE
      x25b = -abs35b
    END IF
    pb(i-2, j) = pb(i-2, j) + x25b
    pb(i-1, j) = pb(i-1, j) + two*x25b
    pb(i, j) = pb(i, j) + x25b
    IF (ad_branch51 .EQ. 0) THEN
      pb(i-1, j) = pb(i-1, j) + two*abs13b
      pb(i-2, j) = pb(i-2, j) - abs13b
      pb(i, j) = pb(i, j) - abs13b
    ELSE
      pb(i-2, j) = pb(i-2, j) + abs13b
      pb(i-1, j) = pb(i-1, j) - two*abs13b
      pb(i, j) = pb(i, j) + abs13b
    END IF
    abs12b = k_sensor1b/abs34
    abs34b = -(abs12*k_sensor1b/abs34**2)
    IF (ad_branch50 .EQ. 0) THEN
      x24b = abs34b
    ELSE
      x24b = -abs34b
    END IF
    pb(i-1, j) = pb(i-1, j) + x24b
    pb(i, j) = pb(i, j) + two*x24b
    pb(i+1, j) = pb(i+1, j) + x24b
    IF (ad_branch49 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs12b
      pb(i-1, j) = pb(i-1, j) - abs12b
      pb(i+1, j) = pb(i+1, j) - abs12b
    ELSE
      pb(i-1, j) = pb(i-1, j) + abs12b
      pb(i, j) = pb(i, j) - two*abs12b
      pb(i+1, j) = pb(i+1, j) + abs12b
    END IF
    abb = rspecb
    sqb = sqb + rspecb
    c2r = gam*rgaz*tloc(i, j)
    c2l = gam*rgaz*tloc(i-1, j)
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    cprim = alpha*alpha*vn2 + mach2*c2x
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch48 .EQ. 0) THEN
      x7b = abb
    ELSE
      x7b = -abb
    END IF
    ub = nx(i, j, 1)*x7b
    vb = ny(i, j, 1)*x7b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    IF (ad_branch47 .NE. 0) THEN
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    fvrov2b = fvrov2b + vv*fvroe2b
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    vlb = rr*vb
    vrb = omrr*vb
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i-1, j, 3)*vlb/rhoml**2 - w(i-1, &
&     j, 2)*ulb/rhoml**2
    wb(i-1, j, 3) = wb(i-1, j, 3) + vlb/rhoml - d1*predrov1b
    wb(i-1, j, 2) = wb(i-1, j, 2) + ulb/rhoml - d1*predrou1b
    wb(i-1, j, 1) = wb(i-1, j, 1) + rhomlb - d1*predro1b
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + d1*predrov2b + d1*predrov1b
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + d1*predrou2b + d1*predrou1b
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + d1*predro2b + d1*predro1b
    lambdab = ty*gvroe2b + tx*fvroe2b
    tyb = lambda*gvroe2b
    uub = gvrou2*gvroe2b + fvrou2*fvroe2b
    gvrou2b = gvrou2b + uu*gvroe2b
    vvb = gvrov2*gvroe2b + fvrov2*fvroe2b
    gvrov2b = gvrov2b + vv*gvroe2b
    wwb = gvrow2*gvroe2b + fvrow2*fvroe2b
    gvrow2b = gvrow2b + ww*gvroe2b
    wyb = mmu*gvrow2b
    tempb1 = twothird*gvrov2b
    mmub = wy*gvrow2b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    uyb = mmu*gvrou2b + mmu*fvrov2b
    vxb = mmu*gvrou2b + mmu*fvrov2b
    txb = lambda*fvroe2b
    fvrou2b = fvrou2b + uu*fvroe2b
    fvrow2b = fvrow2b + ww*fvroe2b
    wxb = mmu*fvrow2b
    tempb1 = twothird*fvrou2b
    mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (two*&
&     ux-vy)*tempb1 + cpprandtl*lambdab
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    lambda = ad_save201
    mmu = ad_save200
    tempb1 = 0.0625d0*mmub
    mub(i, j-1) = mub(i, j-1) + 9.d0*tempb1
    mub(i, j-2) = mub(i, j-2) - tempb1
    mub(i, j) = mub(i, j) + 9.d0*tempb1
    mub(i, j+1) = mub(i, j+1) - tempb1
    ww = ad_save199
    tempb1 = 0.0625d0*wwb
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb1
    velzb(i, j-2) = velzb(i, j-2) - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb1
    velzb(i, j+1) = velzb(i, j+1) - tempb1
    vv = ad_save198
    tempb1 = 0.0625d0*vvb
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb1
    velyb(i, j-2) = velyb(i, j-2) - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb1
    velyb(i, j+1) = velyb(i, j+1) - tempb1
    uu = ad_save197
    tempb1 = 0.0625d0*uub
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb1
    velxb(i, j-2) = velxb(i, j-2) - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb1
    velxb(i, j+1) = velxb(i, j+1) - tempb1
    ty = ad_save196
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tx = ad_save195
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb + 26.d0*tempb1
    tlocb(i, j+1) = tlocb(i, j+1) - tempb1
    tlocb(i, j-1) = tlocb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    tlocb(i, j-1) = tlocb(i, j-1) + 26.d0*tempb1
    tlocb(i, j) = tlocb(i, j) - tempb1
    tlocb(i, j-2) = tlocb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
    tlocb(i-2, j-1) = tlocb(i-2, j-1) - 9.d0*tempb1
    tlocb(i-2, j) = tlocb(i-2, j) - 9.d0*tempb1
    tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) - 9.d0*tempb1
    tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1
    tlocb(i+1, j) = tlocb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    tlocb(i-1, j) = tlocb(i-1, j) + gam*rgaz*c2lb + 9.d0*tempb0 - 9.d0*&
&     tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    tlocb(i-1, j-2) = tlocb(i-1, j-2) + tempb1 - tempb0
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    tlocb(i, j-2) = tlocb(i, j-2) - tempb - tempb0
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb + 9.d0*tempb0
    tlocb(i, j+1) = tlocb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    tlocb(i+2, j-2) = tlocb(i+2, j-2) + tempb1
    tlocb(i+2, j-1) = tlocb(i+2, j-1) - 9.d0*tempb1
    tlocb(i+2, j+1) = tlocb(i+2, j+1) + tempb1
    tlocb(i+2, j) = tlocb(i+2, j) - 9.d0*tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + 9.d0*tempb
    tlocb(i+1, j-2) = tlocb(i+1, j-2) - tempb
    tlocb(i+1, j) = tlocb(i+1, j) + 9.d0*tempb
    tlocb(i+1, j+1) = tlocb(i+1, j+1) - tempb
    wy = ad_save194
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    wx = ad_save193
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velzb(i, j) = velzb(i, j) + 26.d0*tempb1
    velzb(i, j+1) = velzb(i, j+1) - tempb1
    velzb(i, j-1) = velzb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velzb(i, j-1) = velzb(i, j-1) + 26.d0*tempb1
    velzb(i, j) = velzb(i, j) - tempb1
    velzb(i, j-2) = velzb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
    velzb(i-2, j-1) = velzb(i-2, j-1) - 9.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - 9.d0*tempb1
    velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) - 9.d0*tempb1
    velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1
    velzb(i+1, j) = velzb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velzb(i-1, j-2) = velzb(i-1, j-2) + tempb1 - tempb0
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velzb(i, j-2) = velzb(i, j-2) - tempb - tempb0
    velzb(i, j) = velzb(i, j) + 9.d0*tempb + 9.d0*tempb0
    velzb(i, j+1) = velzb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velzb(i+2, j-2) = velzb(i+2, j-2) + tempb1
    velzb(i+2, j-1) = velzb(i+2, j-1) - 9.d0*tempb1
    velzb(i+2, j+1) = velzb(i+2, j+1) + tempb1
    velzb(i+2, j) = velzb(i+2, j) - 9.d0*tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + 9.d0*tempb
    velzb(i+1, j-2) = velzb(i+1, j-2) - tempb
    velzb(i+1, j) = velzb(i+1, j) + 9.d0*tempb
    velzb(i+1, j+1) = velzb(i+1, j+1) - tempb
    vy = ad_save192
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    vx = ad_save191
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velyb(i, j) = velyb(i, j) + 26.d0*tempb1
    velyb(i, j+1) = velyb(i, j+1) - tempb1
    velyb(i, j-1) = velyb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velyb(i, j-1) = velyb(i, j-1) + 26.d0*tempb1
    velyb(i, j) = velyb(i, j) - tempb1
    velyb(i, j-2) = velyb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
    velyb(i-2, j-1) = velyb(i-2, j-1) - 9.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - 9.d0*tempb1
    velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) - 9.d0*tempb1
    velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1
    velyb(i+1, j) = velyb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velyb(i-1, j-2) = velyb(i-1, j-2) + tempb1 - tempb0
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velyb(i, j-2) = velyb(i, j-2) - tempb - tempb0
    velyb(i, j) = velyb(i, j) + 9.d0*tempb + 9.d0*tempb0
    velyb(i, j+1) = velyb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velyb(i+2, j-2) = velyb(i+2, j-2) + tempb1
    velyb(i+2, j-1) = velyb(i+2, j-1) - 9.d0*tempb1
    velyb(i+2, j+1) = velyb(i+2, j+1) + tempb1
    velyb(i+2, j) = velyb(i+2, j) - 9.d0*tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + 9.d0*tempb
    velyb(i+1, j-2) = velyb(i+1, j-2) - tempb
    velyb(i+1, j) = velyb(i+1, j) + 9.d0*tempb
    velyb(i+1, j+1) = velyb(i+1, j+1) - tempb
    uy = ad_save190
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    ux = ad_save189
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velxb(i, j) = velxb(i, j) + 26.d0*tempb1
    velxb(i, j+1) = velxb(i, j+1) - tempb1
    velxb(i, j-1) = velxb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velxb(i, j-1) = velxb(i, j-1) + 26.d0*tempb1
    velxb(i, j) = velxb(i, j) - tempb1
    velxb(i, j-2) = velxb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
    velxb(i-2, j-1) = velxb(i-2, j-1) - 9.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - 9.d0*tempb1
    velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) - 9.d0*tempb1
    velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1
    velxb(i+1, j) = velxb(i+1, j) - 9.d0*tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb
    tempb1 = ccross*val_nb
    velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velxb(i-1, j-2) = velxb(i-1, j-2) + tempb1 - tempb0
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velxb(i, j-2) = velxb(i, j-2) - tempb - tempb0
    velxb(i, j+1) = velxb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velxb(i+2, j-2) = velxb(i+2, j-2) + tempb1
    velxb(i+2, j-1) = velxb(i+2, j-1) - 9.d0*tempb1
    velxb(i+2, j+1) = velxb(i+2, j+1) + tempb1
    velxb(i+2, j) = velxb(i+2, j) - 9.d0*tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + 9.d0*tempb
    velxb(i+1, j-2) = velxb(i+1, j-2) - tempb
    velxb(i+1, j+1) = velxb(i+1, j+1) - tempb
    lambdab = ty*gvroe1b + tx*fvroe1b
    tyb = lambda*gvroe1b
    uub = gvrou1*gvroe1b + fvrou1*fvroe1b
    gvrou1b = gvrou1b + uu*gvroe1b
    vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
    gvrov1b = gvrov1b + vv*gvroe1b
    wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
    gvrow1b = gvrow1b + ww*gvroe1b
    wyb = mmu*gvrow1b
    tempb1 = twothird*gvrov1b
    mmub = wy*gvrow1b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    txb = lambda*fvroe1b
    fvrou1b = fvrou1b + uu*fvroe1b
    fvrov1b = fvrov1b + vv*fvroe1b
    uyb = mmu*gvrou1b + mmu*fvrov1b
    vxb = mmu*gvrou1b + mmu*fvrov1b
    fvrow1b = fvrow1b + ww*fvroe1b
    wxb = mmu*fvrow1b
    tempb1 = twothird*fvrou1b
    mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (two*&
&     ux-vy)*tempb1 + cpprandtl*lambdab
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    tempb1 = 0.0625d0*mmub
    mub(i-1, j) = mub(i-1, j) + 9.d0*tempb1
    mub(i-2, j) = mub(i-2, j) - tempb1
    mub(i, j) = mub(i, j) + 9.d0*tempb1
    mub(i+1, j) = mub(i+1, j) - tempb1
    tempb1 = 0.0625d0*wwb
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb1
    velzb(i+1, j) = velzb(i+1, j) - tempb1
    tempb1 = 0.0625d0*vvb
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb1
    velyb(i+1, j) = velyb(i+1, j) - tempb1
    tempb1 = 0.0625d0*uub
    velxb(i+1, j) = velxb(i+1, j) + 9.d0*tempb - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb0 + 9.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - tempb1
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    volm1 = volf(i, j, 1)
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    tlocb(i-2, j-1) = tlocb(i-2, j-1) + tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) - 9.d0*tempb1
    tlocb(i, j-1) = tlocb(i, j-1) - 9.d0*tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i-2, j+2) = tlocb(i-2, j+2) + tempb1
    tlocb(i-1, j+2) = tlocb(i-1, j+2) - 9.d0*tempb1
    tlocb(i+1, j+2) = tlocb(i+1, j+2) + tempb1
    tlocb(i, j+2) = tlocb(i, j+2) - 9.d0*tempb1
    tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb0
    tlocb(i-2, j) = tlocb(i-2, j) - tempb0
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb0
    tlocb(i+1, j) = tlocb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1 - tempb
    tlocb(i, j+1) = tlocb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1 - tempb
    tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
    tlocb(i-1, j-2) = tlocb(i-1, j-2) - 9.d0*tempb1
    tlocb(i, j-2) = tlocb(i, j-2) - 9.d0*tempb1
    tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0
    tlocb(i-2, j-1) = tlocb(i-2, j-1) - tempb0
    tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb0
    tlocb(i+1, j-1) = tlocb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    tlocb(i-2, j) = tlocb(i-2, j) - tempb - tempb1
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    tlocb(i+1, j) = tlocb(i+1, j) - tempb - tempb1
    tlocb(i, j) = tlocb(i, j) + 26.d0*tempb1
    tlocb(i-1, j) = tlocb(i-1, j) - tempb1
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velzb(i-2, j-1) = velzb(i-2, j-1) + tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) - 9.d0*tempb1
    velzb(i, j-1) = velzb(i, j-1) - 9.d0*tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i-2, j+2) = velzb(i-2, j+2) + tempb1
    velzb(i-1, j+2) = velzb(i-1, j+2) - 9.d0*tempb1
    velzb(i+1, j+2) = velzb(i+1, j+2) + tempb1
    velzb(i, j+2) = velzb(i, j+2) - 9.d0*tempb1
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0
    velzb(i-2, j) = velzb(i-2, j) - tempb0
    velzb(i, j) = velzb(i, j) + 9.d0*tempb0
    velzb(i+1, j) = velzb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velzb(i-1, j+1) = velzb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1 - tempb
    velzb(i, j+1) = velzb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1 - tempb
    velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
    velzb(i-1, j-2) = velzb(i-1, j-2) - 9.d0*tempb1
    velzb(i, j-2) = velzb(i, j-2) - 9.d0*tempb1
    velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0
    velzb(i-2, j-1) = velzb(i-2, j-1) - tempb0
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb0
    velzb(i+1, j-1) = velzb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - tempb - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velzb(i+1, j) = velzb(i+1, j) - tempb - tempb1
    velzb(i, j) = velzb(i, j) + 26.d0*tempb1
    velzb(i-1, j) = velzb(i-1, j) - tempb1
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velyb(i-2, j-1) = velyb(i-2, j-1) + tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) - 9.d0*tempb1
    velyb(i, j-1) = velyb(i, j-1) - 9.d0*tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i-2, j+2) = velyb(i-2, j+2) + tempb1
    velyb(i-1, j+2) = velyb(i-1, j+2) - 9.d0*tempb1
    velyb(i+1, j+2) = velyb(i+1, j+2) + tempb1
    velyb(i, j+2) = velyb(i, j+2) - 9.d0*tempb1
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0
    velyb(i-2, j) = velyb(i-2, j) - tempb0
    velyb(i, j) = velyb(i, j) + 9.d0*tempb0
    velyb(i+1, j) = velyb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velyb(i-1, j+1) = velyb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1 - tempb
    velyb(i, j+1) = velyb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1 - tempb
    velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
    velyb(i-1, j-2) = velyb(i-1, j-2) - 9.d0*tempb1
    velyb(i, j-2) = velyb(i, j-2) - 9.d0*tempb1
    velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0
    velyb(i-2, j-1) = velyb(i-2, j-1) - tempb0
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb0
    velyb(i+1, j-1) = velyb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - tempb - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velyb(i+1, j) = velyb(i+1, j) - tempb - tempb1
    velyb(i, j) = velyb(i, j) + 26.d0*tempb1
    velyb(i-1, j) = velyb(i-1, j) - tempb1
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velxb(i-2, j-1) = velxb(i-2, j-1) + tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) - 9.d0*tempb1
    velxb(i, j-1) = velxb(i, j-1) - 9.d0*tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i-2, j+2) = velxb(i-2, j+2) + tempb1
    velxb(i-1, j+2) = velxb(i-1, j+2) - 9.d0*tempb1
    velxb(i+1, j+2) = velxb(i+1, j+2) + tempb1
    velxb(i, j+2) = velxb(i, j+2) - 9.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0
    velxb(i-2, j) = velxb(i-2, j) - tempb0
    velxb(i, j) = velxb(i, j) + 9.d0*tempb0
    velxb(i+1, j) = velxb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velxb(i-1, j+1) = velxb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1 - tempb
    velxb(i, j+1) = velxb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1 - tempb
    velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
    velxb(i-1, j-2) = velxb(i-1, j-2) - 9.d0*tempb1
    velxb(i, j-2) = velxb(i, j-2) - 9.d0*tempb1
    velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0
    velxb(i-2, j-1) = velxb(i-2, j-1) - tempb0
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb0
    velxb(i+1, j-1) = velxb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - tempb - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velxb(i+1, j) = velxb(i+1, j) - tempb - tempb1
    velxb(i, j) = velxb(i, j) + 26.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) - tempb1
    wb(i, j-4, 5) = wb(i, j-4, 5) + d4*predroe2b
    wb(i, j-5, 5) = wb(i, j-5, 5) - d5*predroe2b
    wb(i, j-3, 5) = wb(i, j-3, 5) - d3*predroe2b
    wb(i, j-2, 5) = wb(i, j-2, 5) + d2*predroe2b
    wb(i, j-1, 5) = wb(i, j-1, 5) - d1*predroe2b
    wb(i, j, 5) = wb(i, j, 5) + d1*predroe2b + d1*predroe1b
    wb(i, j+1, 5) = wb(i, j+1, 5) - d2*predroe2b
    wb(i, j+2, 5) = wb(i, j+2, 5) + d3*predroe2b
    wb(i, j+4, 5) = wb(i, j+4, 5) + d5*predroe2b
    wb(i, j+3, 5) = wb(i, j+3, 5) - d4*predroe2b
    wb(i, j-4, 4) = wb(i, j-4, 4) + d4*predrow2b
    wb(i, j-5, 4) = wb(i, j-5, 4) - d5*predrow2b
    wb(i, j-3, 4) = wb(i, j-3, 4) - d3*predrow2b
    wb(i, j-2, 4) = wb(i, j-2, 4) + d2*predrow2b
    wb(i, j-1, 4) = wb(i, j-1, 4) - d1*predrow2b
    wb(i, j, 4) = wb(i, j, 4) + d1*predrow2b + d1*predrow1b
    wb(i, j+1, 4) = wb(i, j+1, 4) - d2*predrow2b
    wb(i, j+2, 4) = wb(i, j+2, 4) + d3*predrow2b
    wb(i, j+4, 4) = wb(i, j+4, 4) + d5*predrow2b
    wb(i, j+3, 4) = wb(i, j+3, 4) - d4*predrow2b
    wb(i, j-4, 3) = wb(i, j-4, 3) + d4*predrov2b
    wb(i, j-5, 3) = wb(i, j-5, 3) - d5*predrov2b
    wb(i, j-3, 3) = wb(i, j-3, 3) - d3*predrov2b
    wb(i, j-2, 3) = wb(i, j-2, 3) + d2*predrov2b
    wb(i, j-1, 3) = wb(i, j-1, 3) - d1*predrov2b
    wb(i, j+1, 3) = wb(i, j+1, 3) - d2*predrov2b
    wb(i, j+2, 3) = wb(i, j+2, 3) + d3*predrov2b
    wb(i, j+4, 3) = wb(i, j+4, 3) + d5*predrov2b
    wb(i, j+3, 3) = wb(i, j+3, 3) - d4*predrov2b
    wb(i, j-4, 2) = wb(i, j-4, 2) + d4*predrou2b
    wb(i, j-5, 2) = wb(i, j-5, 2) - d5*predrou2b
    wb(i, j-3, 2) = wb(i, j-3, 2) - d3*predrou2b
    wb(i, j-2, 2) = wb(i, j-2, 2) + d2*predrou2b
    wb(i, j-1, 2) = wb(i, j-1, 2) - d1*predrou2b
    wb(i, j+1, 2) = wb(i, j+1, 2) - d2*predrou2b
    wb(i, j+2, 2) = wb(i, j+2, 2) + d3*predrou2b
    wb(i, j+4, 2) = wb(i, j+4, 2) + d5*predrou2b
    wb(i, j+3, 2) = wb(i, j+3, 2) - d4*predrou2b
    wb(i, j-4, 1) = wb(i, j-4, 1) + d4*predro2b
    wb(i, j-5, 1) = wb(i, j-5, 1) - d5*predro2b
    wb(i, j-3, 1) = wb(i, j-3, 1) - d3*predro2b
    wb(i, j-2, 1) = wb(i, j-2, 1) + d2*predro2b
    wb(i, j-1, 1) = wb(i, j-1, 1) - d1*predro2b
    wb(i, j+1, 1) = wb(i, j+1, 1) - d2*predro2b
    wb(i, j+2, 1) = wb(i, j+2, 1) + d3*predro2b
    wb(i, j+4, 1) = wb(i, j+4, 1) + d5*predro2b
    wb(i, j+3, 1) = wb(i, j+3, 1) - d4*predro2b
    wb(i-4, j, 5) = wb(i-4, j, 5) + d4*predroe1b
    wb(i-5, j, 5) = wb(i-5, j, 5) - d5*predroe1b
    wb(i-3, j, 5) = wb(i-3, j, 5) - d3*predroe1b
    wb(i-2, j, 5) = wb(i-2, j, 5) + d2*predroe1b
    wb(i-1, j, 5) = wb(i-1, j, 5) - d1*predroe1b
    wb(i+1, j, 5) = wb(i+1, j, 5) - d2*predroe1b
    wb(i+2, j, 5) = wb(i+2, j, 5) + d3*predroe1b
    wb(i+4, j, 5) = wb(i+4, j, 5) + d5*predroe1b
    wb(i+3, j, 5) = wb(i+3, j, 5) - d4*predroe1b
    wb(i-4, j, 4) = wb(i-4, j, 4) + d4*predrow1b
    wb(i-5, j, 4) = wb(i-5, j, 4) - d5*predrow1b
    wb(i-3, j, 4) = wb(i-3, j, 4) - d3*predrow1b
    wb(i-2, j, 4) = wb(i-2, j, 4) + d2*predrow1b
    wb(i-1, j, 4) = wb(i-1, j, 4) - d1*predrow1b
    wb(i+1, j, 4) = wb(i+1, j, 4) - d2*predrow1b
    wb(i+2, j, 4) = wb(i+2, j, 4) + d3*predrow1b
    wb(i+4, j, 4) = wb(i+4, j, 4) + d5*predrow1b
    wb(i+3, j, 4) = wb(i+3, j, 4) - d4*predrow1b
    wb(i-4, j, 3) = wb(i-4, j, 3) + d4*predrov1b
    wb(i-5, j, 3) = wb(i-5, j, 3) - d5*predrov1b
    wb(i-3, j, 3) = wb(i-3, j, 3) - d3*predrov1b
    wb(i-2, j, 3) = wb(i-2, j, 3) + d2*predrov1b
    wb(i+1, j, 3) = wb(i+1, j, 3) - d2*predrov1b
    wb(i+2, j, 3) = wb(i+2, j, 3) + d3*predrov1b
    wb(i+4, j, 3) = wb(i+4, j, 3) + d5*predrov1b
    wb(i+3, j, 3) = wb(i+3, j, 3) - d4*predrov1b
    wb(i-4, j, 2) = wb(i-4, j, 2) + d4*predrou1b
    wb(i-5, j, 2) = wb(i-5, j, 2) - d5*predrou1b
    wb(i-3, j, 2) = wb(i-3, j, 2) - d3*predrou1b
    wb(i-2, j, 2) = wb(i-2, j, 2) + d2*predrou1b
    wb(i+1, j, 2) = wb(i+1, j, 2) - d2*predrou1b
    wb(i+2, j, 2) = wb(i+2, j, 2) + d3*predrou1b
    wb(i+4, j, 2) = wb(i+4, j, 2) + d5*predrou1b
    wb(i+3, j, 2) = wb(i+3, j, 2) - d4*predrou1b
    wb(i-4, j, 1) = wb(i-4, j, 1) + d4*predro1b
    wb(i-5, j, 1) = wb(i-5, j, 1) - d5*predro1b
    wb(i-3, j, 1) = wb(i-3, j, 1) - d3*predro1b
    wb(i-2, j, 1) = wb(i-2, j, 1) + d2*predro1b
    wb(i+1, j, 1) = wb(i+1, j, 1) - d2*predro1b
    wb(i+2, j, 1) = wb(i+2, j, 1) + d3*predro1b
    wb(i+4, j, 1) = wb(i+4, j, 1) + d5*predro1b
    wb(i+3, j, 1) = wb(i+3, j, 1) - d4*predro1b
    tempb1 = nx(i, j, 2)*fxroe2b
    tempb0 = ny(i, j, 2)*fxroe2b
    gb(i, 1, 5) = gb(i, 1, 5) + c5d0*tempb0
    gb(i, 2, 5) = gb(i, 2, 5) + c5d1*tempb0
    gb(i, 3, 5) = gb(i, 3, 5) + c5d2*tempb0
    gb(i, 4, 5) = gb(i, 4, 5) + c5d3*tempb0
    gb(i, 5, 5) = gb(i, 5, 5) + c5d4*tempb0
    gb(i, 6, 5) = gb(i, 6, 5) + c5d5*tempb0
    gb(i, 7, 5) = gb(i, 7, 5) + c5d6*tempb0
    gb(i, 8, 5) = gb(i, 8, 5) + c5d7*tempb0
    gb(i, 9, 5) = gb(i, 9, 5) + c5d8*tempb0
    gb(i, 10, 5) = gb(i, 10, 5) + c5d9*tempb0
    gb(i, 11, 5) = gb(i, 11, 5) + c5d10*tempb0
    fb(i, 1, 5) = fb(i, 1, 5) + c5d0*tempb1
    fb(i, 2, 5) = fb(i, 2, 5) + c5d1*tempb1
    fb(i, 3, 5) = fb(i, 3, 5) + c5d2*tempb1
    fb(i, 4, 5) = fb(i, 4, 5) + c5d3*tempb1
    fb(i, 5, 5) = fb(i, 5, 5) + c5d4*tempb1
    fb(i, 6, 5) = fb(i, 6, 5) + c5d5*tempb1
    fb(i, 7, 5) = fb(i, 7, 5) + c5d6*tempb1
    fb(i, 8, 5) = fb(i, 8, 5) + c5d7*tempb1
    fb(i, 9, 5) = fb(i, 9, 5) + c5d8*tempb1
    fb(i, 10, 5) = fb(i, 10, 5) + c5d9*tempb1
    fb(i, 11, 5) = fb(i, 11, 5) + c5d10*tempb1
    tempb1 = nx(i, j, 2)*fxrow2b
    tempb0 = ny(i, j, 2)*fxrow2b
    gb(i, 1, 4) = gb(i, 1, 4) + c5d0*tempb0
    gb(i, 2, 4) = gb(i, 2, 4) + c5d1*tempb0
    gb(i, 3, 4) = gb(i, 3, 4) + c5d2*tempb0
    gb(i, 4, 4) = gb(i, 4, 4) + c5d3*tempb0
    gb(i, 5, 4) = gb(i, 5, 4) + c5d4*tempb0
    gb(i, 6, 4) = gb(i, 6, 4) + c5d5*tempb0
    gb(i, 7, 4) = gb(i, 7, 4) + c5d6*tempb0
    gb(i, 8, 4) = gb(i, 8, 4) + c5d7*tempb0
    gb(i, 9, 4) = gb(i, 9, 4) + c5d8*tempb0
    gb(i, 10, 4) = gb(i, 10, 4) + c5d9*tempb0
    gb(i, 11, 4) = gb(i, 11, 4) + c5d10*tempb0
    fb(i, 1, 4) = fb(i, 1, 4) + c5d0*tempb1
    fb(i, 2, 4) = fb(i, 2, 4) + c5d1*tempb1
    fb(i, 3, 4) = fb(i, 3, 4) + c5d2*tempb1
    fb(i, 4, 4) = fb(i, 4, 4) + c5d3*tempb1
    fb(i, 5, 4) = fb(i, 5, 4) + c5d4*tempb1
    fb(i, 6, 4) = fb(i, 6, 4) + c5d5*tempb1
    fb(i, 7, 4) = fb(i, 7, 4) + c5d6*tempb1
    fb(i, 8, 4) = fb(i, 8, 4) + c5d7*tempb1
    fb(i, 9, 4) = fb(i, 9, 4) + c5d8*tempb1
    fb(i, 10, 4) = fb(i, 10, 4) + c5d9*tempb1
    fb(i, 11, 4) = fb(i, 11, 4) + c5d10*tempb1
    tempb1 = nx(i, j, 2)*fxrov2b
    tempb0 = ny(i, j, 2)*fxrov2b
    gb(i, 1, 3) = gb(i, 1, 3) + c5d0*tempb0
    gb(i, 2, 3) = gb(i, 2, 3) + c5d1*tempb0
    gb(i, 3, 3) = gb(i, 3, 3) + c5d2*tempb0
    gb(i, 4, 3) = gb(i, 4, 3) + c5d3*tempb0
    gb(i, 5, 3) = gb(i, 5, 3) + c5d4*tempb0
    gb(i, 6, 3) = gb(i, 6, 3) + c5d5*tempb0
    gb(i, 7, 3) = gb(i, 7, 3) + c5d6*tempb0
    gb(i, 8, 3) = gb(i, 8, 3) + c5d7*tempb0
    gb(i, 9, 3) = gb(i, 9, 3) + c5d8*tempb0
    gb(i, 10, 3) = gb(i, 10, 3) + c5d9*tempb0
    gb(i, 11, 3) = gb(i, 11, 3) + c5d10*tempb0
    fb(i, 1, 3) = fb(i, 1, 3) + c5d0*tempb1
    fb(i, 2, 3) = fb(i, 2, 3) + c5d1*tempb1
    fb(i, 3, 3) = fb(i, 3, 3) + c5d2*tempb1
    fb(i, 4, 3) = fb(i, 4, 3) + c5d3*tempb1
    fb(i, 5, 3) = fb(i, 5, 3) + c5d4*tempb1
    fb(i, 6, 3) = fb(i, 6, 3) + c5d5*tempb1
    fb(i, 7, 3) = fb(i, 7, 3) + c5d6*tempb1
    fb(i, 8, 3) = fb(i, 8, 3) + c5d7*tempb1
    fb(i, 9, 3) = fb(i, 9, 3) + c5d8*tempb1
    fb(i, 10, 3) = fb(i, 10, 3) + c5d9*tempb1
    fb(i, 11, 3) = fb(i, 11, 3) + c5d10*tempb1
    tempb1 = nx(i, j, 2)*fxrou2b
    tempb0 = ny(i, j, 2)*fxrou2b
    gb(i, 1, 2) = gb(i, 1, 2) + c5d0*tempb0
    gb(i, 2, 2) = gb(i, 2, 2) + c5d1*tempb0
    gb(i, 3, 2) = gb(i, 3, 2) + c5d2*tempb0
    gb(i, 4, 2) = gb(i, 4, 2) + c5d3*tempb0
    gb(i, 5, 2) = gb(i, 5, 2) + c5d4*tempb0
    gb(i, 6, 2) = gb(i, 6, 2) + c5d5*tempb0
    gb(i, 7, 2) = gb(i, 7, 2) + c5d6*tempb0
    gb(i, 8, 2) = gb(i, 8, 2) + c5d7*tempb0
    gb(i, 9, 2) = gb(i, 9, 2) + c5d8*tempb0
    gb(i, 10, 2) = gb(i, 10, 2) + c5d9*tempb0
    gb(i, 11, 2) = gb(i, 11, 2) + c5d10*tempb0
    fb(i, 1, 2) = fb(i, 1, 2) + c5d0*tempb1
    fb(i, 2, 2) = fb(i, 2, 2) + c5d1*tempb1
    fb(i, 3, 2) = fb(i, 3, 2) + c5d2*tempb1
    fb(i, 4, 2) = fb(i, 4, 2) + c5d3*tempb1
    fb(i, 5, 2) = fb(i, 5, 2) + c5d4*tempb1
    fb(i, 6, 2) = fb(i, 6, 2) + c5d5*tempb1
    fb(i, 7, 2) = fb(i, 7, 2) + c5d6*tempb1
    fb(i, 8, 2) = fb(i, 8, 2) + c5d7*tempb1
    fb(i, 9, 2) = fb(i, 9, 2) + c5d8*tempb1
    fb(i, 10, 2) = fb(i, 10, 2) + c5d9*tempb1
    fb(i, 11, 2) = fb(i, 11, 2) + c5d10*tempb1
    tempb1 = nx(i, j, 2)*fxro2b
    tempb0 = ny(i, j, 2)*fxro2b
    gb(i, 1, 1) = gb(i, 1, 1) + c5d0*tempb0
    gb(i, 2, 1) = gb(i, 2, 1) + c5d1*tempb0
    gb(i, 3, 1) = gb(i, 3, 1) + c5d2*tempb0
    gb(i, 4, 1) = gb(i, 4, 1) + c5d3*tempb0
    gb(i, 5, 1) = gb(i, 5, 1) + c5d4*tempb0
    gb(i, 6, 1) = gb(i, 6, 1) + c5d5*tempb0
    gb(i, 7, 1) = gb(i, 7, 1) + c5d6*tempb0
    gb(i, 8, 1) = gb(i, 8, 1) + c5d7*tempb0
    gb(i, 9, 1) = gb(i, 9, 1) + c5d8*tempb0
    gb(i, 10, 1) = gb(i, 10, 1) + c5d9*tempb0
    gb(i, 11, 1) = gb(i, 11, 1) + c5d10*tempb0
    fb(i, 1, 1) = fb(i, 1, 1) + c5d0*tempb1
    fb(i, 2, 1) = fb(i, 2, 1) + c5d1*tempb1
    fb(i, 3, 1) = fb(i, 3, 1) + c5d2*tempb1
    fb(i, 4, 1) = fb(i, 4, 1) + c5d3*tempb1
    fb(i, 5, 1) = fb(i, 5, 1) + c5d4*tempb1
    fb(i, 6, 1) = fb(i, 6, 1) + c5d5*tempb1
    fb(i, 7, 1) = fb(i, 7, 1) + c5d6*tempb1
    fb(i, 8, 1) = fb(i, 8, 1) + c5d7*tempb1
    fb(i, 9, 1) = fb(i, 9, 1) + c5d8*tempb1
    fb(i, 10, 1) = fb(i, 10, 1) + c5d9*tempb1
    fb(i, 11, 1) = fb(i, 11, 1) + c5d10*tempb1
    tempb1 = nx(i, j, 1)*fxroe1b
    tempb0 = ny(i, j, 1)*fxroe1b
    gb(i, j, 5) = gb(i, j, 5) + c1*tempb0
    gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb0
    gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb0
    gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb0
    gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb0
    gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb0
    gb(i+3, j, 5) = gb(i+3, j, 5) + c4*tempb0
    gb(i-4, j, 5) = gb(i-4, j, 5) + c4*tempb0
    gb(i+4, j, 5) = gb(i+4, j, 5) + c5*tempb0
    gb(i-5, j, 5) = gb(i-5, j, 5) + c5*tempb0
    fb(i, j, 5) = fb(i, j, 5) + c1*tempb1
    fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb1
    fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb1
    fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb1
    fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb1
    fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb1
    fb(i+3, j, 5) = fb(i+3, j, 5) + c4*tempb1
    fb(i-4, j, 5) = fb(i-4, j, 5) + c4*tempb1
    fb(i+4, j, 5) = fb(i+4, j, 5) + c5*tempb1
    fb(i-5, j, 5) = fb(i-5, j, 5) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrow1b
    tempb0 = ny(i, j, 1)*fxrow1b
    gb(i, j, 4) = gb(i, j, 4) + c1*tempb0
    gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb0
    gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb0
    gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb0
    gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb0
    gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb0
    gb(i+3, j, 4) = gb(i+3, j, 4) + c4*tempb0
    gb(i-4, j, 4) = gb(i-4, j, 4) + c4*tempb0
    gb(i+4, j, 4) = gb(i+4, j, 4) + c5*tempb0
    gb(i-5, j, 4) = gb(i-5, j, 4) + c5*tempb0
    fb(i, j, 4) = fb(i, j, 4) + c1*tempb1
    fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb1
    fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb1
    fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb1
    fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb1
    fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb1
    fb(i+3, j, 4) = fb(i+3, j, 4) + c4*tempb1
    fb(i-4, j, 4) = fb(i-4, j, 4) + c4*tempb1
    fb(i+4, j, 4) = fb(i+4, j, 4) + c5*tempb1
    fb(i-5, j, 4) = fb(i-5, j, 4) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrov1b
    tempb0 = ny(i, j, 1)*fxrov1b
    gb(i, j, 3) = gb(i, j, 3) + c1*tempb0
    gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb0
    gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb0
    gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb0
    gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb0
    gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb0
    gb(i+3, j, 3) = gb(i+3, j, 3) + c4*tempb0
    gb(i-4, j, 3) = gb(i-4, j, 3) + c4*tempb0
    gb(i+4, j, 3) = gb(i+4, j, 3) + c5*tempb0
    gb(i-5, j, 3) = gb(i-5, j, 3) + c5*tempb0
    fb(i, j, 3) = fb(i, j, 3) + c1*tempb1
    fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb1
    fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb1
    fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb1
    fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb1
    fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb1
    fb(i+3, j, 3) = fb(i+3, j, 3) + c4*tempb1
    fb(i-4, j, 3) = fb(i-4, j, 3) + c4*tempb1
    fb(i+4, j, 3) = fb(i+4, j, 3) + c5*tempb1
    fb(i-5, j, 3) = fb(i-5, j, 3) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrou1b
    tempb0 = ny(i, j, 1)*fxrou1b
    gb(i, j, 2) = gb(i, j, 2) + c1*tempb0
    gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb0
    gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb0
    gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb0
    gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb0
    gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb0
    gb(i+3, j, 2) = gb(i+3, j, 2) + c4*tempb0
    gb(i-4, j, 2) = gb(i-4, j, 2) + c4*tempb0
    gb(i+4, j, 2) = gb(i+4, j, 2) + c5*tempb0
    gb(i-5, j, 2) = gb(i-5, j, 2) + c5*tempb0
    fb(i, j, 2) = fb(i, j, 2) + c1*tempb1
    fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb1
    fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb1
    fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb1
    fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb1
    fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb1
    fb(i+3, j, 2) = fb(i+3, j, 2) + c4*tempb1
    fb(i-4, j, 2) = fb(i-4, j, 2) + c4*tempb1
    fb(i+4, j, 2) = fb(i+4, j, 2) + c5*tempb1
    fb(i-5, j, 2) = fb(i-5, j, 2) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxro1b
    tempb0 = ny(i, j, 1)*fxro1b
    gb(i, j, 1) = gb(i, j, 1) + c1*tempb0
    gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb0
    gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb0
    gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb0
    gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb0
    gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb0
    gb(i+3, j, 1) = gb(i+3, j, 1) + c4*tempb0
    gb(i-4, j, 1) = gb(i-4, j, 1) + c4*tempb0
    gb(i+4, j, 1) = gb(i+4, j, 1) + c5*tempb0
    gb(i-5, j, 1) = gb(i-5, j, 1) + c5*tempb0
    fb(i, j, 1) = fb(i, j, 1) + c1*tempb1
    fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb1
    fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb1
    fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb1
    fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb1
    fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb1
    fb(i+3, j, 1) = fb(i+3, j, 1) + c4*tempb1
    fb(i-4, j, 1) = fb(i-4, j, 1) + c4*tempb1
    fb(i+4, j, 1) = fb(i+4, j, 1) + c5*tempb1
    fb(i-5, j, 1) = fb(i-5, j, 1) + c5*tempb1
  END DO
  omrr = ad_save221
  ducros1 = ad_save222
  vy = ad_save223
  vort2 = ad_save224
  vx = ad_save225
  sq = ad_save226
  vv = ad_save227
  sn = ad_save228
  vr = ad_save229
  predrow2 = ad_save230
  predrow1 = ad_save231
  vl = ad_save232
  nxloc = ad_save233
  nyloc = ad_save234
  dxm2 = ad_save235
  uy = ad_save236
  predro2 = ad_save237
  dxm1 = ad_save238
  rr = ad_save239
  ux = ad_save240
  predro1 = ad_save241
  mmu = ad_save242
  uu = ad_save243
  lambda = ad_save244
  ur = ad_save245
  eps4 = ad_save246
  eps2 = ad_save247
  predrov2 = ad_save248
  predrov1 = ad_save249
  ul = ad_save250
  mach2 = ad_save251
  rhomr = ad_save252
  rspec = ad_save253
  v = ad_save254
  alpha = ad_save255
  ty = ad_save256
  u = ad_save257
  tx = ad_save258
  rhoml = ad_save259
  r = ad_save260
  predroe2 = ad_save261
  wy = ad_save262
  predroe1 = ad_save263
  wx = ad_save264
  ww = ad_save265
  predrou2 = ad_save266
  predrou1 = ad_save267
  j = 4
!$BWD-OF II-LOOP 
!DIR$ IVDEP
  DO i=1,im+1
    predro1 = -(d5*w(i-5, j, 1)) + d4*w(i-4, j, 1) - d3*w(i-3, j, 1) + &
&     d2*w(i-2, j, 1) - d1*w(i-1, j, 1) + d1*w(i, j, 1) - d2*w(i+1, j, 1&
&     ) + d3*w(i+2, j, 1) - d4*w(i+3, j, 1) + d5*w(i+4, j, 1)
    predrou1 = -(d5*w(i-5, j, 2)) + d4*w(i-4, j, 2) - d3*w(i-3, j, 2) + &
&     d2*w(i-2, j, 2) - d1*w(i-1, j, 2) + d1*w(i, j, 2) - d2*w(i+1, j, 2&
&     ) + d3*w(i+2, j, 2) - d4*w(i+3, j, 2) + d5*w(i+4, j, 2)
    predrov1 = -(d5*w(i-5, j, 3)) + d4*w(i-4, j, 3) - d3*w(i-3, j, 3) + &
&     d2*w(i-2, j, 3) - d1*w(i-1, j, 3) + d1*w(i, j, 3) - d2*w(i+1, j, 3&
&     ) + d3*w(i+2, j, 3) - d4*w(i+3, j, 3) + d5*w(i+4, j, 3)
    predrow1 = -(d5*w(i-5, j, 4)) + d4*w(i-4, j, 4) - d3*w(i-3, j, 4) + &
&     d2*w(i-2, j, 4) - d1*w(i-1, j, 4) + d1*w(i, j, 4) - d2*w(i+1, j, 4&
&     ) + d3*w(i+2, j, 4) - d4*w(i+3, j, 4) + d5*w(i+4, j, 4)
    predroe1 = -(d5*w(i-5, j, 5)) + d4*w(i-4, j, 5) - d3*w(i-3, j, 5) + &
&     d2*w(i-2, j, 5) - d1*w(i-1, j, 5) + d1*w(i, j, 5) - d2*w(i+1, j, 5&
&     ) + d3*w(i+2, j, 5) - d4*w(i+3, j, 5) + d5*w(i+4, j, 5)
    predro2 = -(d5*w(i, j-5, 1)) + d4*w(i, j-4, 1) - d3*w(i, j-3, 1) + &
&     d2*w(i, j-2, 1) - d1*w(i, j-1, 1) + d1*w(i, j, 1) - d2*w(i, j+1, 1&
&     ) + d3*w(i, j+2, 1) - d4*w(i, j+3, 1) + d5*w(i, j+4, 1)
    predrou2 = -(d5*w(i, j-5, 2)) + d4*w(i, j-4, 2) - d3*w(i, j-3, 2) + &
&     d2*w(i, j-2, 2) - d1*w(i, j-1, 2) + d1*w(i, j, 2) - d2*w(i, j+1, 2&
&     ) + d3*w(i, j+2, 2) - d4*w(i, j+3, 2) + d5*w(i, j+4, 2)
    predrov2 = -(d5*w(i, j-5, 3)) + d4*w(i, j-4, 3) - d3*w(i, j-3, 3) + &
&     d2*w(i, j-2, 3) - d1*w(i, j-1, 3) + d1*w(i, j, 3) - d2*w(i, j+1, 3&
&     ) + d3*w(i, j+2, 3) - d4*w(i, j+3, 3) + d5*w(i, j+4, 3)
    predrow2 = -(d5*w(i, j-5, 4)) + d4*w(i, j-4, 4) - d3*w(i, j-3, 4) + &
&     d2*w(i, j-2, 4) - d1*w(i, j-1, 4) + d1*w(i, j, 4) - d2*w(i, j+1, 4&
&     ) + d3*w(i, j+2, 4) - d4*w(i, j+3, 4) + d5*w(i, j+4, 4)
    predroe2 = -(d5*w(i, j-5, 5)) + d4*w(i, j-4, 5) - d3*w(i, j-3, 5) + &
&     d2*w(i, j-2, 5) - d1*w(i, j-1, 5) + d1*w(i, j, 5) - d2*w(i, j+1, 5&
&     ) + d3*w(i, j+2, 5) - d4*w(i, j+3, 5) + d5*w(i, j+4, 5)
! grad for viscous fluxes o4 - 5p
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccros = TWELFTH*0.0625d0
    volm1 = volf(i, j, 1)
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    val_n = twentyfourth*(-velx(i+1, j)+26.d0*velx(i, j)-velx(i-1, j))
    val_s = twentyfourth*(-velx(i, j)+26.d0*velx(i-1, j)-velx(i-2, j))
    val_e = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-1, j-2)+9.d0*velx(i, j&
&     -2)-velx(i+1, j-2))+7.d0*(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0&
&     *velx(i, j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j&
&     )+9.d0*velx(i, j)-velx(i+1, j))-(-velx(i-2, j+1)+9.d0*velx(i-1, j+&
&     1)+9.d0*velx(i, j+1)-velx(i+1, j+1)))
    val_o = ccross*(-(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0*velx(i, j&
&     -1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*&
&     velx(i, j)-velx(i+1, j))+7.d0*(-velx(i-2, j+1)+9.d0*velx(i-1, j+1)&
&     +9.d0*velx(i, j+1)-velx(i+1, j+1))-(-velx(i-2, j+2)+9.d0*velx(i-1&
&     , j+2)+9.d0*velx(i, j+2)-velx(i+1, j+2)))
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-vely(i+1, j)+26.d0*vely(i, j)-vely(i-1, j))
    val_s = twentyfourth*(-vely(i, j)+26.d0*vely(i-1, j)-vely(i-2, j))
    val_e = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-1, j-2)+9.d0*vely(i, j&
&     -2)-vely(i+1, j-2))+7.d0*(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0&
&     *vely(i, j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j&
&     )+9.d0*vely(i, j)-vely(i+1, j))-(-vely(i-2, j+1)+9.d0*vely(i-1, j+&
&     1)+9.d0*vely(i, j+1)-vely(i+1, j+1)))
    val_o = ccross*(-(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0*vely(i, j&
&     -1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*&
&     vely(i, j)-vely(i+1, j))+7.d0*(-vely(i-2, j+1)+9.d0*vely(i-1, j+1)&
&     +9.d0*vely(i, j+1)-vely(i+1, j+1))-(-vely(i-2, j+2)+9.d0*vely(i-1&
&     , j+2)+9.d0*vely(i, j+2)-vely(i+1, j+2)))
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-velz(i+1, j)+26.d0*velz(i, j)-velz(i-1, j))
    val_s = twentyfourth*(-velz(i, j)+26.d0*velz(i-1, j)-velz(i-2, j))
    val_e = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-1, j-2)+9.d0*velz(i, j&
&     -2)-velz(i+1, j-2))+7.d0*(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0&
&     *velz(i, j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j&
&     )+9.d0*velz(i, j)-velz(i+1, j))-(-velz(i-2, j+1)+9.d0*velz(i-1, j+&
&     1)+9.d0*velz(i, j+1)-velz(i+1, j+1)))
    val_o = ccross*(-(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0*velz(i, j&
&     -1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*&
&     velz(i, j)-velz(i+1, j))+7.d0*(-velz(i-2, j+1)+9.d0*velz(i-1, j+1)&
&     +9.d0*velz(i, j+1)-velz(i+1, j+1))-(-velz(i-2, j+2)+9.d0*velz(i-1&
&     , j+2)+9.d0*velz(i, j+2)-velz(i+1, j+2)))
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-tloc(i+1, j)+26.d0*tloc(i, j)-tloc(i-1, j))
    val_s = twentyfourth*(-tloc(i, j)+26.d0*tloc(i-1, j)-tloc(i-2, j))
    val_e = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-1, j-2)+9.d0*tloc(i, j&
&     -2)-tloc(i+1, j-2))+7.d0*(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0&
&     *tloc(i, j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j&
&     )+9.d0*tloc(i, j)-tloc(i+1, j))-(-tloc(i-2, j+1)+9.d0*tloc(i-1, j+&
&     1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1)))
    val_o = ccross*(-(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i, j&
&     -1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j)+9.d0*&
&     tloc(i, j)-tloc(i+1, j))+7.d0*(-tloc(i-2, j+1)+9.d0*tloc(i-1, j+1)&
&     +9.d0*tloc(i, j+1)-tloc(i+1, j+1))-(-tloc(i-2, j+2)+9.d0*tloc(i-1&
&     , j+2)+9.d0*tloc(i, j+2)-tloc(i+1, j+2)))
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
    uu = 0.0625d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*velx(i, j)-velx(&
&     i+1, j))
    vv = 0.0625d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*vely(i, j)-vely(&
&     i+1, j))
    ww = 0.0625d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*velz(i, j)-velz(&
&     i+1, j))
!
    mmu = 0.0625d0*(-mu(i-2, j)+9.d0*mu(i-1, j)+9.d0*mu(i, j)-mu(i+1, j)&
&     )
    lambda = mmu*cpprandtl
!
    fvrou1 = twothird*mmu*(two*ux-vy)
    fvrov1 = mmu*(uy+vx)
    fvrow1 = mmu*wx
! fvroe1 = (lambda*tx + uu*fvrou1 + vv*fvrov1)
!
    gvrou1 = mmu*(uy+vx)
    gvrov1 = twothird*mmu*(-ux+two*vy)
    gvrow1 = mmu*wy
! gvroe1 = (lambda*ty + uu*gvrou1 + vv*gvrov1)
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! grad for viscous fluxes o4 - 5p
!
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccross = TWELFTH*0.0625d0
    volm1 = volf(i, j, 2)
    nx_n = half*(nx(i+1, j-1, 1)+nx(i+1, j, 1))
    nx_s = -(half*(nx(i, j-1, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i, j+1, 2)+nx(i, j, 2))
    nx_e = -(half*(nx(i, j-1, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j-1, 1)+ny(i+1, j, 1))
    ny_s = -(half*(ny(i, j-1, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i, j+1, 2)+ny(i, j, 2))
    ny_e = -(half*(ny(i, j-1, 2)+ny(i, j, 2)))
    val_n = ccross*(-(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+9.d0*velx(i-1&
&     , j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*&
&     velx(i, j)-velx(i, j+1))+7.d0*(-velx(i+1, j-2)+9.d0*velx(i+1, j-1)&
&     +9.d0*velx(i+1, j)-velx(i+1, j+1))-(-velx(i+2, j-2)+9.d0*velx(i+2&
&     , j-1)+9.d0*velx(i+2, j)-velx(i+2, j+1)))
    val_s = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-2, j-1)+9.d0*velx(i-2&
&     , j)-velx(i-2, j+1))+7.d0*(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+&
&     9.d0*velx(i-1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i&
&     , j-1)+9.d0*velx(i, j)-velx(i, j+1))-(-velx(i+1, j-2)+9.d0*velx(i+&
&     1, j-1)+9.d0*velx(i+1, j)-velx(i+1, j+1)))
    val_e = twentyfourth*(-velx(i, j)+26.d0*velx(i, j-1)-velx(i, j-2))
    val_o = twentyfourth*(-velx(i, j+1)+26.d0*velx(i, j)-velx(i, j-1))
    ad_save110 = ux
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save111 = uy
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+9.d0*vely(i-1&
&     , j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*&
&     vely(i, j)-vely(i, j+1))+7.d0*(-vely(i+1, j-2)+9.d0*vely(i+1, j-1)&
&     +9.d0*vely(i+1, j)-vely(i+1, j+1))-(-vely(i+2, j-2)+9.d0*vely(i+2&
&     , j-1)+9.d0*vely(i+2, j)-vely(i+2, j+1)))
    val_s = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-2, j-1)+9.d0*vely(i-2&
&     , j)-vely(i-2, j+1))+7.d0*(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+&
&     9.d0*vely(i-1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i&
&     , j-1)+9.d0*vely(i, j)-vely(i, j+1))-(-vely(i+1, j-2)+9.d0*vely(i+&
&     1, j-1)+9.d0*vely(i+1, j)-vely(i+1, j+1)))
    val_e = twentyfourth*(-vely(i, j)+26.d0*vely(i, j-1)-vely(i, j-2))
    val_o = twentyfourth*(-vely(i, j+1)+26.d0*vely(i, j)-vely(i, j-1))
    ad_save112 = vx
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save113 = vy
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+9.d0*velz(i-1&
&     , j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*&
&     velz(i, j)-velz(i, j+1))+7.d0*(-velz(i+1, j-2)+9.d0*velz(i+1, j-1)&
&     +9.d0*velz(i+1, j)-velz(i+1, j+1))-(-velz(i+2, j-2)+9.d0*velz(i+2&
&     , j-1)+9.d0*velz(i+2, j)-velz(i+2, j+1)))
    val_s = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-2, j-1)+9.d0*velz(i-2&
&     , j)-velz(i-2, j+1))+7.d0*(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+&
&     9.d0*velz(i-1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i&
&     , j-1)+9.d0*velz(i, j)-velz(i, j+1))-(-velz(i+1, j-2)+9.d0*velz(i+&
&     1, j-1)+9.d0*velz(i+1, j)-velz(i+1, j+1)))
    val_e = twentyfourth*(-velz(i, j)+26.d0*velz(i, j-1)-velz(i, j-2))
    val_o = twentyfourth*(-velz(i, j+1)+26.d0*velz(i, j)-velz(i, j-1))
    ad_save114 = wx
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save115 = wy
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i-1&
&     , j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i, j-1)+9.d0*&
&     tloc(i, j)-tloc(i, j+1))+7.d0*(-tloc(i+1, j-2)+9.d0*tloc(i+1, j-1)&
&     +9.d0*tloc(i+1, j)-tloc(i+1, j+1))-(-tloc(i+2, j-2)+9.d0*tloc(i+2&
&     , j-1)+9.d0*tloc(i+2, j)-tloc(i+2, j+1)))
    val_s = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-2, j-1)+9.d0*tloc(i-2&
&     , j)-tloc(i-2, j+1))+7.d0*(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+&
&     9.d0*tloc(i-1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i&
&     , j-1)+9.d0*tloc(i, j)-tloc(i, j+1))-(-tloc(i+1, j-2)+9.d0*tloc(i+&
&     1, j-1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1)))
    val_e = twentyfourth*(-tloc(i, j)+26.d0*tloc(i, j-1)-tloc(i, j-2))
    val_o = twentyfourth*(-tloc(i, j+1)+26.d0*tloc(i, j)-tloc(i, j-1))
    ad_save116 = tx
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save117 = ty
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    ad_save118 = uu
    uu = 0.0625d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*velx(i, j)-velx(&
&     i, j+1))
    ad_save119 = vv
    vv = 0.0625d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*vely(i, j)-vely(&
&     i, j+1))
    ad_save120 = ww
    ww = 0.0625d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*velz(i, j)-velz(&
&     i, j+1))
!
    ad_save121 = mmu
    mmu = 0.0625d0*(-mu(i, j-2)+9.d0*mu(i, j-1)+9.d0*mu(i, j)-mu(i, j+1)&
&     )
    ad_save122 = lambda
    lambda = mmu*cpprandtl
!
    fvrou2 = twothird*mmu*(two*ux-vy)
    fvrov2 = mmu*(uy+vx)
    fvrow2 = mmu*wx
! fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2)
    gvrou2 = mmu*(uy+vx)
    gvrov2 = twothird*mmu*(-ux+two*vy)
    gvrow2 = mmu*wy
! gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2)
!!  fvrou2 = TWOTHIRD*mmu*( TWO*ux -     vy  -  wz  )
!!  fvrov2 =          mmu*(     uy +     vx         )
!!  fvrow2 =          mmu*(     uz           +  wx  )
!!  fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2 + ww * fvrow2)
!!
!!  gvrou2 =          mmu*(     uy +     vx       )
!!  gvrov2 = TWOTHIRD*mmu*(    -ux + TWO*vy -  wz )
!!  gvrow2 =          mmu*(              vz +  wy )
!!  gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2 + ww*gvrow2)
! #include "rhs/spectralradius_i.F"
! correction Rossow JCP 2000
!1st direction
    rhomr = w(i, j, 1)
    ur = w(i, j, 2)/rhomr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i-1, j, 1)
    ul = w(i-1, j, 2)/rhoml
    vl = w(i-1, j, 3)/rhoml
    c2l = gam*rgaz*tloc(i-1, j)
!
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    u = ul*rr + ur*omrr
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_branch31 = 0
      mach2 = one
    ELSE
      mach2 = vn2/c2x
      ad_branch31 = 1
    END IF
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    x5 = nx(i, j, 1)*u + ny(i, j, 1)*v
    IF (x5 .GE. 0.) THEN
      ab = x5
      ad_branch32 = 0
    ELSE
      ab = -x5
      ad_branch32 = 1
    END IF
    sq = SQRT(cprim*nx2)
!
    rspec = ab + sq
    IF (p(i-1, j) - two*p(i, j) + p(i+1, j) .GE. 0.) THEN
      abs8 = p(i-1, j) - two*p(i, j) + p(i+1, j)
      ad_branch33 = 1
    ELSE
      abs8 = -(p(i-1, j)-two*p(i, j)+p(i+1, j))
      ad_branch33 = 0
    END IF
    x20 = p(i-1, j) + two*p(i, j) + p(i+1, j)
    IF (x20 .GE. 0.) THEN
      abs30 = x20
      ad_branch34 = 0
    ELSE
      abs30 = -x20
      ad_branch34 = 1
    END IF
!
!1st direction
    k_sensor1 = abs8/abs30
    IF (p(i-2, j) - two*p(i-1, j) + p(i, j) .GE. 0.) THEN
      abs9 = p(i-2, j) - two*p(i-1, j) + p(i, j)
      ad_branch35 = 1
    ELSE
      abs9 = -(p(i-2, j)-two*p(i-1, j)+p(i, j))
      ad_branch35 = 0
    END IF
    x21 = p(i-2, j) + two*p(i-1, j) + p(i, j)
    IF (x21 .GE. 0.) THEN
      abs31 = x21
      ad_branch36 = 0
    ELSE
      abs31 = -x21
      ad_branch36 = 1
    END IF
    k_sensor2 = abs9/abs31
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    divu2 = divu*divu
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    ducros1 = divu2/(divu2+vort2+1d-15)
    dxm1 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    ad_save123 = divu2
    divu2 = divu*divu
    vort2 = (gradv(i-1, j, 1)-gradu(i-1, j, 2))*(gradv(i-1, j, 1)-gradu(&
&     i-1, j, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch37 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch37 = 1
    END IF
!     ! extension of shock capturing
!
!    k_sensor1 = ABS(p(i,j) - TWO*p(i+1,j) + p(i+2,j)) / &
!                ABS(p(i,j) + TWO*p(i+1,j) + p(i+2,j))
!
!    k_sensor2 = ABS(p(i-3,j) - TWO*p(i-2,j) + p(i-1,j)) / &
!                ABS(p(i-3,j) + TWO*p(i-2,j) + p(i-1,j))
!
!    divu2     = (gradu(i+1,j,1)+gradv(i+1,j,2)) * (gradu(i+1,j,1)+gradv(i+1,j,2))
!    vort2     = (gradv(i+1,j,1)-gradu(i+1,j,2)) * (gradv(i+1,j,1)-gradu(i+1,j,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i-2,j,1)+gradv(i-2,j,2)) * (gradu(i-2,j,1)+gradv(i-2,j,2))
!    vort2     = (gradv(i-2,j,1)-gradu(i-2,j,2)) * (gradv(i-2,j,1)-gradu(i-2,j,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                      k_sensor2*ducros2, coef)
!
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      eps4 = k4 - 12.d0*eps2
      ad_branch38 = 0
    ELSE
      ad_branch38 = 1
      eps4 = zero
    END IF
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_diri.F"
!     endif
! #include "rhs/spectralradius_j.F"
! correction Rossow JCP 2000
!2st direction
    rhomr = w(i, j, 1)
    ad_save124 = ur
    ur = w(i, j, 2)/rhomr
    ad_save125 = vr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i, j-1, 1)
    ul = w(i, j-1, 2)/rhoml
    vl = w(i, j-1, 3)/rhoml
    c2l = gam*rgaz*tloc(i, j-1)
!
    ad_save126 = r
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    ad_save127 = u
    u = ul*rr + ur*omrr
    ad_save128 = v
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    nx2 = nx(i, j, 2)*nx(i, j, 2) + ny(i, j, 2)*ny(i, j, 2)
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_save129 = mach2
      mach2 = one
      ad_branch39 = 0
    ELSE
      ad_save130 = mach2
      mach2 = vn2/c2x
      ad_branch39 = 1
    END IF
    ad_save131 = alpha
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    x6 = nx(i, j, 2)*u + ny(i, j, 2)*v
    IF (x6 .GE. 0.) THEN
      ab = x6
      ad_branch40 = 0
    ELSE
      ab = -x6
      ad_branch40 = 1
    END IF
    ad_save132 = sq
    sq = SQRT(cprim*nx2)
!
    ad_save133 = rspec
    rspec = ab + sq
    IF (p(i, j-1) - two*p(i, j) + p(i, j+1) .GE. 0.) THEN
      abs10 = p(i, j-1) - two*p(i, j) + p(i, j+1)
      ad_branch41 = 1
    ELSE
      abs10 = -(p(i, j-1)-two*p(i, j)+p(i, j+1))
      ad_branch41 = 0
    END IF
    x22 = p(i, j-1) + two*p(i, j) + p(i, j+1)
    IF (x22 .GE. 0.) THEN
      abs32 = x22
      ad_branch42 = 0
    ELSE
      abs32 = -x22
      ad_branch42 = 1
    END IF
!
! 2nd direction
    k_sensor1 = abs10/abs32
    IF (p(i, j-2) - two*p(i, j-1) + p(i, j) .GE. 0.) THEN
      abs11 = p(i, j-2) - two*p(i, j-1) + p(i, j)
      ad_branch43 = 1
    ELSE
      abs11 = -(p(i, j-2)-two*p(i, j-1)+p(i, j))
      ad_branch43 = 0
    END IF
    x23 = p(i, j-2) + two*p(i, j-1) + p(i, j)
    IF (x23 .GE. 0.) THEN
      abs33 = x23
      ad_branch44 = 0
    ELSE
      abs33 = -x23
      ad_branch44 = 1
    END IF
    k_sensor2 = abs11/abs33
!     ducros1 is done in dissipation_ducros_x
    divu = gradu(i, j-1, 1) + gradv(i, j-1, 2)
    divu2 = divu*divu
    ad_save134 = vort2
    vort2 = (gradv(i, j-1, 1)-gradu(i, j-1, 2))*(gradv(i, j-1, 1)-gradu(&
&     i, j-1, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
!sq = sound/dx
    ad_save135 = dxm2
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch45 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch45 = 1
    END IF
! extension of shock capturing
!    k_sensor1 = ABS(p(i,j) - TWO*p(i,j+1) + p(i,j+2)) / &
!                ABS(p(i,j) + TWO*p(i,j+1) + p(i,j+2))
!
!    k_sensor2 = ABS(p(i,j-3) - TWO*p(i,j-2) + p(i,j-1)) / &
!                ABS(p(i,j-3) + TWO*p(i,j-2) + p(i,j-1))
!
!    divu2     = (gradu(i,j+1,1)+gradv(i,j+1,2)) * (gradu(i,j+1,1)+gradv(i,j+1,2))
!    vort2     = (gradv(i,j+1,1)-gradu(i,j+1,2)) * (gradv(i,j+1,1)-gradu(i,j+1,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i,j-2,1)+gradv(i,j-2,2)) * (gradu(i,j-2,1)+gradv(i,j-2,2))
!    vort2     = (gradv(i,j-2,1)-gradu(i,j-2,2)) * (gradv(i,j-2,1)-gradu(i,j-2,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                     k_sensor2*ducros2, coef)
    ad_save136 = eps2
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      ad_save137 = eps4
      eps4 = k4 - 12.d0*eps2
      ad_branch46 = 0
    ELSE
      ad_save138 = eps4
      eps4 = zero
      ad_branch46 = 1
    END IF
    diffro = half*(w(i, j, 1)-w(i, j-1, 1))
    diffrou = half*(w(i, j, 2)-w(i, j-1, 2))
    diffrov = half*(w(i, j, 3)-w(i, j-1, 3))
    diffrow = half*(w(i, j, 4)-w(i, j-1, 4))
    diffroe = half*(w(i, j, 5)-w(i, j-1, 5))
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_dirj.F"
!     endif
!
    sc1 = nx(i, j, 1)
    sc2 = ny(i, j, 1)
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    nxloc = sc1*invsn
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
    sc1 = nx(i, j, 2)
    sc2 = ny(i, j, 2)
    ad_save139 = sn
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    ad_save140 = nxloc
    nxloc = sc1*invsn
    ad_save141 = nyloc
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,2) = ZERO
!
    fxroe2b = hnb(i, j, 5, 2)
    dissroe2b = -hnb(i, j, 5, 2)
    fvroe2b = -(nxloc*sn*hnb(i, j, 5, 2))
    gvroe2b = -(nyloc*sn*hnb(i, j, 5, 2))
    hnb(i, j, 5, 2) = 0.0_8
    fxrow2b = hnb(i, j, 4, 2)
    dissrow2b = -hnb(i, j, 4, 2)
    fvrow2b = -(nxloc*sn*hnb(i, j, 4, 2))
    gvrow2b = -(nyloc*sn*hnb(i, j, 4, 2))
    hnb(i, j, 4, 2) = 0.0_8
    fxrov2b = hnb(i, j, 3, 2)
    dissrov2b = -hnb(i, j, 3, 2)
    fvrov2b = -(nxloc*sn*hnb(i, j, 3, 2))
    gvrov2b = -(nyloc*sn*hnb(i, j, 3, 2))
    hnb(i, j, 3, 2) = 0.0_8
    fxrou2b = hnb(i, j, 2, 2)
    dissrou2b = -hnb(i, j, 2, 2)
    fvrou2b = -(nxloc*sn*hnb(i, j, 2, 2))
    gvrou2b = -(nyloc*sn*hnb(i, j, 2, 2))
    hnb(i, j, 2, 2) = 0.0_8
    fxro2b = hnb(i, j, 1, 2)
    dissro2b = -hnb(i, j, 1, 2)
    hnb(i, j, 1, 2) = 0.0_8
    nyloc = ad_save141
    nxloc = ad_save140
    sn = ad_save139
    fxroe1b = hnb(i, j, 5, 1)
    dissroe1b = -hnb(i, j, 5, 1)
    fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
    gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
    hnb(i, j, 5, 1) = 0.0_8
    fxrow1b = hnb(i, j, 4, 1)
    dissrow1b = -hnb(i, j, 4, 1)
    fvrow1b = -(nxloc*sn*hnb(i, j, 4, 1))
    gvrow1b = -(nyloc*sn*hnb(i, j, 4, 1))
    hnb(i, j, 4, 1) = 0.0_8
    fxrov1b = hnb(i, j, 3, 1)
    dissrov1b = -hnb(i, j, 3, 1)
    fvrov1b = -(nxloc*sn*hnb(i, j, 3, 1))
    gvrov1b = -(nyloc*sn*hnb(i, j, 3, 1))
    hnb(i, j, 3, 1) = 0.0_8
    fxrou1b = hnb(i, j, 2, 1)
    dissrou1b = -hnb(i, j, 2, 1)
    fvrou1b = -(nxloc*sn*hnb(i, j, 2, 1))
    gvrou1b = -(nyloc*sn*hnb(i, j, 2, 1))
    hnb(i, j, 2, 1) = 0.0_8
    fxro1b = hnb(i, j, 1, 1)
    dissro1b = -hnb(i, j, 1, 1)
    hnb(i, j, 1, 1) = 0.0_8
    rspecb = (eps2*diffroe+eps4*predroe2)*dissroe2b + (eps2*diffrow+eps4&
&     *predrow2)*dissrow2b + (eps2*diffrov+eps4*predrov2)*dissrov2b + (&
&     eps2*diffrou+eps4*predrou2)*dissrou2b + (eps2*diffro+eps4*predro2)&
&     *dissro2b
    tempb1 = rspec*dissroe2b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe2*tempb1
    predroe2b = eps4*tempb1
    tempb1 = rspec*dissrow2b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow2*tempb1
    predrow2b = eps4*tempb1
    tempb1 = rspec*dissrov2b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    eps4b = eps4b + predrov2*tempb1
    predrov2b = eps4*tempb1
    tempb1 = rspec*dissrou2b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    eps4b = eps4b + predrou2*tempb1
    predrou2b = eps4*tempb1
    tempb1 = rspec*dissro2b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    eps4b = eps4b + predro2*tempb1
    predro2b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i, j-1, 5) = wb(i, j-1, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i, j-1, 4) = wb(i, j-1, 4) - half*diffrowb
    wb(i, j, 3) = wb(i, j, 3) + half*diffrovb
    wb(i, j-1, 3) = wb(i, j-1, 3) - half*diffrovb
    wb(i, j, 2) = wb(i, j, 2) + half*diffroub
    wb(i, j-1, 2) = wb(i, j-1, 2) - half*diffroub
    wb(i, j, 1) = wb(i, j, 1) + half*diffrob
    wb(i, j-1, 1) = wb(i, j-1, 1) - half*diffrob
    IF (ad_branch46 .EQ. 0) THEN
      eps4 = ad_save137
      eps2b = eps2b - 12.d0*eps4b
    ELSE
      eps4 = ad_save138
    END IF
    eps2 = ad_save136
    coefb = k2*eps2b
    IF (ad_branch45 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      dxm1b = 0.0_8
      k_sensor1b = 0.0_8
      ducros1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = k_sensor1*dxm1*coefb
      dxm1b = k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    dxm2 = ad_save135
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    vort2 = ad_save134
    tempb1 = 2*(gradv(i, j-1, 1)-gradu(i, j-1, 2))*vort2b
    gradvb(i, j-1, 1) = gradvb(i, j-1, 1) + tempb1
    gradub(i, j-1, 2) = gradub(i, j-1, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j-1, 1) = gradub(i, j-1, 1) + divub
    gradvb(i, j-1, 2) = gradvb(i, j-1, 2) + divub
    abs11b = k_sensor2b/abs33
    abs33b = -(abs11*k_sensor2b/abs33**2)
    IF (ad_branch44 .EQ. 0) THEN
      x23b = abs33b
    ELSE
      x23b = -abs33b
    END IF
    pb(i, j-2) = pb(i, j-2) + x23b
    pb(i, j-1) = pb(i, j-1) + two*x23b
    pb(i, j) = pb(i, j) + x23b
    IF (ad_branch43 .EQ. 0) THEN
      pb(i, j-1) = pb(i, j-1) + two*abs11b
      pb(i, j-2) = pb(i, j-2) - abs11b
      pb(i, j) = pb(i, j) - abs11b
    ELSE
      pb(i, j-2) = pb(i, j-2) + abs11b
      pb(i, j-1) = pb(i, j-1) - two*abs11b
      pb(i, j) = pb(i, j) + abs11b
    END IF
    abs10b = k_sensor1b/abs32
    abs32b = -(abs10*k_sensor1b/abs32**2)
    IF (ad_branch42 .EQ. 0) THEN
      x22b = abs32b
    ELSE
      x22b = -abs32b
    END IF
    pb(i, j-1) = pb(i, j-1) + x22b
    pb(i, j) = pb(i, j) + two*x22b
    pb(i, j+1) = pb(i, j+1) + x22b
    IF (ad_branch41 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs10b
      pb(i, j-1) = pb(i, j-1) - abs10b
      pb(i, j+1) = pb(i, j+1) - abs10b
    ELSE
      pb(i, j-1) = pb(i, j-1) + abs10b
      pb(i, j) = pb(i, j) - two*abs10b
      pb(i, j+1) = pb(i, j+1) + abs10b
    END IF
    rspec = ad_save133
    abb = rspecb
    sqb = sqb + rspecb
    sq = ad_save132
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch40 .EQ. 0) THEN
      x6b = abb
    ELSE
      x6b = -abb
    END IF
    ub = nx(i, j, 2)*x6b
    vb = ny(i, j, 2)*x6b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    alpha = ad_save131
    IF (ad_branch39 .EQ. 0) THEN
      mach2 = ad_save129
    ELSE
      mach2 = ad_save130
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    diffro = half*(w(i, j, 1)-w(i-1, j, 1))
    diffrou = half*(w(i, j, 2)-w(i-1, j, 2))
    diffrov = half*(w(i, j, 3)-w(i-1, j, 3))
    diffrow = half*(w(i, j, 4)-w(i-1, j, 4))
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    v = ad_save128
    vlb = rr*vb
    vrb = omrr*vb
    u = ad_save127
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    r = ad_save126
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i, j-1, 3)*vlb/rhoml**2 - w(i, j-&
&     1, 2)*ulb/rhoml**2
    tlocb(i, j-1) = tlocb(i, j-1) + gam*rgaz*c2lb
    wb(i, j-1, 3) = wb(i, j-1, 3) + vlb/rhoml
    wb(i, j-1, 2) = wb(i, j-1, 2) + ulb/rhoml
    wb(i, j-1, 1) = wb(i, j-1, 1) + rhomlb
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb
    rhoml = w(i-1, j, 1)
    rr = one/(one+r)
    vl = w(i-1, j, 3)/rhoml
    omrr = one - rr
    vr = ad_save125
    ul = w(i-1, j, 2)/rhoml
    ur = ad_save124
    diffroe = half*(w(i, j, 5)-w(i-1, j, 5))
    rspecb = (eps2*diffroe+eps4*predroe1)*dissroe1b + (eps2*diffrow+eps4&
&     *predrow1)*dissrow1b + (eps2*diffrov+eps4*predrov1)*dissrov1b + (&
&     eps2*diffrou+eps4*predrou1)*dissrou1b + (eps2*diffro+eps4*predro1)&
&     *dissro1b
    tempb1 = rspec*dissroe1b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe1*tempb1
    predroe1b = eps4*tempb1
    tempb1 = rspec*dissrow1b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow1*tempb1
    predrow1b = eps4*tempb1
    tempb1 = rspec*dissrov1b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + half*diffrovb
    eps4b = eps4b + predrov1*tempb1
    predrov1b = eps4*tempb1
    tempb1 = rspec*dissrou1b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + half*diffroub
    rhomr = w(i, j, 1)
    eps4b = eps4b + predrou1*tempb1
    predrou1b = eps4*tempb1
    tempb1 = rspec*dissro1b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + half*diffrob
    eps4b = eps4b + predro1*tempb1
    predro1b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i-1, j, 5) = wb(i-1, j, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i-1, j, 4) = wb(i-1, j, 4) - half*diffrowb
    wb(i-1, j, 3) = wb(i-1, j, 3) - half*diffrovb
    wb(i-1, j, 2) = wb(i-1, j, 2) - half*diffroub
    wb(i-1, j, 1) = wb(i-1, j, 1) - half*diffrob
    IF (ad_branch38 .EQ. 0) eps2b = eps2b - 12.d0*eps4b
    coefb = k2*eps2b
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    divu2 = divu*divu
    k_sensor1 = abs8/abs30
    k_sensor2 = abs9/abs31
    ducros2 = divu2/(divu2+vort2+1d-15)
    IF (ad_branch37 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      k_sensor1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = ducros1b + k_sensor1*dxm1*coefb
      dxm1b = dxm1b + k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i-1, j, 1)-gradu(i-1, j, 2))*vort2b
    gradvb(i-1, j, 1) = gradvb(i-1, j, 1) + tempb1
    gradub(i-1, j, 2) = gradub(i-1, j, 2) - tempb1
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    divu2 = ad_save123
    divub = divub + 2*divu*divu2b
    gradub(i-1, j, 1) = gradub(i-1, j, 1) + divub
    gradvb(i-1, j, 2) = gradvb(i-1, j, 2) + divub
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm1b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = sqb - temp1*tempb1
    tempb1 = ducros1b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i, j, 1)-gradu(i, j, 2))*vort2b
    gradvb(i, j, 1) = gradvb(i, j, 1) + tempb1
    gradub(i, j, 2) = gradub(i, j, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j, 1) = gradub(i, j, 1) + divub
    gradvb(i, j, 2) = gradvb(i, j, 2) + divub
    abs9b = k_sensor2b/abs31
    abs31b = -(abs9*k_sensor2b/abs31**2)
    IF (ad_branch36 .EQ. 0) THEN
      x21b = abs31b
    ELSE
      x21b = -abs31b
    END IF
    pb(i-2, j) = pb(i-2, j) + x21b
    pb(i-1, j) = pb(i-1, j) + two*x21b
    pb(i, j) = pb(i, j) + x21b
    IF (ad_branch35 .EQ. 0) THEN
      pb(i-1, j) = pb(i-1, j) + two*abs9b
      pb(i-2, j) = pb(i-2, j) - abs9b
      pb(i, j) = pb(i, j) - abs9b
    ELSE
      pb(i-2, j) = pb(i-2, j) + abs9b
      pb(i-1, j) = pb(i-1, j) - two*abs9b
      pb(i, j) = pb(i, j) + abs9b
    END IF
    abs8b = k_sensor1b/abs30
    abs30b = -(abs8*k_sensor1b/abs30**2)
    IF (ad_branch34 .EQ. 0) THEN
      x20b = abs30b
    ELSE
      x20b = -abs30b
    END IF
    pb(i-1, j) = pb(i-1, j) + x20b
    pb(i, j) = pb(i, j) + two*x20b
    pb(i+1, j) = pb(i+1, j) + x20b
    IF (ad_branch33 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs8b
      pb(i-1, j) = pb(i-1, j) - abs8b
      pb(i+1, j) = pb(i+1, j) - abs8b
    ELSE
      pb(i-1, j) = pb(i-1, j) + abs8b
      pb(i, j) = pb(i, j) - two*abs8b
      pb(i+1, j) = pb(i+1, j) + abs8b
    END IF
    abb = rspecb
    sqb = sqb + rspecb
    c2r = gam*rgaz*tloc(i, j)
    c2l = gam*rgaz*tloc(i-1, j)
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    cprim = alpha*alpha*vn2 + mach2*c2x
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch32 .EQ. 0) THEN
      x5b = abb
    ELSE
      x5b = -abb
    END IF
    ub = nx(i, j, 1)*x5b
    vb = ny(i, j, 1)*x5b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    IF (ad_branch31 .NE. 0) THEN
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    fvrov2b = fvrov2b + vv*fvroe2b
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    vlb = rr*vb
    vrb = omrr*vb
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i-1, j, 3)*vlb/rhoml**2 - w(i-1, &
&     j, 2)*ulb/rhoml**2
    wb(i-1, j, 3) = wb(i-1, j, 3) + vlb/rhoml - d1*predrov1b
    wb(i-1, j, 2) = wb(i-1, j, 2) + ulb/rhoml - d1*predrou1b
    wb(i-1, j, 1) = wb(i-1, j, 1) + rhomlb - d1*predro1b
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + d1*predrov2b + d1*predrov1b
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + d1*predrou2b + d1*predrou1b
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + d1*predro2b + d1*predro1b
    lambdab = ty*gvroe2b + tx*fvroe2b
    tyb = lambda*gvroe2b
    uub = gvrou2*gvroe2b + fvrou2*fvroe2b
    gvrou2b = gvrou2b + uu*gvroe2b
    vvb = gvrov2*gvroe2b + fvrov2*fvroe2b
    gvrov2b = gvrov2b + vv*gvroe2b
    wwb = gvrow2*gvroe2b + fvrow2*fvroe2b
    gvrow2b = gvrow2b + ww*gvroe2b
    wyb = mmu*gvrow2b
    tempb1 = twothird*gvrov2b
    mmub = wy*gvrow2b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    uyb = mmu*gvrou2b + mmu*fvrov2b
    vxb = mmu*gvrou2b + mmu*fvrov2b
    txb = lambda*fvroe2b
    fvrou2b = fvrou2b + uu*fvroe2b
    fvrow2b = fvrow2b + ww*fvroe2b
    wxb = mmu*fvrow2b
    tempb1 = twothird*fvrou2b
    mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (two*&
&     ux-vy)*tempb1 + cpprandtl*lambdab
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    lambda = ad_save122
    mmu = ad_save121
    tempb1 = 0.0625d0*mmub
    mub(i, j-1) = mub(i, j-1) + 9.d0*tempb1
    mub(i, j-2) = mub(i, j-2) - tempb1
    mub(i, j) = mub(i, j) + 9.d0*tempb1
    mub(i, j+1) = mub(i, j+1) - tempb1
    ww = ad_save120
    tempb1 = 0.0625d0*wwb
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb1
    velzb(i, j-2) = velzb(i, j-2) - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb1
    velzb(i, j+1) = velzb(i, j+1) - tempb1
    vv = ad_save119
    tempb1 = 0.0625d0*vvb
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb1
    velyb(i, j-2) = velyb(i, j-2) - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb1
    velyb(i, j+1) = velyb(i, j+1) - tempb1
    uu = ad_save118
    tempb1 = 0.0625d0*uub
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb1
    velxb(i, j-2) = velxb(i, j-2) - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb1
    velxb(i, j+1) = velxb(i, j+1) - tempb1
    ty = ad_save117
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tx = ad_save116
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb + 26.d0*tempb1
    tlocb(i, j+1) = tlocb(i, j+1) - tempb1
    tlocb(i, j-1) = tlocb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    tlocb(i, j-1) = tlocb(i, j-1) + 26.d0*tempb1
    tlocb(i, j) = tlocb(i, j) - tempb1
    tlocb(i, j-2) = tlocb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
    tlocb(i-2, j-1) = tlocb(i-2, j-1) - 9.d0*tempb1
    tlocb(i-2, j) = tlocb(i-2, j) - 9.d0*tempb1
    tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) - 9.d0*tempb1
    tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1
    tlocb(i+1, j) = tlocb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    tlocb(i-1, j) = tlocb(i-1, j) + gam*rgaz*c2lb + 9.d0*tempb0 - 9.d0*&
&     tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    tlocb(i-1, j-2) = tlocb(i-1, j-2) + tempb1 - tempb0
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    tlocb(i, j-2) = tlocb(i, j-2) - tempb - tempb0
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb + 9.d0*tempb0
    tlocb(i, j+1) = tlocb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    tlocb(i+2, j-2) = tlocb(i+2, j-2) + tempb1
    tlocb(i+2, j-1) = tlocb(i+2, j-1) - 9.d0*tempb1
    tlocb(i+2, j+1) = tlocb(i+2, j+1) + tempb1
    tlocb(i+2, j) = tlocb(i+2, j) - 9.d0*tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + 9.d0*tempb
    tlocb(i+1, j-2) = tlocb(i+1, j-2) - tempb
    tlocb(i+1, j) = tlocb(i+1, j) + 9.d0*tempb
    tlocb(i+1, j+1) = tlocb(i+1, j+1) - tempb
    wy = ad_save115
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    wx = ad_save114
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velzb(i, j) = velzb(i, j) + 26.d0*tempb1
    velzb(i, j+1) = velzb(i, j+1) - tempb1
    velzb(i, j-1) = velzb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velzb(i, j-1) = velzb(i, j-1) + 26.d0*tempb1
    velzb(i, j) = velzb(i, j) - tempb1
    velzb(i, j-2) = velzb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
    velzb(i-2, j-1) = velzb(i-2, j-1) - 9.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - 9.d0*tempb1
    velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) - 9.d0*tempb1
    velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1
    velzb(i+1, j) = velzb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velzb(i-1, j-2) = velzb(i-1, j-2) + tempb1 - tempb0
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velzb(i, j-2) = velzb(i, j-2) - tempb - tempb0
    velzb(i, j) = velzb(i, j) + 9.d0*tempb + 9.d0*tempb0
    velzb(i, j+1) = velzb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velzb(i+2, j-2) = velzb(i+2, j-2) + tempb1
    velzb(i+2, j-1) = velzb(i+2, j-1) - 9.d0*tempb1
    velzb(i+2, j+1) = velzb(i+2, j+1) + tempb1
    velzb(i+2, j) = velzb(i+2, j) - 9.d0*tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + 9.d0*tempb
    velzb(i+1, j-2) = velzb(i+1, j-2) - tempb
    velzb(i+1, j) = velzb(i+1, j) + 9.d0*tempb
    velzb(i+1, j+1) = velzb(i+1, j+1) - tempb
    vy = ad_save113
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    vx = ad_save112
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velyb(i, j) = velyb(i, j) + 26.d0*tempb1
    velyb(i, j+1) = velyb(i, j+1) - tempb1
    velyb(i, j-1) = velyb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velyb(i, j-1) = velyb(i, j-1) + 26.d0*tempb1
    velyb(i, j) = velyb(i, j) - tempb1
    velyb(i, j-2) = velyb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
    velyb(i-2, j-1) = velyb(i-2, j-1) - 9.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - 9.d0*tempb1
    velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) - 9.d0*tempb1
    velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1
    velyb(i+1, j) = velyb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velyb(i-1, j-2) = velyb(i-1, j-2) + tempb1 - tempb0
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velyb(i, j-2) = velyb(i, j-2) - tempb - tempb0
    velyb(i, j) = velyb(i, j) + 9.d0*tempb + 9.d0*tempb0
    velyb(i, j+1) = velyb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velyb(i+2, j-2) = velyb(i+2, j-2) + tempb1
    velyb(i+2, j-1) = velyb(i+2, j-1) - 9.d0*tempb1
    velyb(i+2, j+1) = velyb(i+2, j+1) + tempb1
    velyb(i+2, j) = velyb(i+2, j) - 9.d0*tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + 9.d0*tempb
    velyb(i+1, j-2) = velyb(i+1, j-2) - tempb
    velyb(i+1, j) = velyb(i+1, j) + 9.d0*tempb
    velyb(i+1, j+1) = velyb(i+1, j+1) - tempb
    uy = ad_save111
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    ux = ad_save110
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velxb(i, j) = velxb(i, j) + 26.d0*tempb1
    velxb(i, j+1) = velxb(i, j+1) - tempb1
    velxb(i, j-1) = velxb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velxb(i, j-1) = velxb(i, j-1) + 26.d0*tempb1
    velxb(i, j) = velxb(i, j) - tempb1
    velxb(i, j-2) = velxb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
    velxb(i-2, j-1) = velxb(i-2, j-1) - 9.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - 9.d0*tempb1
    velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) - 9.d0*tempb1
    velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1
    velxb(i+1, j) = velxb(i+1, j) - 9.d0*tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb
    tempb1 = ccross*val_nb
    velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velxb(i-1, j-2) = velxb(i-1, j-2) + tempb1 - tempb0
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velxb(i, j-2) = velxb(i, j-2) - tempb - tempb0
    velxb(i, j+1) = velxb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velxb(i+2, j-2) = velxb(i+2, j-2) + tempb1
    velxb(i+2, j-1) = velxb(i+2, j-1) - 9.d0*tempb1
    velxb(i+2, j+1) = velxb(i+2, j+1) + tempb1
    velxb(i+2, j) = velxb(i+2, j) - 9.d0*tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + 9.d0*tempb
    velxb(i+1, j-2) = velxb(i+1, j-2) - tempb
    velxb(i+1, j+1) = velxb(i+1, j+1) - tempb
    lambdab = ty*gvroe1b + tx*fvroe1b
    tyb = lambda*gvroe1b
    uub = gvrou1*gvroe1b + fvrou1*fvroe1b
    gvrou1b = gvrou1b + uu*gvroe1b
    vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
    gvrov1b = gvrov1b + vv*gvroe1b
    wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
    gvrow1b = gvrow1b + ww*gvroe1b
    wyb = mmu*gvrow1b
    tempb1 = twothird*gvrov1b
    mmub = wy*gvrow1b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    txb = lambda*fvroe1b
    fvrou1b = fvrou1b + uu*fvroe1b
    fvrov1b = fvrov1b + vv*fvroe1b
    uyb = mmu*gvrou1b + mmu*fvrov1b
    vxb = mmu*gvrou1b + mmu*fvrov1b
    fvrow1b = fvrow1b + ww*fvroe1b
    wxb = mmu*fvrow1b
    tempb1 = twothird*fvrou1b
    mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (two*&
&     ux-vy)*tempb1 + cpprandtl*lambdab
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    tempb1 = 0.0625d0*mmub
    mub(i-1, j) = mub(i-1, j) + 9.d0*tempb1
    mub(i-2, j) = mub(i-2, j) - tempb1
    mub(i, j) = mub(i, j) + 9.d0*tempb1
    mub(i+1, j) = mub(i+1, j) - tempb1
    tempb1 = 0.0625d0*wwb
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb1
    velzb(i+1, j) = velzb(i+1, j) - tempb1
    tempb1 = 0.0625d0*vvb
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb1
    velyb(i+1, j) = velyb(i+1, j) - tempb1
    tempb1 = 0.0625d0*uub
    velxb(i+1, j) = velxb(i+1, j) + 9.d0*tempb - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb0 + 9.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - tempb1
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    volm1 = volf(i, j, 1)
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    tlocb(i-2, j-1) = tlocb(i-2, j-1) + tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) - 9.d0*tempb1
    tlocb(i, j-1) = tlocb(i, j-1) - 9.d0*tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i-2, j+2) = tlocb(i-2, j+2) + tempb1
    tlocb(i-1, j+2) = tlocb(i-1, j+2) - 9.d0*tempb1
    tlocb(i+1, j+2) = tlocb(i+1, j+2) + tempb1
    tlocb(i, j+2) = tlocb(i, j+2) - 9.d0*tempb1
    tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb0
    tlocb(i-2, j) = tlocb(i-2, j) - tempb0
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb0
    tlocb(i+1, j) = tlocb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1 - tempb
    tlocb(i, j+1) = tlocb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1 - tempb
    tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
    tlocb(i-1, j-2) = tlocb(i-1, j-2) - 9.d0*tempb1
    tlocb(i, j-2) = tlocb(i, j-2) - 9.d0*tempb1
    tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0
    tlocb(i-2, j-1) = tlocb(i-2, j-1) - tempb0
    tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb0
    tlocb(i+1, j-1) = tlocb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    tlocb(i-2, j) = tlocb(i-2, j) - tempb - tempb1
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    tlocb(i+1, j) = tlocb(i+1, j) - tempb - tempb1
    tlocb(i, j) = tlocb(i, j) + 26.d0*tempb1
    tlocb(i-1, j) = tlocb(i-1, j) - tempb1
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velzb(i-2, j-1) = velzb(i-2, j-1) + tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) - 9.d0*tempb1
    velzb(i, j-1) = velzb(i, j-1) - 9.d0*tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i-2, j+2) = velzb(i-2, j+2) + tempb1
    velzb(i-1, j+2) = velzb(i-1, j+2) - 9.d0*tempb1
    velzb(i+1, j+2) = velzb(i+1, j+2) + tempb1
    velzb(i, j+2) = velzb(i, j+2) - 9.d0*tempb1
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0
    velzb(i-2, j) = velzb(i-2, j) - tempb0
    velzb(i, j) = velzb(i, j) + 9.d0*tempb0
    velzb(i+1, j) = velzb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velzb(i-1, j+1) = velzb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1 - tempb
    velzb(i, j+1) = velzb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1 - tempb
    velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
    velzb(i-1, j-2) = velzb(i-1, j-2) - 9.d0*tempb1
    velzb(i, j-2) = velzb(i, j-2) - 9.d0*tempb1
    velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0
    velzb(i-2, j-1) = velzb(i-2, j-1) - tempb0
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb0
    velzb(i+1, j-1) = velzb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - tempb - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velzb(i+1, j) = velzb(i+1, j) - tempb - tempb1
    velzb(i, j) = velzb(i, j) + 26.d0*tempb1
    velzb(i-1, j) = velzb(i-1, j) - tempb1
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velyb(i-2, j-1) = velyb(i-2, j-1) + tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) - 9.d0*tempb1
    velyb(i, j-1) = velyb(i, j-1) - 9.d0*tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i-2, j+2) = velyb(i-2, j+2) + tempb1
    velyb(i-1, j+2) = velyb(i-1, j+2) - 9.d0*tempb1
    velyb(i+1, j+2) = velyb(i+1, j+2) + tempb1
    velyb(i, j+2) = velyb(i, j+2) - 9.d0*tempb1
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0
    velyb(i-2, j) = velyb(i-2, j) - tempb0
    velyb(i, j) = velyb(i, j) + 9.d0*tempb0
    velyb(i+1, j) = velyb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velyb(i-1, j+1) = velyb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1 - tempb
    velyb(i, j+1) = velyb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1 - tempb
    velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
    velyb(i-1, j-2) = velyb(i-1, j-2) - 9.d0*tempb1
    velyb(i, j-2) = velyb(i, j-2) - 9.d0*tempb1
    velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0
    velyb(i-2, j-1) = velyb(i-2, j-1) - tempb0
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb0
    velyb(i+1, j-1) = velyb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - tempb - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velyb(i+1, j) = velyb(i+1, j) - tempb - tempb1
    velyb(i, j) = velyb(i, j) + 26.d0*tempb1
    velyb(i-1, j) = velyb(i-1, j) - tempb1
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velxb(i-2, j-1) = velxb(i-2, j-1) + tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) - 9.d0*tempb1
    velxb(i, j-1) = velxb(i, j-1) - 9.d0*tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i-2, j+2) = velxb(i-2, j+2) + tempb1
    velxb(i-1, j+2) = velxb(i-1, j+2) - 9.d0*tempb1
    velxb(i+1, j+2) = velxb(i+1, j+2) + tempb1
    velxb(i, j+2) = velxb(i, j+2) - 9.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0
    velxb(i-2, j) = velxb(i-2, j) - tempb0
    velxb(i, j) = velxb(i, j) + 9.d0*tempb0
    velxb(i+1, j) = velxb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velxb(i-1, j+1) = velxb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1 - tempb
    velxb(i, j+1) = velxb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1 - tempb
    velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
    velxb(i-1, j-2) = velxb(i-1, j-2) - 9.d0*tempb1
    velxb(i, j-2) = velxb(i, j-2) - 9.d0*tempb1
    velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0
    velxb(i-2, j-1) = velxb(i-2, j-1) - tempb0
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb0
    velxb(i+1, j-1) = velxb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - tempb - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velxb(i+1, j) = velxb(i+1, j) - tempb - tempb1
    velxb(i, j) = velxb(i, j) + 26.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) - tempb1
    wb(i, j-4, 5) = wb(i, j-4, 5) + d4*predroe2b
    wb(i, j-5, 5) = wb(i, j-5, 5) - d5*predroe2b
    wb(i, j-3, 5) = wb(i, j-3, 5) - d3*predroe2b
    wb(i, j-2, 5) = wb(i, j-2, 5) + d2*predroe2b
    wb(i, j-1, 5) = wb(i, j-1, 5) - d1*predroe2b
    wb(i, j, 5) = wb(i, j, 5) + d1*predroe2b + d1*predroe1b
    wb(i, j+1, 5) = wb(i, j+1, 5) - d2*predroe2b
    wb(i, j+2, 5) = wb(i, j+2, 5) + d3*predroe2b
    wb(i, j+4, 5) = wb(i, j+4, 5) + d5*predroe2b
    wb(i, j+3, 5) = wb(i, j+3, 5) - d4*predroe2b
    wb(i, j-4, 4) = wb(i, j-4, 4) + d4*predrow2b
    wb(i, j-5, 4) = wb(i, j-5, 4) - d5*predrow2b
    wb(i, j-3, 4) = wb(i, j-3, 4) - d3*predrow2b
    wb(i, j-2, 4) = wb(i, j-2, 4) + d2*predrow2b
    wb(i, j-1, 4) = wb(i, j-1, 4) - d1*predrow2b
    wb(i, j, 4) = wb(i, j, 4) + d1*predrow2b + d1*predrow1b
    wb(i, j+1, 4) = wb(i, j+1, 4) - d2*predrow2b
    wb(i, j+2, 4) = wb(i, j+2, 4) + d3*predrow2b
    wb(i, j+4, 4) = wb(i, j+4, 4) + d5*predrow2b
    wb(i, j+3, 4) = wb(i, j+3, 4) - d4*predrow2b
    wb(i, j-4, 3) = wb(i, j-4, 3) + d4*predrov2b
    wb(i, j-5, 3) = wb(i, j-5, 3) - d5*predrov2b
    wb(i, j-3, 3) = wb(i, j-3, 3) - d3*predrov2b
    wb(i, j-2, 3) = wb(i, j-2, 3) + d2*predrov2b
    wb(i, j-1, 3) = wb(i, j-1, 3) - d1*predrov2b
    wb(i, j+1, 3) = wb(i, j+1, 3) - d2*predrov2b
    wb(i, j+2, 3) = wb(i, j+2, 3) + d3*predrov2b
    wb(i, j+4, 3) = wb(i, j+4, 3) + d5*predrov2b
    wb(i, j+3, 3) = wb(i, j+3, 3) - d4*predrov2b
    wb(i, j-4, 2) = wb(i, j-4, 2) + d4*predrou2b
    wb(i, j-5, 2) = wb(i, j-5, 2) - d5*predrou2b
    wb(i, j-3, 2) = wb(i, j-3, 2) - d3*predrou2b
    wb(i, j-2, 2) = wb(i, j-2, 2) + d2*predrou2b
    wb(i, j-1, 2) = wb(i, j-1, 2) - d1*predrou2b
    wb(i, j+1, 2) = wb(i, j+1, 2) - d2*predrou2b
    wb(i, j+2, 2) = wb(i, j+2, 2) + d3*predrou2b
    wb(i, j+4, 2) = wb(i, j+4, 2) + d5*predrou2b
    wb(i, j+3, 2) = wb(i, j+3, 2) - d4*predrou2b
    wb(i, j-4, 1) = wb(i, j-4, 1) + d4*predro2b
    wb(i, j-5, 1) = wb(i, j-5, 1) - d5*predro2b
    wb(i, j-3, 1) = wb(i, j-3, 1) - d3*predro2b
    wb(i, j-2, 1) = wb(i, j-2, 1) + d2*predro2b
    wb(i, j-1, 1) = wb(i, j-1, 1) - d1*predro2b
    wb(i, j+1, 1) = wb(i, j+1, 1) - d2*predro2b
    wb(i, j+2, 1) = wb(i, j+2, 1) + d3*predro2b
    wb(i, j+4, 1) = wb(i, j+4, 1) + d5*predro2b
    wb(i, j+3, 1) = wb(i, j+3, 1) - d4*predro2b
    wb(i-4, j, 5) = wb(i-4, j, 5) + d4*predroe1b
    wb(i-5, j, 5) = wb(i-5, j, 5) - d5*predroe1b
    wb(i-3, j, 5) = wb(i-3, j, 5) - d3*predroe1b
    wb(i-2, j, 5) = wb(i-2, j, 5) + d2*predroe1b
    wb(i-1, j, 5) = wb(i-1, j, 5) - d1*predroe1b
    wb(i+1, j, 5) = wb(i+1, j, 5) - d2*predroe1b
    wb(i+2, j, 5) = wb(i+2, j, 5) + d3*predroe1b
    wb(i+4, j, 5) = wb(i+4, j, 5) + d5*predroe1b
    wb(i+3, j, 5) = wb(i+3, j, 5) - d4*predroe1b
    wb(i-4, j, 4) = wb(i-4, j, 4) + d4*predrow1b
    wb(i-5, j, 4) = wb(i-5, j, 4) - d5*predrow1b
    wb(i-3, j, 4) = wb(i-3, j, 4) - d3*predrow1b
    wb(i-2, j, 4) = wb(i-2, j, 4) + d2*predrow1b
    wb(i-1, j, 4) = wb(i-1, j, 4) - d1*predrow1b
    wb(i+1, j, 4) = wb(i+1, j, 4) - d2*predrow1b
    wb(i+2, j, 4) = wb(i+2, j, 4) + d3*predrow1b
    wb(i+4, j, 4) = wb(i+4, j, 4) + d5*predrow1b
    wb(i+3, j, 4) = wb(i+3, j, 4) - d4*predrow1b
    wb(i-4, j, 3) = wb(i-4, j, 3) + d4*predrov1b
    wb(i-5, j, 3) = wb(i-5, j, 3) - d5*predrov1b
    wb(i-3, j, 3) = wb(i-3, j, 3) - d3*predrov1b
    wb(i-2, j, 3) = wb(i-2, j, 3) + d2*predrov1b
    wb(i+1, j, 3) = wb(i+1, j, 3) - d2*predrov1b
    wb(i+2, j, 3) = wb(i+2, j, 3) + d3*predrov1b
    wb(i+4, j, 3) = wb(i+4, j, 3) + d5*predrov1b
    wb(i+3, j, 3) = wb(i+3, j, 3) - d4*predrov1b
    wb(i-4, j, 2) = wb(i-4, j, 2) + d4*predrou1b
    wb(i-5, j, 2) = wb(i-5, j, 2) - d5*predrou1b
    wb(i-3, j, 2) = wb(i-3, j, 2) - d3*predrou1b
    wb(i-2, j, 2) = wb(i-2, j, 2) + d2*predrou1b
    wb(i+1, j, 2) = wb(i+1, j, 2) - d2*predrou1b
    wb(i+2, j, 2) = wb(i+2, j, 2) + d3*predrou1b
    wb(i+4, j, 2) = wb(i+4, j, 2) + d5*predrou1b
    wb(i+3, j, 2) = wb(i+3, j, 2) - d4*predrou1b
    wb(i-4, j, 1) = wb(i-4, j, 1) + d4*predro1b
    wb(i-5, j, 1) = wb(i-5, j, 1) - d5*predro1b
    wb(i-3, j, 1) = wb(i-3, j, 1) - d3*predro1b
    wb(i-2, j, 1) = wb(i-2, j, 1) + d2*predro1b
    wb(i+1, j, 1) = wb(i+1, j, 1) - d2*predro1b
    wb(i+2, j, 1) = wb(i+2, j, 1) + d3*predro1b
    wb(i+4, j, 1) = wb(i+4, j, 1) + d5*predro1b
    wb(i+3, j, 1) = wb(i+3, j, 1) - d4*predro1b
    tempb1 = nx(i, j, 2)*fxroe2b
    tempb0 = ny(i, j, 2)*fxroe2b
    gb(i, 1, 5) = gb(i, 1, 5) + c7d0*tempb0
    gb(i, 2, 5) = gb(i, 2, 5) + c7d1*tempb0
    gb(i, 3, 5) = gb(i, 3, 5) + c7d2*tempb0
    gb(i, 4, 5) = gb(i, 4, 5) + c7d3*tempb0
    gb(i, 5, 5) = gb(i, 5, 5) + c7d4*tempb0
    gb(i, 6, 5) = gb(i, 6, 5) + c7d5*tempb0
    gb(i, 7, 5) = gb(i, 7, 5) + c7d6*tempb0
    gb(i, 8, 5) = gb(i, 8, 5) + c7d7*tempb0
    gb(i, 9, 5) = gb(i, 9, 5) + c7d8*tempb0
    gb(i, 10, 5) = gb(i, 10, 5) + c7d9*tempb0
    gb(i, 11, 5) = gb(i, 11, 5) + c7d10*tempb0
    fb(i, 1, 5) = fb(i, 1, 5) + c7d0*tempb1
    fb(i, 2, 5) = fb(i, 2, 5) + c7d1*tempb1
    fb(i, 3, 5) = fb(i, 3, 5) + c7d2*tempb1
    fb(i, 4, 5) = fb(i, 4, 5) + c7d3*tempb1
    fb(i, 5, 5) = fb(i, 5, 5) + c7d4*tempb1
    fb(i, 6, 5) = fb(i, 6, 5) + c7d5*tempb1
    fb(i, 7, 5) = fb(i, 7, 5) + c7d6*tempb1
    fb(i, 8, 5) = fb(i, 8, 5) + c7d7*tempb1
    fb(i, 9, 5) = fb(i, 9, 5) + c7d8*tempb1
    fb(i, 10, 5) = fb(i, 10, 5) + c7d9*tempb1
    fb(i, 11, 5) = fb(i, 11, 5) + c7d10*tempb1
    tempb1 = nx(i, j, 2)*fxrow2b
    tempb0 = ny(i, j, 2)*fxrow2b
    gb(i, 1, 4) = gb(i, 1, 4) + c7d0*tempb0
    gb(i, 2, 4) = gb(i, 2, 4) + c7d1*tempb0
    gb(i, 3, 4) = gb(i, 3, 4) + c7d2*tempb0
    gb(i, 4, 4) = gb(i, 4, 4) + c7d3*tempb0
    gb(i, 5, 4) = gb(i, 5, 4) + c7d4*tempb0
    gb(i, 6, 4) = gb(i, 6, 4) + c7d5*tempb0
    gb(i, 7, 4) = gb(i, 7, 4) + c7d6*tempb0
    gb(i, 8, 4) = gb(i, 8, 4) + c7d7*tempb0
    gb(i, 9, 4) = gb(i, 9, 4) + c7d8*tempb0
    gb(i, 10, 4) = gb(i, 10, 4) + c7d9*tempb0
    gb(i, 11, 4) = gb(i, 11, 4) + c7d10*tempb0
    fb(i, 1, 4) = fb(i, 1, 4) + c7d0*tempb1
    fb(i, 2, 4) = fb(i, 2, 4) + c7d1*tempb1
    fb(i, 3, 4) = fb(i, 3, 4) + c7d2*tempb1
    fb(i, 4, 4) = fb(i, 4, 4) + c7d3*tempb1
    fb(i, 5, 4) = fb(i, 5, 4) + c7d4*tempb1
    fb(i, 6, 4) = fb(i, 6, 4) + c7d5*tempb1
    fb(i, 7, 4) = fb(i, 7, 4) + c7d6*tempb1
    fb(i, 8, 4) = fb(i, 8, 4) + c7d7*tempb1
    fb(i, 9, 4) = fb(i, 9, 4) + c7d8*tempb1
    fb(i, 10, 4) = fb(i, 10, 4) + c7d9*tempb1
    fb(i, 11, 4) = fb(i, 11, 4) + c7d10*tempb1
    tempb1 = nx(i, j, 2)*fxrov2b
    tempb0 = ny(i, j, 2)*fxrov2b
    gb(i, 1, 3) = gb(i, 1, 3) + c7d0*tempb0
    gb(i, 2, 3) = gb(i, 2, 3) + c7d1*tempb0
    gb(i, 3, 3) = gb(i, 3, 3) + c7d2*tempb0
    gb(i, 4, 3) = gb(i, 4, 3) + c7d3*tempb0
    gb(i, 5, 3) = gb(i, 5, 3) + c7d4*tempb0
    gb(i, 6, 3) = gb(i, 6, 3) + c7d5*tempb0
    gb(i, 7, 3) = gb(i, 7, 3) + c7d6*tempb0
    gb(i, 8, 3) = gb(i, 8, 3) + c7d7*tempb0
    gb(i, 9, 3) = gb(i, 9, 3) + c7d8*tempb0
    gb(i, 10, 3) = gb(i, 10, 3) + c7d9*tempb0
    gb(i, 11, 3) = gb(i, 11, 3) + c7d10*tempb0
    fb(i, 1, 3) = fb(i, 1, 3) + c7d0*tempb1
    fb(i, 2, 3) = fb(i, 2, 3) + c7d1*tempb1
    fb(i, 3, 3) = fb(i, 3, 3) + c7d2*tempb1
    fb(i, 4, 3) = fb(i, 4, 3) + c7d3*tempb1
    fb(i, 5, 3) = fb(i, 5, 3) + c7d4*tempb1
    fb(i, 6, 3) = fb(i, 6, 3) + c7d5*tempb1
    fb(i, 7, 3) = fb(i, 7, 3) + c7d6*tempb1
    fb(i, 8, 3) = fb(i, 8, 3) + c7d7*tempb1
    fb(i, 9, 3) = fb(i, 9, 3) + c7d8*tempb1
    fb(i, 10, 3) = fb(i, 10, 3) + c7d9*tempb1
    fb(i, 11, 3) = fb(i, 11, 3) + c7d10*tempb1
    tempb1 = nx(i, j, 2)*fxrou2b
    tempb0 = ny(i, j, 2)*fxrou2b
    gb(i, 1, 2) = gb(i, 1, 2) + c7d0*tempb0
    gb(i, 2, 2) = gb(i, 2, 2) + c7d1*tempb0
    gb(i, 3, 2) = gb(i, 3, 2) + c7d2*tempb0
    gb(i, 4, 2) = gb(i, 4, 2) + c7d3*tempb0
    gb(i, 5, 2) = gb(i, 5, 2) + c7d4*tempb0
    gb(i, 6, 2) = gb(i, 6, 2) + c7d5*tempb0
    gb(i, 7, 2) = gb(i, 7, 2) + c7d6*tempb0
    gb(i, 8, 2) = gb(i, 8, 2) + c7d7*tempb0
    gb(i, 9, 2) = gb(i, 9, 2) + c7d8*tempb0
    gb(i, 10, 2) = gb(i, 10, 2) + c7d9*tempb0
    gb(i, 11, 2) = gb(i, 11, 2) + c7d10*tempb0
    fb(i, 1, 2) = fb(i, 1, 2) + c7d0*tempb1
    fb(i, 2, 2) = fb(i, 2, 2) + c7d1*tempb1
    fb(i, 3, 2) = fb(i, 3, 2) + c7d2*tempb1
    fb(i, 4, 2) = fb(i, 4, 2) + c7d3*tempb1
    fb(i, 5, 2) = fb(i, 5, 2) + c7d4*tempb1
    fb(i, 6, 2) = fb(i, 6, 2) + c7d5*tempb1
    fb(i, 7, 2) = fb(i, 7, 2) + c7d6*tempb1
    fb(i, 8, 2) = fb(i, 8, 2) + c7d7*tempb1
    fb(i, 9, 2) = fb(i, 9, 2) + c7d8*tempb1
    fb(i, 10, 2) = fb(i, 10, 2) + c7d9*tempb1
    fb(i, 11, 2) = fb(i, 11, 2) + c7d10*tempb1
    tempb1 = nx(i, j, 2)*fxro2b
    tempb0 = ny(i, j, 2)*fxro2b
    gb(i, 1, 1) = gb(i, 1, 1) + c7d0*tempb0
    gb(i, 2, 1) = gb(i, 2, 1) + c7d1*tempb0
    gb(i, 3, 1) = gb(i, 3, 1) + c7d2*tempb0
    gb(i, 4, 1) = gb(i, 4, 1) + c7d3*tempb0
    gb(i, 5, 1) = gb(i, 5, 1) + c7d4*tempb0
    gb(i, 6, 1) = gb(i, 6, 1) + c7d5*tempb0
    gb(i, 7, 1) = gb(i, 7, 1) + c7d6*tempb0
    gb(i, 8, 1) = gb(i, 8, 1) + c7d7*tempb0
    gb(i, 9, 1) = gb(i, 9, 1) + c7d8*tempb0
    gb(i, 10, 1) = gb(i, 10, 1) + c7d9*tempb0
    gb(i, 11, 1) = gb(i, 11, 1) + c7d10*tempb0
    fb(i, 1, 1) = fb(i, 1, 1) + c7d0*tempb1
    fb(i, 2, 1) = fb(i, 2, 1) + c7d1*tempb1
    fb(i, 3, 1) = fb(i, 3, 1) + c7d2*tempb1
    fb(i, 4, 1) = fb(i, 4, 1) + c7d3*tempb1
    fb(i, 5, 1) = fb(i, 5, 1) + c7d4*tempb1
    fb(i, 6, 1) = fb(i, 6, 1) + c7d5*tempb1
    fb(i, 7, 1) = fb(i, 7, 1) + c7d6*tempb1
    fb(i, 8, 1) = fb(i, 8, 1) + c7d7*tempb1
    fb(i, 9, 1) = fb(i, 9, 1) + c7d8*tempb1
    fb(i, 10, 1) = fb(i, 10, 1) + c7d9*tempb1
    fb(i, 11, 1) = fb(i, 11, 1) + c7d10*tempb1
    tempb1 = nx(i, j, 1)*fxroe1b
    tempb0 = ny(i, j, 1)*fxroe1b
    gb(i, j, 5) = gb(i, j, 5) + c1*tempb0
    gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb0
    gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb0
    gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb0
    gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb0
    gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb0
    gb(i+3, j, 5) = gb(i+3, j, 5) + c4*tempb0
    gb(i-4, j, 5) = gb(i-4, j, 5) + c4*tempb0
    gb(i+4, j, 5) = gb(i+4, j, 5) + c5*tempb0
    gb(i-5, j, 5) = gb(i-5, j, 5) + c5*tempb0
    fb(i, j, 5) = fb(i, j, 5) + c1*tempb1
    fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb1
    fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb1
    fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb1
    fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb1
    fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb1
    fb(i+3, j, 5) = fb(i+3, j, 5) + c4*tempb1
    fb(i-4, j, 5) = fb(i-4, j, 5) + c4*tempb1
    fb(i+4, j, 5) = fb(i+4, j, 5) + c5*tempb1
    fb(i-5, j, 5) = fb(i-5, j, 5) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrow1b
    tempb0 = ny(i, j, 1)*fxrow1b
    gb(i, j, 4) = gb(i, j, 4) + c1*tempb0
    gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb0
    gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb0
    gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb0
    gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb0
    gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb0
    gb(i+3, j, 4) = gb(i+3, j, 4) + c4*tempb0
    gb(i-4, j, 4) = gb(i-4, j, 4) + c4*tempb0
    gb(i+4, j, 4) = gb(i+4, j, 4) + c5*tempb0
    gb(i-5, j, 4) = gb(i-5, j, 4) + c5*tempb0
    fb(i, j, 4) = fb(i, j, 4) + c1*tempb1
    fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb1
    fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb1
    fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb1
    fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb1
    fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb1
    fb(i+3, j, 4) = fb(i+3, j, 4) + c4*tempb1
    fb(i-4, j, 4) = fb(i-4, j, 4) + c4*tempb1
    fb(i+4, j, 4) = fb(i+4, j, 4) + c5*tempb1
    fb(i-5, j, 4) = fb(i-5, j, 4) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrov1b
    tempb0 = ny(i, j, 1)*fxrov1b
    gb(i, j, 3) = gb(i, j, 3) + c1*tempb0
    gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb0
    gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb0
    gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb0
    gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb0
    gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb0
    gb(i+3, j, 3) = gb(i+3, j, 3) + c4*tempb0
    gb(i-4, j, 3) = gb(i-4, j, 3) + c4*tempb0
    gb(i+4, j, 3) = gb(i+4, j, 3) + c5*tempb0
    gb(i-5, j, 3) = gb(i-5, j, 3) + c5*tempb0
    fb(i, j, 3) = fb(i, j, 3) + c1*tempb1
    fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb1
    fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb1
    fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb1
    fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb1
    fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb1
    fb(i+3, j, 3) = fb(i+3, j, 3) + c4*tempb1
    fb(i-4, j, 3) = fb(i-4, j, 3) + c4*tempb1
    fb(i+4, j, 3) = fb(i+4, j, 3) + c5*tempb1
    fb(i-5, j, 3) = fb(i-5, j, 3) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrou1b
    tempb0 = ny(i, j, 1)*fxrou1b
    gb(i, j, 2) = gb(i, j, 2) + c1*tempb0
    gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb0
    gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb0
    gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb0
    gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb0
    gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb0
    gb(i+3, j, 2) = gb(i+3, j, 2) + c4*tempb0
    gb(i-4, j, 2) = gb(i-4, j, 2) + c4*tempb0
    gb(i+4, j, 2) = gb(i+4, j, 2) + c5*tempb0
    gb(i-5, j, 2) = gb(i-5, j, 2) + c5*tempb0
    fb(i, j, 2) = fb(i, j, 2) + c1*tempb1
    fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb1
    fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb1
    fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb1
    fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb1
    fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb1
    fb(i+3, j, 2) = fb(i+3, j, 2) + c4*tempb1
    fb(i-4, j, 2) = fb(i-4, j, 2) + c4*tempb1
    fb(i+4, j, 2) = fb(i+4, j, 2) + c5*tempb1
    fb(i-5, j, 2) = fb(i-5, j, 2) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxro1b
    tempb0 = ny(i, j, 1)*fxro1b
    gb(i, j, 1) = gb(i, j, 1) + c1*tempb0
    gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb0
    gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb0
    gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb0
    gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb0
    gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb0
    gb(i+3, j, 1) = gb(i+3, j, 1) + c4*tempb0
    gb(i-4, j, 1) = gb(i-4, j, 1) + c4*tempb0
    gb(i+4, j, 1) = gb(i+4, j, 1) + c5*tempb0
    gb(i-5, j, 1) = gb(i-5, j, 1) + c5*tempb0
    fb(i, j, 1) = fb(i, j, 1) + c1*tempb1
    fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb1
    fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb1
    fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb1
    fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb1
    fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb1
    fb(i+3, j, 1) = fb(i+3, j, 1) + c4*tempb1
    fb(i-4, j, 1) = fb(i-4, j, 1) + c4*tempb1
    fb(i+4, j, 1) = fb(i+4, j, 1) + c5*tempb1
    fb(i-5, j, 1) = fb(i-5, j, 1) + c5*tempb1
  END DO
  omrr = ad_save142
  ducros1 = ad_save143
  vy = ad_save144
  vort2 = ad_save145
  vx = ad_save146
  sq = ad_save147
  vv = ad_save148
  sn = ad_save149
  vr = ad_save150
  predrow2 = ad_save151
  predrow1 = ad_save152
  vl = ad_save153
  nxloc = ad_save154
  nyloc = ad_save155
  dxm2 = ad_save156
  uy = ad_save157
  predro2 = ad_save158
  dxm1 = ad_save159
  rr = ad_save160
  ux = ad_save161
  predro1 = ad_save162
  mmu = ad_save163
  uu = ad_save164
  lambda = ad_save165
  ur = ad_save166
  eps4 = ad_save167
  eps2 = ad_save168
  predrov2 = ad_save169
  predrov1 = ad_save170
  ul = ad_save171
  mach2 = ad_save172
  rhomr = ad_save173
  rspec = ad_save174
  v = ad_save175
  alpha = ad_save176
  ty = ad_save177
  u = ad_save178
  tx = ad_save179
  rhoml = ad_save180
  r = ad_save181
  predroe2 = ad_save182
  wy = ad_save183
  predroe1 = ad_save184
  wx = ad_save185
  ww = ad_save186
  predrou2 = ad_save187
  predrou1 = ad_save188
  j = 5
!$BWD-OF II-LOOP 
!DIR$ IVDEP
  DO i=1,im+1
    predro1 = -(d5*w(i-5, j, 1)) + d4*w(i-4, j, 1) - d3*w(i-3, j, 1) + &
&     d2*w(i-2, j, 1) - d1*w(i-1, j, 1) + d1*w(i, j, 1) - d2*w(i+1, j, 1&
&     ) + d3*w(i+2, j, 1) - d4*w(i+3, j, 1) + d5*w(i+4, j, 1)
    predrou1 = -(d5*w(i-5, j, 2)) + d4*w(i-4, j, 2) - d3*w(i-3, j, 2) + &
&     d2*w(i-2, j, 2) - d1*w(i-1, j, 2) + d1*w(i, j, 2) - d2*w(i+1, j, 2&
&     ) + d3*w(i+2, j, 2) - d4*w(i+3, j, 2) + d5*w(i+4, j, 2)
    predrov1 = -(d5*w(i-5, j, 3)) + d4*w(i-4, j, 3) - d3*w(i-3, j, 3) + &
&     d2*w(i-2, j, 3) - d1*w(i-1, j, 3) + d1*w(i, j, 3) - d2*w(i+1, j, 3&
&     ) + d3*w(i+2, j, 3) - d4*w(i+3, j, 3) + d5*w(i+4, j, 3)
    predrow1 = -(d5*w(i-5, j, 4)) + d4*w(i-4, j, 4) - d3*w(i-3, j, 4) + &
&     d2*w(i-2, j, 4) - d1*w(i-1, j, 4) + d1*w(i, j, 4) - d2*w(i+1, j, 4&
&     ) + d3*w(i+2, j, 4) - d4*w(i+3, j, 4) + d5*w(i+4, j, 4)
    predroe1 = -(d5*w(i-5, j, 5)) + d4*w(i-4, j, 5) - d3*w(i-3, j, 5) + &
&     d2*w(i-2, j, 5) - d1*w(i-1, j, 5) + d1*w(i, j, 5) - d2*w(i+1, j, 5&
&     ) + d3*w(i+2, j, 5) - d4*w(i+3, j, 5) + d5*w(i+4, j, 5)
    predro2 = -(d5*w(i, j-5, 1)) + d4*w(i, j-4, 1) - d3*w(i, j-3, 1) + &
&     d2*w(i, j-2, 1) - d1*w(i, j-1, 1) + d1*w(i, j, 1) - d2*w(i, j+1, 1&
&     ) + d3*w(i, j+2, 1) - d4*w(i, j+3, 1) + d5*w(i, j+4, 1)
    predrou2 = -(d5*w(i, j-5, 2)) + d4*w(i, j-4, 2) - d3*w(i, j-3, 2) + &
&     d2*w(i, j-2, 2) - d1*w(i, j-1, 2) + d1*w(i, j, 2) - d2*w(i, j+1, 2&
&     ) + d3*w(i, j+2, 2) - d4*w(i, j+3, 2) + d5*w(i, j+4, 2)
    predrov2 = -(d5*w(i, j-5, 3)) + d4*w(i, j-4, 3) - d3*w(i, j-3, 3) + &
&     d2*w(i, j-2, 3) - d1*w(i, j-1, 3) + d1*w(i, j, 3) - d2*w(i, j+1, 3&
&     ) + d3*w(i, j+2, 3) - d4*w(i, j+3, 3) + d5*w(i, j+4, 3)
    predrow2 = -(d5*w(i, j-5, 4)) + d4*w(i, j-4, 4) - d3*w(i, j-3, 4) + &
&     d2*w(i, j-2, 4) - d1*w(i, j-1, 4) + d1*w(i, j, 4) - d2*w(i, j+1, 4&
&     ) + d3*w(i, j+2, 4) - d4*w(i, j+3, 4) + d5*w(i, j+4, 4)
    predroe2 = -(d5*w(i, j-5, 5)) + d4*w(i, j-4, 5) - d3*w(i, j-3, 5) + &
&     d2*w(i, j-2, 5) - d1*w(i, j-1, 5) + d1*w(i, j, 5) - d2*w(i, j+1, 5&
&     ) + d3*w(i, j+2, 5) - d4*w(i, j+3, 5) + d5*w(i, j+4, 5)
! grad for viscous fluxes o4 - 5p
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccros = TWELFTH*0.0625d0
    volm1 = volf(i, j, 1)
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    val_n = twentyfourth*(-velx(i+1, j)+26.d0*velx(i, j)-velx(i-1, j))
    val_s = twentyfourth*(-velx(i, j)+26.d0*velx(i-1, j)-velx(i-2, j))
    val_e = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-1, j-2)+9.d0*velx(i, j&
&     -2)-velx(i+1, j-2))+7.d0*(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0&
&     *velx(i, j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j&
&     )+9.d0*velx(i, j)-velx(i+1, j))-(-velx(i-2, j+1)+9.d0*velx(i-1, j+&
&     1)+9.d0*velx(i, j+1)-velx(i+1, j+1)))
    val_o = ccross*(-(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0*velx(i, j&
&     -1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*&
&     velx(i, j)-velx(i+1, j))+7.d0*(-velx(i-2, j+1)+9.d0*velx(i-1, j+1)&
&     +9.d0*velx(i, j+1)-velx(i+1, j+1))-(-velx(i-2, j+2)+9.d0*velx(i-1&
&     , j+2)+9.d0*velx(i, j+2)-velx(i+1, j+2)))
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-vely(i+1, j)+26.d0*vely(i, j)-vely(i-1, j))
    val_s = twentyfourth*(-vely(i, j)+26.d0*vely(i-1, j)-vely(i-2, j))
    val_e = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-1, j-2)+9.d0*vely(i, j&
&     -2)-vely(i+1, j-2))+7.d0*(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0&
&     *vely(i, j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j&
&     )+9.d0*vely(i, j)-vely(i+1, j))-(-vely(i-2, j+1)+9.d0*vely(i-1, j+&
&     1)+9.d0*vely(i, j+1)-vely(i+1, j+1)))
    val_o = ccross*(-(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0*vely(i, j&
&     -1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*&
&     vely(i, j)-vely(i+1, j))+7.d0*(-vely(i-2, j+1)+9.d0*vely(i-1, j+1)&
&     +9.d0*vely(i, j+1)-vely(i+1, j+1))-(-vely(i-2, j+2)+9.d0*vely(i-1&
&     , j+2)+9.d0*vely(i, j+2)-vely(i+1, j+2)))
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-velz(i+1, j)+26.d0*velz(i, j)-velz(i-1, j))
    val_s = twentyfourth*(-velz(i, j)+26.d0*velz(i-1, j)-velz(i-2, j))
    val_e = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-1, j-2)+9.d0*velz(i, j&
&     -2)-velz(i+1, j-2))+7.d0*(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0&
&     *velz(i, j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j&
&     )+9.d0*velz(i, j)-velz(i+1, j))-(-velz(i-2, j+1)+9.d0*velz(i-1, j+&
&     1)+9.d0*velz(i, j+1)-velz(i+1, j+1)))
    val_o = ccross*(-(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0*velz(i, j&
&     -1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*&
&     velz(i, j)-velz(i+1, j))+7.d0*(-velz(i-2, j+1)+9.d0*velz(i-1, j+1)&
&     +9.d0*velz(i, j+1)-velz(i+1, j+1))-(-velz(i-2, j+2)+9.d0*velz(i-1&
&     , j+2)+9.d0*velz(i, j+2)-velz(i+1, j+2)))
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = twentyfourth*(-tloc(i+1, j)+26.d0*tloc(i, j)-tloc(i-1, j))
    val_s = twentyfourth*(-tloc(i, j)+26.d0*tloc(i-1, j)-tloc(i-2, j))
    val_e = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-1, j-2)+9.d0*tloc(i, j&
&     -2)-tloc(i+1, j-2))+7.d0*(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0&
&     *tloc(i, j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j&
&     )+9.d0*tloc(i, j)-tloc(i+1, j))-(-tloc(i-2, j+1)+9.d0*tloc(i-1, j+&
&     1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1)))
    val_o = ccross*(-(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i, j&
&     -1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j)+9.d0*&
&     tloc(i, j)-tloc(i+1, j))+7.d0*(-tloc(i-2, j+1)+9.d0*tloc(i-1, j+1)&
&     +9.d0*tloc(i, j+1)-tloc(i+1, j+1))-(-tloc(i-2, j+2)+9.d0*tloc(i-1&
&     , j+2)+9.d0*tloc(i, j+2)-tloc(i+1, j+2)))
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
    uu = 0.0625d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*velx(i, j)-velx(&
&     i+1, j))
    vv = 0.0625d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*vely(i, j)-vely(&
&     i+1, j))
    ww = 0.0625d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*velz(i, j)-velz(&
&     i+1, j))
!
    mmu = 0.0625d0*(-mu(i-2, j)+9.d0*mu(i-1, j)+9.d0*mu(i, j)-mu(i+1, j)&
&     )
    lambda = mmu*cpprandtl
!
    fvrou1 = twothird*mmu*(two*ux-vy)
    fvrov1 = mmu*(uy+vx)
    fvrow1 = mmu*wx
! fvroe1 = (lambda*tx + uu*fvrou1 + vv*fvrov1)
!
    gvrou1 = mmu*(uy+vx)
    gvrov1 = twothird*mmu*(-ux+two*vy)
    gvrow1 = mmu*wy
! gvroe1 = (lambda*ty + uu*gvrou1 + vv*gvrov1)
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! grad for viscous fluxes o4 - 5p
!
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccross = TWELFTH*0.0625d0
    volm1 = volf(i, j, 2)
    nx_n = half*(nx(i+1, j-1, 1)+nx(i+1, j, 1))
    nx_s = -(half*(nx(i, j-1, 1)+nx(i, j, 1)))
    nx_o = half*(nx(i, j+1, 2)+nx(i, j, 2))
    nx_e = -(half*(nx(i, j-1, 2)+nx(i, j, 2)))
!
    ny_n = half*(ny(i+1, j-1, 1)+ny(i+1, j, 1))
    ny_s = -(half*(ny(i, j-1, 1)+ny(i, j, 1)))
    ny_o = half*(ny(i, j+1, 2)+ny(i, j, 2))
    ny_e = -(half*(ny(i, j-1, 2)+ny(i, j, 2)))
    val_n = ccross*(-(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+9.d0*velx(i-1&
&     , j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*&
&     velx(i, j)-velx(i, j+1))+7.d0*(-velx(i+1, j-2)+9.d0*velx(i+1, j-1)&
&     +9.d0*velx(i+1, j)-velx(i+1, j+1))-(-velx(i+2, j-2)+9.d0*velx(i+2&
&     , j-1)+9.d0*velx(i+2, j)-velx(i+2, j+1)))
    val_s = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-2, j-1)+9.d0*velx(i-2&
&     , j)-velx(i-2, j+1))+7.d0*(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+&
&     9.d0*velx(i-1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i&
&     , j-1)+9.d0*velx(i, j)-velx(i, j+1))-(-velx(i+1, j-2)+9.d0*velx(i+&
&     1, j-1)+9.d0*velx(i+1, j)-velx(i+1, j+1)))
    val_e = twentyfourth*(-velx(i, j)+26.d0*velx(i, j-1)-velx(i, j-2))
    val_o = twentyfourth*(-velx(i, j+1)+26.d0*velx(i, j)-velx(i, j-1))
    ad_save31 = ux
    ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save32 = uy
    uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+9.d0*vely(i-1&
&     , j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*&
&     vely(i, j)-vely(i, j+1))+7.d0*(-vely(i+1, j-2)+9.d0*vely(i+1, j-1)&
&     +9.d0*vely(i+1, j)-vely(i+1, j+1))-(-vely(i+2, j-2)+9.d0*vely(i+2&
&     , j-1)+9.d0*vely(i+2, j)-vely(i+2, j+1)))
    val_s = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-2, j-1)+9.d0*vely(i-2&
&     , j)-vely(i-2, j+1))+7.d0*(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+&
&     9.d0*vely(i-1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i&
&     , j-1)+9.d0*vely(i, j)-vely(i, j+1))-(-vely(i+1, j-2)+9.d0*vely(i+&
&     1, j-1)+9.d0*vely(i+1, j)-vely(i+1, j+1)))
    val_e = twentyfourth*(-vely(i, j)+26.d0*vely(i, j-1)-vely(i, j-2))
    val_o = twentyfourth*(-vely(i, j+1)+26.d0*vely(i, j)-vely(i, j-1))
    ad_save33 = vx
    vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save34 = vy
    vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+9.d0*velz(i-1&
&     , j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*&
&     velz(i, j)-velz(i, j+1))+7.d0*(-velz(i+1, j-2)+9.d0*velz(i+1, j-1)&
&     +9.d0*velz(i+1, j)-velz(i+1, j+1))-(-velz(i+2, j-2)+9.d0*velz(i+2&
&     , j-1)+9.d0*velz(i+2, j)-velz(i+2, j+1)))
    val_s = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-2, j-1)+9.d0*velz(i-2&
&     , j)-velz(i-2, j+1))+7.d0*(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+&
&     9.d0*velz(i-1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i&
&     , j-1)+9.d0*velz(i, j)-velz(i, j+1))-(-velz(i+1, j-2)+9.d0*velz(i+&
&     1, j-1)+9.d0*velz(i+1, j)-velz(i+1, j+1)))
    val_e = twentyfourth*(-velz(i, j)+26.d0*velz(i, j-1)-velz(i, j-2))
    val_o = twentyfourth*(-velz(i, j+1)+26.d0*velz(i, j)-velz(i, j-1))
    ad_save35 = wx
    wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save36 = wy
    wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    val_n = ccross*(-(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i-1&
&     , j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i, j-1)+9.d0*&
&     tloc(i, j)-tloc(i, j+1))+7.d0*(-tloc(i+1, j-2)+9.d0*tloc(i+1, j-1)&
&     +9.d0*tloc(i+1, j)-tloc(i+1, j+1))-(-tloc(i+2, j-2)+9.d0*tloc(i+2&
&     , j-1)+9.d0*tloc(i+2, j)-tloc(i+2, j+1)))
    val_s = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-2, j-1)+9.d0*tloc(i-2&
&     , j)-tloc(i-2, j+1))+7.d0*(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+&
&     9.d0*tloc(i-1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i&
&     , j-1)+9.d0*tloc(i, j)-tloc(i, j+1))-(-tloc(i+1, j-2)+9.d0*tloc(i+&
&     1, j-1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1)))
    val_e = twentyfourth*(-tloc(i, j)+26.d0*tloc(i, j-1)-tloc(i, j-2))
    val_o = twentyfourth*(-tloc(i, j+1)+26.d0*tloc(i, j)-tloc(i, j-1))
    ad_save37 = tx
    tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
    ad_save38 = ty
    ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
    ad_save39 = uu
    uu = 0.0625d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*velx(i, j)-velx(&
&     i, j+1))
    ad_save40 = vv
    vv = 0.0625d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*vely(i, j)-vely(&
&     i, j+1))
    ad_save41 = ww
    ww = 0.0625d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*velz(i, j)-velz(&
&     i, j+1))
!
    ad_save42 = mmu
    mmu = 0.0625d0*(-mu(i, j-2)+9.d0*mu(i, j-1)+9.d0*mu(i, j)-mu(i, j+1)&
&     )
    ad_save43 = lambda
    lambda = mmu*cpprandtl
!
    fvrou2 = twothird*mmu*(two*ux-vy)
    fvrov2 = mmu*(uy+vx)
    fvrow2 = mmu*wx
! fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2)
    gvrou2 = mmu*(uy+vx)
    gvrov2 = twothird*mmu*(-ux+two*vy)
    gvrow2 = mmu*wy
! gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2)
!!  fvrou2 = TWOTHIRD*mmu*( TWO*ux -     vy  -  wz  )
!!  fvrov2 =          mmu*(     uy +     vx         )
!!  fvrow2 =          mmu*(     uz           +  wx  )
!!  fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2 + ww * fvrow2)
!!
!!  gvrou2 =          mmu*(     uy +     vx       )
!!  gvrov2 = TWOTHIRD*mmu*(    -ux + TWO*vy -  wz )
!!  gvrow2 =          mmu*(              vz +  wy )
!!  gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2 + ww*gvrow2)
! #include "rhs/spectralradius_i.F"
! correction Rossow JCP 2000
!1st direction
    rhomr = w(i, j, 1)
    ur = w(i, j, 2)/rhomr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i-1, j, 1)
    ul = w(i-1, j, 2)/rhoml
    vl = w(i-1, j, 3)/rhoml
    c2l = gam*rgaz*tloc(i-1, j)
!
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    u = ul*rr + ur*omrr
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_branch15 = 0
      mach2 = one
    ELSE
      mach2 = vn2/c2x
      ad_branch15 = 1
    END IF
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    x3 = nx(i, j, 1)*u + ny(i, j, 1)*v
    IF (x3 .GE. 0.) THEN
      ab = x3
      ad_branch16 = 0
    ELSE
      ab = -x3
      ad_branch16 = 1
    END IF
    sq = SQRT(cprim*nx2)
!
    rspec = ab + sq
    IF (p(i-1, j) - two*p(i, j) + p(i+1, j) .GE. 0.) THEN
      abs4 = p(i-1, j) - two*p(i, j) + p(i+1, j)
      ad_branch17 = 1
    ELSE
      abs4 = -(p(i-1, j)-two*p(i, j)+p(i+1, j))
      ad_branch17 = 0
    END IF
    x16 = p(i-1, j) + two*p(i, j) + p(i+1, j)
    IF (x16 .GE. 0.) THEN
      abs26 = x16
      ad_branch18 = 0
    ELSE
      abs26 = -x16
      ad_branch18 = 1
    END IF
!
!1st direction
    k_sensor1 = abs4/abs26
    IF (p(i-2, j) - two*p(i-1, j) + p(i, j) .GE. 0.) THEN
      abs5 = p(i-2, j) - two*p(i-1, j) + p(i, j)
      ad_branch19 = 1
    ELSE
      abs5 = -(p(i-2, j)-two*p(i-1, j)+p(i, j))
      ad_branch19 = 0
    END IF
    x17 = p(i-2, j) + two*p(i-1, j) + p(i, j)
    IF (x17 .GE. 0.) THEN
      abs27 = x17
      ad_branch20 = 0
    ELSE
      abs27 = -x17
      ad_branch20 = 1
    END IF
    k_sensor2 = abs5/abs27
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    divu2 = divu*divu
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    ducros1 = divu2/(divu2+vort2+1d-15)
    dxm1 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    ad_save44 = divu2
    divu2 = divu*divu
    vort2 = (gradv(i-1, j, 1)-gradu(i-1, j, 2))*(gradv(i-1, j, 1)-gradu(&
&     i-1, j, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch21 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch21 = 1
    END IF
!     ! extension of shock capturing
!
!    k_sensor1 = ABS(p(i,j) - TWO*p(i+1,j) + p(i+2,j)) / &
!                ABS(p(i,j) + TWO*p(i+1,j) + p(i+2,j))
!
!    k_sensor2 = ABS(p(i-3,j) - TWO*p(i-2,j) + p(i-1,j)) / &
!                ABS(p(i-3,j) + TWO*p(i-2,j) + p(i-1,j))
!
!    divu2     = (gradu(i+1,j,1)+gradv(i+1,j,2)) * (gradu(i+1,j,1)+gradv(i+1,j,2))
!    vort2     = (gradv(i+1,j,1)-gradu(i+1,j,2)) * (gradv(i+1,j,1)-gradu(i+1,j,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i-2,j,1)+gradv(i-2,j,2)) * (gradu(i-2,j,1)+gradv(i-2,j,2))
!    vort2     = (gradv(i-2,j,1)-gradu(i-2,j,2)) * (gradv(i-2,j,1)-gradu(i-2,j,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                      k_sensor2*ducros2, coef)
!
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      eps4 = k4 - 12.d0*eps2
      ad_branch22 = 0
    ELSE
      ad_branch22 = 1
      eps4 = zero
    END IF
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_diri.F"
!     endif
! #include "rhs/spectralradius_j.F"
! correction Rossow JCP 2000
!2st direction
    rhomr = w(i, j, 1)
    ad_save45 = ur
    ur = w(i, j, 2)/rhomr
    ad_save46 = vr
    vr = w(i, j, 3)/rhomr
    c2r = gam*rgaz*tloc(i, j)
!
    rhoml = w(i, j-1, 1)
    ul = w(i, j-1, 2)/rhoml
    vl = w(i, j-1, 3)/rhoml
    c2l = gam*rgaz*tloc(i, j-1)
!
    ad_save47 = r
    r = SQRT(rhomr/rhoml)
    rr = one/(one+r)
    omrr = one - rr
!
    ad_save48 = u
    u = ul*rr + ur*omrr
    ad_save49 = v
    v = vl*rr + vr*omrr
!
    c2x = c2l*rr + c2r*omrr
    nx2 = nx(i, j, 2)*nx(i, j, 2) + ny(i, j, 2)*ny(i, j, 2)
    vn2 = u*u + v*v
    IF (vn2/c2x .GT. one) THEN
      ad_save50 = mach2
      mach2 = one
      ad_branch23 = 0
    ELSE
      ad_save51 = mach2
      mach2 = vn2/c2x
      ad_branch23 = 1
    END IF
    ad_save52 = alpha
    alpha = half*(one-mach2)
    cprim = alpha*alpha*vn2 + mach2*c2x
    x4 = nx(i, j, 2)*u + ny(i, j, 2)*v
    IF (x4 .GE. 0.) THEN
      ab = x4
      ad_branch24 = 0
    ELSE
      ab = -x4
      ad_branch24 = 1
    END IF
    ad_save53 = sq
    sq = SQRT(cprim*nx2)
!
    ad_save54 = rspec
    rspec = ab + sq
    IF (p(i, j-1) - two*p(i, j) + p(i, j+1) .GE. 0.) THEN
      abs6 = p(i, j-1) - two*p(i, j) + p(i, j+1)
      ad_branch25 = 1
    ELSE
      abs6 = -(p(i, j-1)-two*p(i, j)+p(i, j+1))
      ad_branch25 = 0
    END IF
    x18 = p(i, j-1) + two*p(i, j) + p(i, j+1)
    IF (x18 .GE. 0.) THEN
      abs28 = x18
      ad_branch26 = 0
    ELSE
      abs28 = -x18
      ad_branch26 = 1
    END IF
!
! 2nd direction
    k_sensor1 = abs6/abs28
    IF (p(i, j-2) - two*p(i, j-1) + p(i, j) .GE. 0.) THEN
      abs7 = p(i, j-2) - two*p(i, j-1) + p(i, j)
      ad_branch27 = 1
    ELSE
      abs7 = -(p(i, j-2)-two*p(i, j-1)+p(i, j))
      ad_branch27 = 0
    END IF
    x19 = p(i, j-2) + two*p(i, j-1) + p(i, j)
    IF (x19 .GE. 0.) THEN
      abs29 = x19
      ad_branch28 = 0
    ELSE
      abs29 = -x19
      ad_branch28 = 1
    END IF
    k_sensor2 = abs7/abs29
!     ducros1 is done in dissipation_ducros_x
    divu = gradu(i, j-1, 1) + gradv(i, j-1, 2)
    divu2 = divu*divu
    ad_save55 = vort2
    vort2 = (gradv(i, j-1, 1)-gradu(i, j-1, 2))*(gradv(i, j-1, 1)-gradu(&
&     i, j-1, 2))
    ducros2 = divu2/(divu2+vort2+1d-15)
!sq = sound/dx
    ad_save56 = dxm2
    dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
    IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
      coef = k_sensor2*ducros2*dxm2
      ad_branch29 = 0
    ELSE
      coef = k_sensor1*ducros1*dxm1
      ad_branch29 = 1
    END IF
! extension of shock capturing
!    k_sensor1 = ABS(p(i,j) - TWO*p(i,j+1) + p(i,j+2)) / &
!                ABS(p(i,j) + TWO*p(i,j+1) + p(i,j+2))
!
!    k_sensor2 = ABS(p(i,j-3) - TWO*p(i,j-2) + p(i,j-1)) / &
!                ABS(p(i,j-3) + TWO*p(i,j-2) + p(i,j-1))
!
!    divu2     = (gradu(i,j+1,1)+gradv(i,j+1,2)) * (gradu(i,j+1,1)+gradv(i,j+1,2))
!    vort2     = (gradv(i,j+1,1)-gradu(i,j+1,2)) * (gradv(i,j+1,1)-gradu(i,j+1,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i,j-2,1)+gradv(i,j-2,2)) * (gradu(i,j-2,1)+gradv(i,j-2,2))
!    vort2     = (gradv(i,j-2,1)-gradu(i,j-2,2)) * (gradv(i,j-2,1)-gradu(i,j-2,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                     k_sensor2*ducros2, coef)
    ad_save57 = eps2
    eps2 = k2*coef
    IF (zero .LT. k4 - 12.d0*eps2) THEN
      ad_save58 = eps4
      eps4 = k4 - 12.d0*eps2
      ad_branch30 = 0
    ELSE
      ad_save59 = eps4
      eps4 = zero
      ad_branch30 = 1
    END IF
    diffro = half*(w(i, j, 1)-w(i, j-1, 1))
    diffrou = half*(w(i, j, 2)-w(i, j-1, 2))
    diffrov = half*(w(i, j, 3)-w(i, j-1, 3))
    diffrow = half*(w(i, j, 4)-w(i, j-1, 4))
    diffroe = half*(w(i, j, 5)-w(i, j-1, 5))
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_dirj.F"
!     endif
!
    sc1 = nx(i, j, 1)
    sc2 = ny(i, j, 1)
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    nxloc = sc1*invsn
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
    sc1 = nx(i, j, 2)
    sc2 = ny(i, j, 2)
    ad_save60 = sn
    sn = SQRT(sc1*sc1 + sc2*sc2)
    invsn = one/sn
    ad_save61 = nxloc
    nxloc = sc1*invsn
    ad_save62 = nyloc
    nyloc = sc2*invsn
!
!
!
! hn(i,j,4,2) = ZERO
!
    fxroe2b = hnb(i, j, 5, 2)
    dissroe2b = -hnb(i, j, 5, 2)
    fvroe2b = -(nxloc*sn*hnb(i, j, 5, 2))
    gvroe2b = -(nyloc*sn*hnb(i, j, 5, 2))
    hnb(i, j, 5, 2) = 0.0_8
    fxrow2b = hnb(i, j, 4, 2)
    dissrow2b = -hnb(i, j, 4, 2)
    fvrow2b = -(nxloc*sn*hnb(i, j, 4, 2))
    gvrow2b = -(nyloc*sn*hnb(i, j, 4, 2))
    hnb(i, j, 4, 2) = 0.0_8
    fxrov2b = hnb(i, j, 3, 2)
    dissrov2b = -hnb(i, j, 3, 2)
    fvrov2b = -(nxloc*sn*hnb(i, j, 3, 2))
    gvrov2b = -(nyloc*sn*hnb(i, j, 3, 2))
    hnb(i, j, 3, 2) = 0.0_8
    fxrou2b = hnb(i, j, 2, 2)
    dissrou2b = -hnb(i, j, 2, 2)
    fvrou2b = -(nxloc*sn*hnb(i, j, 2, 2))
    gvrou2b = -(nyloc*sn*hnb(i, j, 2, 2))
    hnb(i, j, 2, 2) = 0.0_8
    fxro2b = hnb(i, j, 1, 2)
    dissro2b = -hnb(i, j, 1, 2)
    hnb(i, j, 1, 2) = 0.0_8
    nyloc = ad_save62
    nxloc = ad_save61
    sn = ad_save60
    fxroe1b = hnb(i, j, 5, 1)
    dissroe1b = -hnb(i, j, 5, 1)
    fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
    gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
    hnb(i, j, 5, 1) = 0.0_8
    fxrow1b = hnb(i, j, 4, 1)
    dissrow1b = -hnb(i, j, 4, 1)
    fvrow1b = -(nxloc*sn*hnb(i, j, 4, 1))
    gvrow1b = -(nyloc*sn*hnb(i, j, 4, 1))
    hnb(i, j, 4, 1) = 0.0_8
    fxrov1b = hnb(i, j, 3, 1)
    dissrov1b = -hnb(i, j, 3, 1)
    fvrov1b = -(nxloc*sn*hnb(i, j, 3, 1))
    gvrov1b = -(nyloc*sn*hnb(i, j, 3, 1))
    hnb(i, j, 3, 1) = 0.0_8
    fxrou1b = hnb(i, j, 2, 1)
    dissrou1b = -hnb(i, j, 2, 1)
    fvrou1b = -(nxloc*sn*hnb(i, j, 2, 1))
    gvrou1b = -(nyloc*sn*hnb(i, j, 2, 1))
    hnb(i, j, 2, 1) = 0.0_8
    fxro1b = hnb(i, j, 1, 1)
    dissro1b = -hnb(i, j, 1, 1)
    hnb(i, j, 1, 1) = 0.0_8
    rspecb = (eps2*diffroe+eps4*predroe2)*dissroe2b + (eps2*diffrow+eps4&
&     *predrow2)*dissrow2b + (eps2*diffrov+eps4*predrov2)*dissrov2b + (&
&     eps2*diffrou+eps4*predrou2)*dissrou2b + (eps2*diffro+eps4*predro2)&
&     *dissro2b
    tempb1 = rspec*dissroe2b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe2*tempb1
    predroe2b = eps4*tempb1
    tempb1 = rspec*dissrow2b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow2*tempb1
    predrow2b = eps4*tempb1
    tempb1 = rspec*dissrov2b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    eps4b = eps4b + predrov2*tempb1
    predrov2b = eps4*tempb1
    tempb1 = rspec*dissrou2b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    eps4b = eps4b + predrou2*tempb1
    predrou2b = eps4*tempb1
    tempb1 = rspec*dissro2b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    eps4b = eps4b + predro2*tempb1
    predro2b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i, j-1, 5) = wb(i, j-1, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i, j-1, 4) = wb(i, j-1, 4) - half*diffrowb
    wb(i, j, 3) = wb(i, j, 3) + half*diffrovb
    wb(i, j-1, 3) = wb(i, j-1, 3) - half*diffrovb
    wb(i, j, 2) = wb(i, j, 2) + half*diffroub
    wb(i, j-1, 2) = wb(i, j-1, 2) - half*diffroub
    wb(i, j, 1) = wb(i, j, 1) + half*diffrob
    wb(i, j-1, 1) = wb(i, j-1, 1) - half*diffrob
    IF (ad_branch30 .EQ. 0) THEN
      eps4 = ad_save58
      eps2b = eps2b - 12.d0*eps4b
    ELSE
      eps4 = ad_save59
    END IF
    eps2 = ad_save57
    coefb = k2*eps2b
    IF (ad_branch29 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      dxm1b = 0.0_8
      k_sensor1b = 0.0_8
      ducros1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = k_sensor1*dxm1*coefb
      dxm1b = k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    dxm2 = ad_save56
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    vort2 = ad_save55
    tempb1 = 2*(gradv(i, j-1, 1)-gradu(i, j-1, 2))*vort2b
    gradvb(i, j-1, 1) = gradvb(i, j-1, 1) + tempb1
    gradub(i, j-1, 2) = gradub(i, j-1, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j-1, 1) = gradub(i, j-1, 1) + divub
    gradvb(i, j-1, 2) = gradvb(i, j-1, 2) + divub
    abs7b = k_sensor2b/abs29
    abs29b = -(abs7*k_sensor2b/abs29**2)
    IF (ad_branch28 .EQ. 0) THEN
      x19b = abs29b
    ELSE
      x19b = -abs29b
    END IF
    pb(i, j-2) = pb(i, j-2) + x19b
    pb(i, j-1) = pb(i, j-1) + two*x19b
    pb(i, j) = pb(i, j) + x19b
    IF (ad_branch27 .EQ. 0) THEN
      pb(i, j-1) = pb(i, j-1) + two*abs7b
      pb(i, j-2) = pb(i, j-2) - abs7b
      pb(i, j) = pb(i, j) - abs7b
    ELSE
      pb(i, j-2) = pb(i, j-2) + abs7b
      pb(i, j-1) = pb(i, j-1) - two*abs7b
      pb(i, j) = pb(i, j) + abs7b
    END IF
    abs6b = k_sensor1b/abs28
    abs28b = -(abs6*k_sensor1b/abs28**2)
    IF (ad_branch26 .EQ. 0) THEN
      x18b = abs28b
    ELSE
      x18b = -abs28b
    END IF
    pb(i, j-1) = pb(i, j-1) + x18b
    pb(i, j) = pb(i, j) + two*x18b
    pb(i, j+1) = pb(i, j+1) + x18b
    IF (ad_branch25 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs6b
      pb(i, j-1) = pb(i, j-1) - abs6b
      pb(i, j+1) = pb(i, j+1) - abs6b
    ELSE
      pb(i, j-1) = pb(i, j-1) + abs6b
      pb(i, j) = pb(i, j) - two*abs6b
      pb(i, j+1) = pb(i, j+1) + abs6b
    END IF
    rspec = ad_save54
    abb = rspecb
    sqb = sqb + rspecb
    sq = ad_save53
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch24 .EQ. 0) THEN
      x4b = abb
    ELSE
      x4b = -abb
    END IF
    ub = nx(i, j, 2)*x4b
    vb = ny(i, j, 2)*x4b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    alpha = ad_save52
    IF (ad_branch23 .EQ. 0) THEN
      mach2 = ad_save50
    ELSE
      mach2 = ad_save51
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    diffro = half*(w(i, j, 1)-w(i-1, j, 1))
    diffrou = half*(w(i, j, 2)-w(i-1, j, 2))
    diffrov = half*(w(i, j, 3)-w(i-1, j, 3))
    diffrow = half*(w(i, j, 4)-w(i-1, j, 4))
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    v = ad_save49
    vlb = rr*vb
    vrb = omrr*vb
    u = ad_save48
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    r = ad_save47
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i, j-1, 3)*vlb/rhoml**2 - w(i, j-&
&     1, 2)*ulb/rhoml**2
    tlocb(i, j-1) = tlocb(i, j-1) + gam*rgaz*c2lb
    wb(i, j-1, 3) = wb(i, j-1, 3) + vlb/rhoml
    wb(i, j-1, 2) = wb(i, j-1, 2) + ulb/rhoml
    wb(i, j-1, 1) = wb(i, j-1, 1) + rhomlb
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb
    rhoml = w(i-1, j, 1)
    rr = one/(one+r)
    vl = w(i-1, j, 3)/rhoml
    omrr = one - rr
    vr = ad_save46
    ul = w(i-1, j, 2)/rhoml
    ur = ad_save45
    diffroe = half*(w(i, j, 5)-w(i-1, j, 5))
    rspecb = (eps2*diffroe+eps4*predroe1)*dissroe1b + (eps2*diffrow+eps4&
&     *predrow1)*dissrow1b + (eps2*diffrov+eps4*predrov1)*dissrov1b + (&
&     eps2*diffrou+eps4*predrou1)*dissrou1b + (eps2*diffro+eps4*predro1)&
&     *dissro1b
    tempb1 = rspec*dissroe1b
    eps2b = diffroe*tempb1
    diffroeb = eps2*tempb1
    eps4b = predroe1*tempb1
    predroe1b = eps4*tempb1
    tempb1 = rspec*dissrow1b
    eps2b = eps2b + diffrow*tempb1
    diffrowb = eps2*tempb1
    eps4b = eps4b + predrow1*tempb1
    predrow1b = eps4*tempb1
    tempb1 = rspec*dissrov1b
    eps2b = eps2b + diffrov*tempb1
    diffrovb = eps2*tempb1
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + half*diffrovb
    eps4b = eps4b + predrov1*tempb1
    predrov1b = eps4*tempb1
    tempb1 = rspec*dissrou1b
    eps2b = eps2b + diffrou*tempb1
    diffroub = eps2*tempb1
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + half*diffroub
    rhomr = w(i, j, 1)
    eps4b = eps4b + predrou1*tempb1
    predrou1b = eps4*tempb1
    tempb1 = rspec*dissro1b
    eps2b = eps2b + diffro*tempb1
    diffrob = eps2*tempb1
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + half*diffrob
    eps4b = eps4b + predro1*tempb1
    predro1b = eps4*tempb1
    wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
    wb(i-1, j, 5) = wb(i-1, j, 5) - half*diffroeb
    wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
    wb(i-1, j, 4) = wb(i-1, j, 4) - half*diffrowb
    wb(i-1, j, 3) = wb(i-1, j, 3) - half*diffrovb
    wb(i-1, j, 2) = wb(i-1, j, 2) - half*diffroub
    wb(i-1, j, 1) = wb(i-1, j, 1) - half*diffrob
    IF (ad_branch22 .EQ. 0) eps2b = eps2b - 12.d0*eps4b
    coefb = k2*eps2b
    divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
    divu2 = divu*divu
    k_sensor1 = abs4/abs26
    k_sensor2 = abs5/abs27
    ducros2 = divu2/(divu2+vort2+1d-15)
    IF (ad_branch21 .EQ. 0) THEN
      k_sensor2b = ducros2*dxm2*coefb
      ducros2b = k_sensor2*dxm2*coefb
      dxm2b = k_sensor2*ducros2*coefb
      k_sensor1b = 0.0_8
    ELSE
      k_sensor1b = ducros1*dxm1*coefb
      ducros1b = ducros1b + k_sensor1*dxm1*coefb
      dxm1b = dxm1b + k_sensor1*ducros1*coefb
      dxm2b = 0.0_8
      k_sensor2b = 0.0_8
      ducros2b = 0.0_8
    END IF
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = -(temp1*tempb1)
    tempb1 = ducros2b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i-1, j, 1)-gradu(i-1, j, 2))*vort2b
    gradvb(i-1, j, 1) = gradvb(i-1, j, 1) + tempb1
    gradub(i-1, j, 2) = gradub(i-1, j, 2) - tempb1
    vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j, &
&     2))
    divu2 = ad_save44
    divub = divub + 2*divu*divu2b
    gradub(i-1, j, 1) = gradub(i-1, j, 1) + divub
    gradvb(i-1, j, 2) = gradvb(i-1, j, 2) + divub
    divu = gradu(i, j, 1) + gradv(i, j, 2)
    temp1 = divu/(sq+1d-15)
    temp0 = 10.d0*vol(i, j)
    tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm1b/(sq+&
&     1d-15))
    divub = tempb1
    sqb = sqb - temp1*tempb1
    tempb1 = ducros1b/(divu2+vort2+1d-15)
    tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
    divu2b = tempb1 + tempb0
    vort2b = tempb0
    tempb1 = 2*(gradv(i, j, 1)-gradu(i, j, 2))*vort2b
    gradvb(i, j, 1) = gradvb(i, j, 1) + tempb1
    gradub(i, j, 2) = gradub(i, j, 2) - tempb1
    divub = divub + 2*divu*divu2b
    gradub(i, j, 1) = gradub(i, j, 1) + divub
    gradvb(i, j, 2) = gradvb(i, j, 2) + divub
    abs5b = k_sensor2b/abs27
    abs27b = -(abs5*k_sensor2b/abs27**2)
    IF (ad_branch20 .EQ. 0) THEN
      x17b = abs27b
    ELSE
      x17b = -abs27b
    END IF
    pb(i-2, j) = pb(i-2, j) + x17b
    pb(i-1, j) = pb(i-1, j) + two*x17b
    pb(i, j) = pb(i, j) + x17b
    IF (ad_branch19 .EQ. 0) THEN
      pb(i-1, j) = pb(i-1, j) + two*abs5b
      pb(i-2, j) = pb(i-2, j) - abs5b
      pb(i, j) = pb(i, j) - abs5b
    ELSE
      pb(i-2, j) = pb(i-2, j) + abs5b
      pb(i-1, j) = pb(i-1, j) - two*abs5b
      pb(i, j) = pb(i, j) + abs5b
    END IF
    abs4b = k_sensor1b/abs26
    abs26b = -(abs4*k_sensor1b/abs26**2)
    IF (ad_branch18 .EQ. 0) THEN
      x16b = abs26b
    ELSE
      x16b = -abs26b
    END IF
    pb(i-1, j) = pb(i-1, j) + x16b
    pb(i, j) = pb(i, j) + two*x16b
    pb(i+1, j) = pb(i+1, j) + x16b
    IF (ad_branch17 .EQ. 0) THEN
      pb(i, j) = pb(i, j) + two*abs4b
      pb(i-1, j) = pb(i-1, j) - abs4b
      pb(i+1, j) = pb(i+1, j) - abs4b
    ELSE
      pb(i-1, j) = pb(i-1, j) + abs4b
      pb(i, j) = pb(i, j) - two*abs4b
      pb(i+1, j) = pb(i+1, j) + abs4b
    END IF
    abb = rspecb
    sqb = sqb + rspecb
    c2r = gam*rgaz*tloc(i, j)
    c2l = gam*rgaz*tloc(i-1, j)
    c2x = c2l*rr + c2r*omrr
    vn2 = u*u + v*v
    nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
    cprim = alpha*alpha*vn2 + mach2*c2x
    IF (nx2*cprim .EQ. 0.0) THEN
      cprimb = 0.0_8
    ELSE
      cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
    END IF
    IF (ad_branch16 .EQ. 0) THEN
      x3b = abb
    ELSE
      x3b = -abb
    END IF
    ub = nx(i, j, 1)*x3b
    vb = ny(i, j, 1)*x3b
    alphab = 2*alpha*vn2*cprimb
    vn2b = alpha**2*cprimb
    mach2b = c2x*cprimb - half*alphab
    c2xb = mach2*cprimb
    IF (ad_branch15 .NE. 0) THEN
      vn2b = vn2b + mach2b/c2x
      c2xb = c2xb - vn2*mach2b/c2x**2
    END IF
    fvrov2b = fvrov2b + vv*fvroe2b
    ub = ub + 2*u*vn2b
    vb = vb + 2*v*vn2b
    c2lb = rr*c2xb
    c2rb = omrr*c2xb
    omrrb = c2r*c2xb + vr*vb + ur*ub
    rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
    vlb = rr*vb
    vrb = omrr*vb
    ulb = rr*ub
    urb = omrr*ub
    rb = -(one*rrb/(one+r)**2)
    IF (rhomr/rhoml .EQ. 0.0) THEN
      tempb1 = 0.0_8
    ELSE
      tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
    END IF
    rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**2
    rhomlb = -(rhomr*tempb1/rhoml) - w(i-1, j, 3)*vlb/rhoml**2 - w(i-1, &
&     j, 2)*ulb/rhoml**2
    wb(i-1, j, 3) = wb(i-1, j, 3) + vlb/rhoml - d1*predrov1b
    wb(i-1, j, 2) = wb(i-1, j, 2) + ulb/rhoml - d1*predrou1b
    wb(i-1, j, 1) = wb(i-1, j, 1) + rhomlb - d1*predro1b
    wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + d1*predrov2b + d1*predrov1b
    wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + d1*predrou2b + d1*predrou1b
    wb(i, j, 1) = wb(i, j, 1) + rhomrb + d1*predro2b + d1*predro1b
    lambdab = ty*gvroe2b + tx*fvroe2b
    tyb = lambda*gvroe2b
    uub = gvrou2*gvroe2b + fvrou2*fvroe2b
    gvrou2b = gvrou2b + uu*gvroe2b
    vvb = gvrov2*gvroe2b + fvrov2*fvroe2b
    gvrov2b = gvrov2b + vv*gvroe2b
    wwb = gvrow2*gvroe2b + fvrow2*fvroe2b
    gvrow2b = gvrow2b + ww*gvroe2b
    wyb = mmu*gvrow2b
    tempb1 = twothird*gvrov2b
    mmub = wy*gvrow2b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    uyb = mmu*gvrou2b + mmu*fvrov2b
    vxb = mmu*gvrou2b + mmu*fvrov2b
    txb = lambda*fvroe2b
    fvrou2b = fvrou2b + uu*fvroe2b
    fvrow2b = fvrow2b + ww*fvroe2b
    wxb = mmu*fvrow2b
    tempb1 = twothird*fvrou2b
    mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (two*&
&     ux-vy)*tempb1 + cpprandtl*lambdab
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    lambda = ad_save43
    mmu = ad_save42
    tempb1 = 0.0625d0*mmub
    mub(i, j-1) = mub(i, j-1) + 9.d0*tempb1
    mub(i, j-2) = mub(i, j-2) - tempb1
    mub(i, j) = mub(i, j) + 9.d0*tempb1
    mub(i, j+1) = mub(i, j+1) - tempb1
    ww = ad_save41
    tempb1 = 0.0625d0*wwb
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb1
    velzb(i, j-2) = velzb(i, j-2) - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb1
    velzb(i, j+1) = velzb(i, j+1) - tempb1
    vv = ad_save40
    tempb1 = 0.0625d0*vvb
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb1
    velyb(i, j-2) = velyb(i, j-2) - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb1
    velyb(i, j+1) = velyb(i, j+1) - tempb1
    uu = ad_save39
    tempb1 = 0.0625d0*uub
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb1
    velxb(i, j-2) = velxb(i, j-2) - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb1
    velxb(i, j+1) = velxb(i, j+1) - tempb1
    ty = ad_save38
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tx = ad_save37
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb + 26.d0*tempb1
    tlocb(i, j+1) = tlocb(i, j+1) - tempb1
    tlocb(i, j-1) = tlocb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    tlocb(i, j-1) = tlocb(i, j-1) + 26.d0*tempb1
    tlocb(i, j) = tlocb(i, j) - tempb1
    tlocb(i, j-2) = tlocb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
    tlocb(i-2, j-1) = tlocb(i-2, j-1) - 9.d0*tempb1
    tlocb(i-2, j) = tlocb(i-2, j) - 9.d0*tempb1
    tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) - 9.d0*tempb1
    tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1
    tlocb(i+1, j) = tlocb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    tlocb(i-1, j) = tlocb(i-1, j) + gam*rgaz*c2lb + 9.d0*tempb0 - 9.d0*&
&     tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    tlocb(i-1, j-2) = tlocb(i-1, j-2) + tempb1 - tempb0
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    tlocb(i, j-2) = tlocb(i, j-2) - tempb - tempb0
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb + 9.d0*tempb0
    tlocb(i, j+1) = tlocb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    tlocb(i+2, j-2) = tlocb(i+2, j-2) + tempb1
    tlocb(i+2, j-1) = tlocb(i+2, j-1) - 9.d0*tempb1
    tlocb(i+2, j+1) = tlocb(i+2, j+1) + tempb1
    tlocb(i+2, j) = tlocb(i+2, j) - 9.d0*tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + 9.d0*tempb
    tlocb(i+1, j-2) = tlocb(i+1, j-2) - tempb
    tlocb(i+1, j) = tlocb(i+1, j) + 9.d0*tempb
    tlocb(i+1, j+1) = tlocb(i+1, j+1) - tempb
    wy = ad_save36
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    wx = ad_save35
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velzb(i, j) = velzb(i, j) + 26.d0*tempb1
    velzb(i, j+1) = velzb(i, j+1) - tempb1
    velzb(i, j-1) = velzb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velzb(i, j-1) = velzb(i, j-1) + 26.d0*tempb1
    velzb(i, j) = velzb(i, j) - tempb1
    velzb(i, j-2) = velzb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
    velzb(i-2, j-1) = velzb(i-2, j-1) - 9.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - 9.d0*tempb1
    velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) - 9.d0*tempb1
    velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1
    velzb(i+1, j) = velzb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velzb(i-1, j-2) = velzb(i-1, j-2) + tempb1 - tempb0
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velzb(i, j-2) = velzb(i, j-2) - tempb - tempb0
    velzb(i, j) = velzb(i, j) + 9.d0*tempb + 9.d0*tempb0
    velzb(i, j+1) = velzb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velzb(i+2, j-2) = velzb(i+2, j-2) + tempb1
    velzb(i+2, j-1) = velzb(i+2, j-1) - 9.d0*tempb1
    velzb(i+2, j+1) = velzb(i+2, j+1) + tempb1
    velzb(i+2, j) = velzb(i+2, j) - 9.d0*tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + 9.d0*tempb
    velzb(i+1, j-2) = velzb(i+1, j-2) - tempb
    velzb(i+1, j) = velzb(i+1, j) + 9.d0*tempb
    velzb(i+1, j+1) = velzb(i+1, j+1) - tempb
    vy = ad_save34
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    vx = ad_save33
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velyb(i, j) = velyb(i, j) + 26.d0*tempb1
    velyb(i, j+1) = velyb(i, j+1) - tempb1
    velyb(i, j-1) = velyb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velyb(i, j-1) = velyb(i, j-1) + 26.d0*tempb1
    velyb(i, j) = velyb(i, j) - tempb1
    velyb(i, j-2) = velyb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
    velyb(i-2, j-1) = velyb(i-2, j-1) - 9.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - 9.d0*tempb1
    velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) - 9.d0*tempb1
    velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1
    velyb(i+1, j) = velyb(i+1, j) - 9.d0*tempb1
    tempb1 = ccross*val_nb
    velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velyb(i-1, j-2) = velyb(i-1, j-2) + tempb1 - tempb0
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velyb(i, j-2) = velyb(i, j-2) - tempb - tempb0
    velyb(i, j) = velyb(i, j) + 9.d0*tempb + 9.d0*tempb0
    velyb(i, j+1) = velyb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velyb(i+2, j-2) = velyb(i+2, j-2) + tempb1
    velyb(i+2, j-1) = velyb(i+2, j-1) - 9.d0*tempb1
    velyb(i+2, j+1) = velyb(i+2, j+1) + tempb1
    velyb(i+2, j) = velyb(i+2, j) - 9.d0*tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + 9.d0*tempb
    velyb(i+1, j-2) = velyb(i+1, j-2) - tempb
    velyb(i+1, j) = velyb(i+1, j) + 9.d0*tempb
    velyb(i+1, j+1) = velyb(i+1, j+1) - tempb
    uy = ad_save32
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    ux = ad_save31
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = twentyfourth*val_ob
    velxb(i, j) = velxb(i, j) + 26.d0*tempb1
    velxb(i, j+1) = velxb(i, j+1) - tempb1
    velxb(i, j-1) = velxb(i, j-1) - tempb1
    tempb1 = twentyfourth*val_eb
    velxb(i, j-1) = velxb(i, j-1) + 26.d0*tempb1
    velxb(i, j) = velxb(i, j) - tempb1
    velxb(i, j-2) = velxb(i, j-2) - tempb1
    tempb1 = ccross*val_sb
    velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
    velxb(i-2, j-1) = velxb(i-2, j-1) - 9.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - 9.d0*tempb1
    velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) - 9.d0*tempb1
    velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1
    velxb(i+1, j) = velxb(i+1, j) - 9.d0*tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb
    tempb1 = ccross*val_nb
    velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
    velxb(i-1, j-2) = velxb(i-1, j-2) + tempb1 - tempb0
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
    velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1 - tempb0
    tempb0 = 7.d0*tempb1
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
    velxb(i, j-2) = velxb(i, j-2) - tempb - tempb0
    velxb(i, j+1) = velxb(i, j+1) - tempb - tempb0
    tempb = 7.d0*tempb1
    velxb(i+2, j-2) = velxb(i+2, j-2) + tempb1
    velxb(i+2, j-1) = velxb(i+2, j-1) - 9.d0*tempb1
    velxb(i+2, j+1) = velxb(i+2, j+1) + tempb1
    velxb(i+2, j) = velxb(i+2, j) - 9.d0*tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + 9.d0*tempb
    velxb(i+1, j-2) = velxb(i+1, j-2) - tempb
    velxb(i+1, j+1) = velxb(i+1, j+1) - tempb
    lambdab = ty*gvroe1b + tx*fvroe1b
    tyb = lambda*gvroe1b
    uub = gvrou1*gvroe1b + fvrou1*fvroe1b
    gvrou1b = gvrou1b + uu*gvroe1b
    vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
    gvrov1b = gvrov1b + vv*gvroe1b
    wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
    gvrow1b = gvrow1b + ww*gvroe1b
    wyb = mmu*gvrow1b
    tempb1 = twothird*gvrov1b
    mmub = wy*gvrow1b + (two*vy-ux)*tempb1
    vyb = two*mmu*tempb1
    uxb = -(mmu*tempb1)
    txb = lambda*fvroe1b
    fvrou1b = fvrou1b + uu*fvroe1b
    fvrov1b = fvrov1b + vv*fvroe1b
    uyb = mmu*gvrou1b + mmu*fvrov1b
    vxb = mmu*gvrou1b + mmu*fvrov1b
    fvrow1b = fvrow1b + ww*fvroe1b
    wxb = mmu*fvrow1b
    tempb1 = twothird*fvrou1b
    mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (two*&
&     ux-vy)*tempb1 + cpprandtl*lambdab
    uxb = uxb + two*mmu*tempb1
    vyb = vyb - mmu*tempb1
    tempb1 = 0.0625d0*mmub
    mub(i-1, j) = mub(i-1, j) + 9.d0*tempb1
    mub(i-2, j) = mub(i-2, j) - tempb1
    mub(i, j) = mub(i, j) + 9.d0*tempb1
    mub(i+1, j) = mub(i+1, j) - tempb1
    tempb1 = 0.0625d0*wwb
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb1
    velzb(i+1, j) = velzb(i+1, j) - tempb1
    tempb1 = 0.0625d0*vvb
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb1
    velyb(i+1, j) = velyb(i+1, j) - tempb1
    tempb1 = 0.0625d0*uub
    velxb(i+1, j) = velxb(i+1, j) + 9.d0*tempb - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb0 + 9.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - tempb1
    ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
    ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
    ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
    ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
    volm1 = volf(i, j, 1)
    tempb1 = volm1*tyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
    nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
    nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
    nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
    tempb1 = volm1*txb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    tlocb(i-2, j-1) = tlocb(i-2, j-1) + tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) - 9.d0*tempb1
    tlocb(i, j-1) = tlocb(i, j-1) - 9.d0*tempb1
    tlocb(i+1, j-1) = tlocb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i-2, j+2) = tlocb(i-2, j+2) + tempb1
    tlocb(i-1, j+2) = tlocb(i-1, j+2) - 9.d0*tempb1
    tlocb(i+1, j+2) = tlocb(i+1, j+2) + tempb1
    tlocb(i, j+2) = tlocb(i, j+2) - 9.d0*tempb1
    tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb0
    tlocb(i-2, j) = tlocb(i-2, j) - tempb0
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb0
    tlocb(i+1, j) = tlocb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    tlocb(i-1, j+1) = tlocb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1 - tempb
    tlocb(i, j+1) = tlocb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1 - tempb
    tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
    tlocb(i-1, j-2) = tlocb(i-1, j-2) - 9.d0*tempb1
    tlocb(i, j-2) = tlocb(i, j-2) - 9.d0*tempb1
    tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0
    tlocb(i-2, j-1) = tlocb(i-2, j-1) - tempb0
    tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb0
    tlocb(i+1, j-1) = tlocb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    tlocb(i-2, j) = tlocb(i-2, j) - tempb - tempb1
    tlocb(i, j) = tlocb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    tlocb(i+1, j) = tlocb(i+1, j) - tempb - tempb1
    tlocb(i, j) = tlocb(i, j) + 26.d0*tempb1
    tlocb(i-1, j) = tlocb(i-1, j) - tempb1
    tempb1 = volm1*wyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*wxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velzb(i-2, j-1) = velzb(i-2, j-1) + tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) - 9.d0*tempb1
    velzb(i, j-1) = velzb(i, j-1) - 9.d0*tempb1
    velzb(i+1, j-1) = velzb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i-2, j+2) = velzb(i-2, j+2) + tempb1
    velzb(i-1, j+2) = velzb(i-1, j+2) - 9.d0*tempb1
    velzb(i+1, j+2) = velzb(i+1, j+2) + tempb1
    velzb(i, j+2) = velzb(i, j+2) - 9.d0*tempb1
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0
    velzb(i-2, j) = velzb(i-2, j) - tempb0
    velzb(i, j) = velzb(i, j) + 9.d0*tempb0
    velzb(i+1, j) = velzb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velzb(i-1, j+1) = velzb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1 - tempb
    velzb(i, j+1) = velzb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1 - tempb
    velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
    velzb(i-1, j-2) = velzb(i-1, j-2) - 9.d0*tempb1
    velzb(i, j-2) = velzb(i, j-2) - 9.d0*tempb1
    velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0
    velzb(i-2, j-1) = velzb(i-2, j-1) - tempb0
    velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb0
    velzb(i+1, j-1) = velzb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velzb(i-2, j) = velzb(i-2, j) - tempb - tempb1
    velzb(i, j) = velzb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velzb(i+1, j) = velzb(i+1, j) - tempb - tempb1
    velzb(i, j) = velzb(i, j) + 26.d0*tempb1
    velzb(i-1, j) = velzb(i-1, j) - tempb1
    tempb1 = volm1*vyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*vxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velyb(i-2, j-1) = velyb(i-2, j-1) + tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) - 9.d0*tempb1
    velyb(i, j-1) = velyb(i, j-1) - 9.d0*tempb1
    velyb(i+1, j-1) = velyb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i-2, j+2) = velyb(i-2, j+2) + tempb1
    velyb(i-1, j+2) = velyb(i-1, j+2) - 9.d0*tempb1
    velyb(i+1, j+2) = velyb(i+1, j+2) + tempb1
    velyb(i, j+2) = velyb(i, j+2) - 9.d0*tempb1
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0
    velyb(i-2, j) = velyb(i-2, j) - tempb0
    velyb(i, j) = velyb(i, j) + 9.d0*tempb0
    velyb(i+1, j) = velyb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velyb(i-1, j+1) = velyb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1 - tempb
    velyb(i, j+1) = velyb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1 - tempb
    velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
    velyb(i-1, j-2) = velyb(i-1, j-2) - 9.d0*tempb1
    velyb(i, j-2) = velyb(i, j-2) - 9.d0*tempb1
    velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0
    velyb(i-2, j-1) = velyb(i-2, j-1) - tempb0
    velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb0
    velyb(i+1, j-1) = velyb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velyb(i-2, j) = velyb(i-2, j) - tempb - tempb1
    velyb(i, j) = velyb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velyb(i+1, j) = velyb(i+1, j) - tempb - tempb1
    velyb(i, j) = velyb(i, j) + 26.d0*tempb1
    velyb(i-1, j) = velyb(i-1, j) - tempb1
    tempb1 = volm1*uyb
    val_nb = ny_n*tempb1
    val_sb = ny_s*tempb1
    val_ob = ny_o*tempb1
    val_eb = ny_e*tempb1
    tempb1 = volm1*uxb
    val_nb = val_nb + nx_n*tempb1
    val_sb = val_sb + nx_s*tempb1
    val_ob = val_ob + nx_o*tempb1
    val_eb = val_eb + nx_e*tempb1
    tempb1 = ccross*val_ob
    velxb(i-2, j-1) = velxb(i-2, j-1) + tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) - 9.d0*tempb1
    velxb(i, j-1) = velxb(i, j-1) - 9.d0*tempb1
    velxb(i+1, j-1) = velxb(i+1, j-1) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i-2, j+2) = velxb(i-2, j+2) + tempb1
    velxb(i-1, j+2) = velxb(i-1, j+2) - 9.d0*tempb1
    velxb(i+1, j+2) = velxb(i+1, j+2) + tempb1
    velxb(i, j+2) = velxb(i, j+2) - 9.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0
    velxb(i-2, j) = velxb(i-2, j) - tempb0
    velxb(i, j) = velxb(i, j) + 9.d0*tempb0
    velxb(i+1, j) = velxb(i+1, j) - tempb0
    tempb1 = ccross*val_eb
    velxb(i-1, j+1) = velxb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
    velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1 - tempb
    velxb(i, j+1) = velxb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
    velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1 - tempb
    velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
    velxb(i-1, j-2) = velxb(i-1, j-2) - 9.d0*tempb1
    velxb(i, j-2) = velxb(i, j-2) - 9.d0*tempb1
    velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
    tempb0 = 7.d0*tempb1
    tempb = 7.d0*tempb1
    velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0
    velxb(i-2, j-1) = velxb(i-2, j-1) - tempb0
    velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb0
    velxb(i+1, j-1) = velxb(i+1, j-1) - tempb0
    tempb1 = twentyfourth*val_sb
    velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
    velxb(i-2, j) = velxb(i-2, j) - tempb - tempb1
    velxb(i, j) = velxb(i, j) + 9.d0*tempb - tempb1
    tempb1 = twentyfourth*val_nb
    velxb(i+1, j) = velxb(i+1, j) - tempb - tempb1
    velxb(i, j) = velxb(i, j) + 26.d0*tempb1
    velxb(i-1, j) = velxb(i-1, j) - tempb1
    wb(i, j-4, 5) = wb(i, j-4, 5) + d4*predroe2b
    wb(i, j-5, 5) = wb(i, j-5, 5) - d5*predroe2b
    wb(i, j-3, 5) = wb(i, j-3, 5) - d3*predroe2b
    wb(i, j-2, 5) = wb(i, j-2, 5) + d2*predroe2b
    wb(i, j-1, 5) = wb(i, j-1, 5) - d1*predroe2b
    wb(i, j, 5) = wb(i, j, 5) + d1*predroe2b + d1*predroe1b
    wb(i, j+1, 5) = wb(i, j+1, 5) - d2*predroe2b
    wb(i, j+2, 5) = wb(i, j+2, 5) + d3*predroe2b
    wb(i, j+4, 5) = wb(i, j+4, 5) + d5*predroe2b
    wb(i, j+3, 5) = wb(i, j+3, 5) - d4*predroe2b
    wb(i, j-4, 4) = wb(i, j-4, 4) + d4*predrow2b
    wb(i, j-5, 4) = wb(i, j-5, 4) - d5*predrow2b
    wb(i, j-3, 4) = wb(i, j-3, 4) - d3*predrow2b
    wb(i, j-2, 4) = wb(i, j-2, 4) + d2*predrow2b
    wb(i, j-1, 4) = wb(i, j-1, 4) - d1*predrow2b
    wb(i, j, 4) = wb(i, j, 4) + d1*predrow2b + d1*predrow1b
    wb(i, j+1, 4) = wb(i, j+1, 4) - d2*predrow2b
    wb(i, j+2, 4) = wb(i, j+2, 4) + d3*predrow2b
    wb(i, j+4, 4) = wb(i, j+4, 4) + d5*predrow2b
    wb(i, j+3, 4) = wb(i, j+3, 4) - d4*predrow2b
    wb(i, j-4, 3) = wb(i, j-4, 3) + d4*predrov2b
    wb(i, j-5, 3) = wb(i, j-5, 3) - d5*predrov2b
    wb(i, j-3, 3) = wb(i, j-3, 3) - d3*predrov2b
    wb(i, j-2, 3) = wb(i, j-2, 3) + d2*predrov2b
    wb(i, j-1, 3) = wb(i, j-1, 3) - d1*predrov2b
    wb(i, j+1, 3) = wb(i, j+1, 3) - d2*predrov2b
    wb(i, j+2, 3) = wb(i, j+2, 3) + d3*predrov2b
    wb(i, j+4, 3) = wb(i, j+4, 3) + d5*predrov2b
    wb(i, j+3, 3) = wb(i, j+3, 3) - d4*predrov2b
    wb(i, j-4, 2) = wb(i, j-4, 2) + d4*predrou2b
    wb(i, j-5, 2) = wb(i, j-5, 2) - d5*predrou2b
    wb(i, j-3, 2) = wb(i, j-3, 2) - d3*predrou2b
    wb(i, j-2, 2) = wb(i, j-2, 2) + d2*predrou2b
    wb(i, j-1, 2) = wb(i, j-1, 2) - d1*predrou2b
    wb(i, j+1, 2) = wb(i, j+1, 2) - d2*predrou2b
    wb(i, j+2, 2) = wb(i, j+2, 2) + d3*predrou2b
    wb(i, j+4, 2) = wb(i, j+4, 2) + d5*predrou2b
    wb(i, j+3, 2) = wb(i, j+3, 2) - d4*predrou2b
    wb(i, j-4, 1) = wb(i, j-4, 1) + d4*predro2b
    wb(i, j-5, 1) = wb(i, j-5, 1) - d5*predro2b
    wb(i, j-3, 1) = wb(i, j-3, 1) - d3*predro2b
    wb(i, j-2, 1) = wb(i, j-2, 1) + d2*predro2b
    wb(i, j-1, 1) = wb(i, j-1, 1) - d1*predro2b
    wb(i, j+1, 1) = wb(i, j+1, 1) - d2*predro2b
    wb(i, j+2, 1) = wb(i, j+2, 1) + d3*predro2b
    wb(i, j+4, 1) = wb(i, j+4, 1) + d5*predro2b
    wb(i, j+3, 1) = wb(i, j+3, 1) - d4*predro2b
    wb(i-4, j, 5) = wb(i-4, j, 5) + d4*predroe1b
    wb(i-5, j, 5) = wb(i-5, j, 5) - d5*predroe1b
    wb(i-3, j, 5) = wb(i-3, j, 5) - d3*predroe1b
    wb(i-2, j, 5) = wb(i-2, j, 5) + d2*predroe1b
    wb(i-1, j, 5) = wb(i-1, j, 5) - d1*predroe1b
    wb(i+1, j, 5) = wb(i+1, j, 5) - d2*predroe1b
    wb(i+2, j, 5) = wb(i+2, j, 5) + d3*predroe1b
    wb(i+4, j, 5) = wb(i+4, j, 5) + d5*predroe1b
    wb(i+3, j, 5) = wb(i+3, j, 5) - d4*predroe1b
    wb(i-4, j, 4) = wb(i-4, j, 4) + d4*predrow1b
    wb(i-5, j, 4) = wb(i-5, j, 4) - d5*predrow1b
    wb(i-3, j, 4) = wb(i-3, j, 4) - d3*predrow1b
    wb(i-2, j, 4) = wb(i-2, j, 4) + d2*predrow1b
    wb(i-1, j, 4) = wb(i-1, j, 4) - d1*predrow1b
    wb(i+1, j, 4) = wb(i+1, j, 4) - d2*predrow1b
    wb(i+2, j, 4) = wb(i+2, j, 4) + d3*predrow1b
    wb(i+4, j, 4) = wb(i+4, j, 4) + d5*predrow1b
    wb(i+3, j, 4) = wb(i+3, j, 4) - d4*predrow1b
    wb(i-4, j, 3) = wb(i-4, j, 3) + d4*predrov1b
    wb(i-5, j, 3) = wb(i-5, j, 3) - d5*predrov1b
    wb(i-3, j, 3) = wb(i-3, j, 3) - d3*predrov1b
    wb(i-2, j, 3) = wb(i-2, j, 3) + d2*predrov1b
    wb(i+1, j, 3) = wb(i+1, j, 3) - d2*predrov1b
    wb(i+2, j, 3) = wb(i+2, j, 3) + d3*predrov1b
    wb(i+4, j, 3) = wb(i+4, j, 3) + d5*predrov1b
    wb(i+3, j, 3) = wb(i+3, j, 3) - d4*predrov1b
    wb(i-4, j, 2) = wb(i-4, j, 2) + d4*predrou1b
    wb(i-5, j, 2) = wb(i-5, j, 2) - d5*predrou1b
    wb(i-3, j, 2) = wb(i-3, j, 2) - d3*predrou1b
    wb(i-2, j, 2) = wb(i-2, j, 2) + d2*predrou1b
    wb(i+1, j, 2) = wb(i+1, j, 2) - d2*predrou1b
    wb(i+2, j, 2) = wb(i+2, j, 2) + d3*predrou1b
    wb(i+4, j, 2) = wb(i+4, j, 2) + d5*predrou1b
    wb(i+3, j, 2) = wb(i+3, j, 2) - d4*predrou1b
    wb(i-4, j, 1) = wb(i-4, j, 1) + d4*predro1b
    wb(i-5, j, 1) = wb(i-5, j, 1) - d5*predro1b
    wb(i-3, j, 1) = wb(i-3, j, 1) - d3*predro1b
    wb(i-2, j, 1) = wb(i-2, j, 1) + d2*predro1b
    wb(i+1, j, 1) = wb(i+1, j, 1) - d2*predro1b
    wb(i+2, j, 1) = wb(i+2, j, 1) + d3*predro1b
    wb(i+4, j, 1) = wb(i+4, j, 1) + d5*predro1b
    wb(i+3, j, 1) = wb(i+3, j, 1) - d4*predro1b
    tempb1 = nx(i, j, 2)*fxroe2b
    tempb0 = ny(i, j, 2)*fxroe2b
    gb(i, 1, 5) = gb(i, 1, 5) + c9d0*tempb0
    gb(i, 2, 5) = gb(i, 2, 5) + c9d1*tempb0
    gb(i, 3, 5) = gb(i, 3, 5) + c9d2*tempb0
    gb(i, 4, 5) = gb(i, 4, 5) + c9d3*tempb0
    gb(i, 5, 5) = gb(i, 5, 5) + c9d4*tempb0
    gb(i, 6, 5) = gb(i, 6, 5) + c9d5*tempb0
    gb(i, 7, 5) = gb(i, 7, 5) + c9d6*tempb0
    gb(i, 8, 5) = gb(i, 8, 5) + c9d7*tempb0
    gb(i, 9, 5) = gb(i, 9, 5) + c9d8*tempb0
    gb(i, 10, 5) = gb(i, 10, 5) + c9d9*tempb0
    gb(i, 11, 5) = gb(i, 11, 5) + c9d10*tempb0
    fb(i, 1, 5) = fb(i, 1, 5) + c9d0*tempb1
    fb(i, 2, 5) = fb(i, 2, 5) + c9d1*tempb1
    fb(i, 3, 5) = fb(i, 3, 5) + c9d2*tempb1
    fb(i, 4, 5) = fb(i, 4, 5) + c9d3*tempb1
    fb(i, 5, 5) = fb(i, 5, 5) + c9d4*tempb1
    fb(i, 6, 5) = fb(i, 6, 5) + c9d5*tempb1
    fb(i, 7, 5) = fb(i, 7, 5) + c9d6*tempb1
    fb(i, 8, 5) = fb(i, 8, 5) + c9d7*tempb1
    fb(i, 9, 5) = fb(i, 9, 5) + c9d8*tempb1
    fb(i, 10, 5) = fb(i, 10, 5) + c9d9*tempb1
    fb(i, 11, 5) = fb(i, 11, 5) + c9d10*tempb1
    tempb1 = nx(i, j, 2)*fxrow2b
    tempb0 = ny(i, j, 2)*fxrow2b
    gb(i, 1, 4) = gb(i, 1, 4) + c9d0*tempb0
    gb(i, 2, 4) = gb(i, 2, 4) + c9d1*tempb0
    gb(i, 3, 4) = gb(i, 3, 4) + c9d2*tempb0
    gb(i, 4, 4) = gb(i, 4, 4) + c9d3*tempb0
    gb(i, 5, 4) = gb(i, 5, 4) + c9d4*tempb0
    gb(i, 6, 4) = gb(i, 6, 4) + c9d5*tempb0
    gb(i, 7, 4) = gb(i, 7, 4) + c9d6*tempb0
    gb(i, 8, 4) = gb(i, 8, 4) + c9d7*tempb0
    gb(i, 9, 4) = gb(i, 9, 4) + c9d8*tempb0
    gb(i, 10, 4) = gb(i, 10, 4) + c9d9*tempb0
    gb(i, 11, 4) = gb(i, 11, 4) + c9d10*tempb0
    fb(i, 1, 4) = fb(i, 1, 4) + c9d0*tempb1
    fb(i, 2, 4) = fb(i, 2, 4) + c9d1*tempb1
    fb(i, 3, 4) = fb(i, 3, 4) + c9d2*tempb1
    fb(i, 4, 4) = fb(i, 4, 4) + c9d3*tempb1
    fb(i, 5, 4) = fb(i, 5, 4) + c9d4*tempb1
    fb(i, 6, 4) = fb(i, 6, 4) + c9d5*tempb1
    fb(i, 7, 4) = fb(i, 7, 4) + c9d6*tempb1
    fb(i, 8, 4) = fb(i, 8, 4) + c9d7*tempb1
    fb(i, 9, 4) = fb(i, 9, 4) + c9d8*tempb1
    fb(i, 10, 4) = fb(i, 10, 4) + c9d9*tempb1
    fb(i, 11, 4) = fb(i, 11, 4) + c9d10*tempb1
    tempb1 = nx(i, j, 2)*fxrov2b
    tempb0 = ny(i, j, 2)*fxrov2b
    gb(i, 1, 3) = gb(i, 1, 3) + c9d0*tempb0
    gb(i, 2, 3) = gb(i, 2, 3) + c9d1*tempb0
    gb(i, 3, 3) = gb(i, 3, 3) + c9d2*tempb0
    gb(i, 4, 3) = gb(i, 4, 3) + c9d3*tempb0
    gb(i, 5, 3) = gb(i, 5, 3) + c9d4*tempb0
    gb(i, 6, 3) = gb(i, 6, 3) + c9d5*tempb0
    gb(i, 7, 3) = gb(i, 7, 3) + c9d6*tempb0
    gb(i, 8, 3) = gb(i, 8, 3) + c9d7*tempb0
    gb(i, 9, 3) = gb(i, 9, 3) + c9d8*tempb0
    gb(i, 10, 3) = gb(i, 10, 3) + c9d9*tempb0
    gb(i, 11, 3) = gb(i, 11, 3) + c9d10*tempb0
    fb(i, 1, 3) = fb(i, 1, 3) + c9d0*tempb1
    fb(i, 2, 3) = fb(i, 2, 3) + c9d1*tempb1
    fb(i, 3, 3) = fb(i, 3, 3) + c9d2*tempb1
    fb(i, 4, 3) = fb(i, 4, 3) + c9d3*tempb1
    fb(i, 5, 3) = fb(i, 5, 3) + c9d4*tempb1
    fb(i, 6, 3) = fb(i, 6, 3) + c9d5*tempb1
    fb(i, 7, 3) = fb(i, 7, 3) + c9d6*tempb1
    fb(i, 8, 3) = fb(i, 8, 3) + c9d7*tempb1
    fb(i, 9, 3) = fb(i, 9, 3) + c9d8*tempb1
    fb(i, 10, 3) = fb(i, 10, 3) + c9d9*tempb1
    fb(i, 11, 3) = fb(i, 11, 3) + c9d10*tempb1
    tempb1 = nx(i, j, 2)*fxrou2b
    tempb0 = ny(i, j, 2)*fxrou2b
    gb(i, 1, 2) = gb(i, 1, 2) + c9d0*tempb0
    gb(i, 2, 2) = gb(i, 2, 2) + c9d1*tempb0
    gb(i, 3, 2) = gb(i, 3, 2) + c9d2*tempb0
    gb(i, 4, 2) = gb(i, 4, 2) + c9d3*tempb0
    gb(i, 5, 2) = gb(i, 5, 2) + c9d4*tempb0
    gb(i, 6, 2) = gb(i, 6, 2) + c9d5*tempb0
    gb(i, 7, 2) = gb(i, 7, 2) + c9d6*tempb0
    gb(i, 8, 2) = gb(i, 8, 2) + c9d7*tempb0
    gb(i, 9, 2) = gb(i, 9, 2) + c9d8*tempb0
    gb(i, 10, 2) = gb(i, 10, 2) + c9d9*tempb0
    gb(i, 11, 2) = gb(i, 11, 2) + c9d10*tempb0
    fb(i, 1, 2) = fb(i, 1, 2) + c9d0*tempb1
    fb(i, 2, 2) = fb(i, 2, 2) + c9d1*tempb1
    fb(i, 3, 2) = fb(i, 3, 2) + c9d2*tempb1
    fb(i, 4, 2) = fb(i, 4, 2) + c9d3*tempb1
    fb(i, 5, 2) = fb(i, 5, 2) + c9d4*tempb1
    fb(i, 6, 2) = fb(i, 6, 2) + c9d5*tempb1
    fb(i, 7, 2) = fb(i, 7, 2) + c9d6*tempb1
    fb(i, 8, 2) = fb(i, 8, 2) + c9d7*tempb1
    fb(i, 9, 2) = fb(i, 9, 2) + c9d8*tempb1
    fb(i, 10, 2) = fb(i, 10, 2) + c9d9*tempb1
    fb(i, 11, 2) = fb(i, 11, 2) + c9d10*tempb1
    tempb1 = nx(i, j, 2)*fxro2b
    tempb0 = ny(i, j, 2)*fxro2b
    gb(i, 1, 1) = gb(i, 1, 1) + c9d0*tempb0
    gb(i, 2, 1) = gb(i, 2, 1) + c9d1*tempb0
    gb(i, 3, 1) = gb(i, 3, 1) + c9d2*tempb0
    gb(i, 4, 1) = gb(i, 4, 1) + c9d3*tempb0
    gb(i, 5, 1) = gb(i, 5, 1) + c9d4*tempb0
    gb(i, 6, 1) = gb(i, 6, 1) + c9d5*tempb0
    gb(i, 7, 1) = gb(i, 7, 1) + c9d6*tempb0
    gb(i, 8, 1) = gb(i, 8, 1) + c9d7*tempb0
    gb(i, 9, 1) = gb(i, 9, 1) + c9d8*tempb0
    gb(i, 10, 1) = gb(i, 10, 1) + c9d9*tempb0
    gb(i, 11, 1) = gb(i, 11, 1) + c9d10*tempb0
    fb(i, 1, 1) = fb(i, 1, 1) + c9d0*tempb1
    fb(i, 2, 1) = fb(i, 2, 1) + c9d1*tempb1
    fb(i, 3, 1) = fb(i, 3, 1) + c9d2*tempb1
    fb(i, 4, 1) = fb(i, 4, 1) + c9d3*tempb1
    fb(i, 5, 1) = fb(i, 5, 1) + c9d4*tempb1
    fb(i, 6, 1) = fb(i, 6, 1) + c9d5*tempb1
    fb(i, 7, 1) = fb(i, 7, 1) + c9d6*tempb1
    fb(i, 8, 1) = fb(i, 8, 1) + c9d7*tempb1
    fb(i, 9, 1) = fb(i, 9, 1) + c9d8*tempb1
    fb(i, 10, 1) = fb(i, 10, 1) + c9d9*tempb1
    fb(i, 11, 1) = fb(i, 11, 1) + c9d10*tempb1
    tempb1 = nx(i, j, 1)*fxroe1b
    tempb0 = ny(i, j, 1)*fxroe1b
    gb(i, j, 5) = gb(i, j, 5) + c1*tempb0
    gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb0
    gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb0
    gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb0
    gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb0
    gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb0
    gb(i+3, j, 5) = gb(i+3, j, 5) + c4*tempb0
    gb(i-4, j, 5) = gb(i-4, j, 5) + c4*tempb0
    gb(i+4, j, 5) = gb(i+4, j, 5) + c5*tempb0
    gb(i-5, j, 5) = gb(i-5, j, 5) + c5*tempb0
    fb(i, j, 5) = fb(i, j, 5) + c1*tempb1
    fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb1
    fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb1
    fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb1
    fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb1
    fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb1
    fb(i+3, j, 5) = fb(i+3, j, 5) + c4*tempb1
    fb(i-4, j, 5) = fb(i-4, j, 5) + c4*tempb1
    fb(i+4, j, 5) = fb(i+4, j, 5) + c5*tempb1
    fb(i-5, j, 5) = fb(i-5, j, 5) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrow1b
    tempb0 = ny(i, j, 1)*fxrow1b
    gb(i, j, 4) = gb(i, j, 4) + c1*tempb0
    gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb0
    gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb0
    gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb0
    gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb0
    gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb0
    gb(i+3, j, 4) = gb(i+3, j, 4) + c4*tempb0
    gb(i-4, j, 4) = gb(i-4, j, 4) + c4*tempb0
    gb(i+4, j, 4) = gb(i+4, j, 4) + c5*tempb0
    gb(i-5, j, 4) = gb(i-5, j, 4) + c5*tempb0
    fb(i, j, 4) = fb(i, j, 4) + c1*tempb1
    fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb1
    fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb1
    fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb1
    fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb1
    fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb1
    fb(i+3, j, 4) = fb(i+3, j, 4) + c4*tempb1
    fb(i-4, j, 4) = fb(i-4, j, 4) + c4*tempb1
    fb(i+4, j, 4) = fb(i+4, j, 4) + c5*tempb1
    fb(i-5, j, 4) = fb(i-5, j, 4) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrov1b
    tempb0 = ny(i, j, 1)*fxrov1b
    gb(i, j, 3) = gb(i, j, 3) + c1*tempb0
    gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb0
    gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb0
    gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb0
    gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb0
    gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb0
    gb(i+3, j, 3) = gb(i+3, j, 3) + c4*tempb0
    gb(i-4, j, 3) = gb(i-4, j, 3) + c4*tempb0
    gb(i+4, j, 3) = gb(i+4, j, 3) + c5*tempb0
    gb(i-5, j, 3) = gb(i-5, j, 3) + c5*tempb0
    fb(i, j, 3) = fb(i, j, 3) + c1*tempb1
    fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb1
    fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb1
    fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb1
    fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb1
    fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb1
    fb(i+3, j, 3) = fb(i+3, j, 3) + c4*tempb1
    fb(i-4, j, 3) = fb(i-4, j, 3) + c4*tempb1
    fb(i+4, j, 3) = fb(i+4, j, 3) + c5*tempb1
    fb(i-5, j, 3) = fb(i-5, j, 3) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxrou1b
    tempb0 = ny(i, j, 1)*fxrou1b
    gb(i, j, 2) = gb(i, j, 2) + c1*tempb0
    gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb0
    gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb0
    gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb0
    gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb0
    gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb0
    gb(i+3, j, 2) = gb(i+3, j, 2) + c4*tempb0
    gb(i-4, j, 2) = gb(i-4, j, 2) + c4*tempb0
    gb(i+4, j, 2) = gb(i+4, j, 2) + c5*tempb0
    gb(i-5, j, 2) = gb(i-5, j, 2) + c5*tempb0
    fb(i, j, 2) = fb(i, j, 2) + c1*tempb1
    fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb1
    fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb1
    fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb1
    fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb1
    fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb1
    fb(i+3, j, 2) = fb(i+3, j, 2) + c4*tempb1
    fb(i-4, j, 2) = fb(i-4, j, 2) + c4*tempb1
    fb(i+4, j, 2) = fb(i+4, j, 2) + c5*tempb1
    fb(i-5, j, 2) = fb(i-5, j, 2) + c5*tempb1
    tempb1 = nx(i, j, 1)*fxro1b
    tempb0 = ny(i, j, 1)*fxro1b
    gb(i, j, 1) = gb(i, j, 1) + c1*tempb0
    gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb0
    gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb0
    gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb0
    gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb0
    gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb0
    gb(i+3, j, 1) = gb(i+3, j, 1) + c4*tempb0
    gb(i-4, j, 1) = gb(i-4, j, 1) + c4*tempb0
    gb(i+4, j, 1) = gb(i+4, j, 1) + c5*tempb0
    gb(i-5, j, 1) = gb(i-5, j, 1) + c5*tempb0
    fb(i, j, 1) = fb(i, j, 1) + c1*tempb1
    fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb1
    fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb1
    fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb1
    fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb1
    fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb1
    fb(i+3, j, 1) = fb(i+3, j, 1) + c4*tempb1
    fb(i-4, j, 1) = fb(i-4, j, 1) + c4*tempb1
    fb(i+4, j, 1) = fb(i+4, j, 1) + c5*tempb1
    fb(i-5, j, 1) = fb(i-5, j, 1) + c5*tempb1
  END DO
  omrr = ad_save63
  ducros1 = ad_save64
  vy = ad_save65
  vort2 = ad_save66
  vx = ad_save67
  sq = ad_save68
  vv = ad_save69
  sn = ad_save70
  vr = ad_save71
  predrow2 = ad_save72
  predrow1 = ad_save73
  vl = ad_save74
  nxloc = ad_save75
  nyloc = ad_save76
  dxm2 = ad_save77
  uy = ad_save78
  predro2 = ad_save79
  dxm1 = ad_save80
  rr = ad_save81
  ux = ad_save82
  predro1 = ad_save83
  mmu = ad_save84
  uu = ad_save85
  lambda = ad_save86
  ur = ad_save87
  eps4 = ad_save88
  eps2 = ad_save89
  predrov2 = ad_save90
  predrov1 = ad_save91
  ul = ad_save92
  mach2 = ad_save93
  rhomr = ad_save94
  rspec = ad_save95
  v = ad_save96
  alpha = ad_save97
  ty = ad_save98
  u = ad_save99
  tx = ad_save100
  rhoml = ad_save101
  r = ad_save102
  predroe2 = ad_save103
  wy = ad_save104
  predroe1 = ad_save105
  wx = ad_save106
  ww = ad_save107
  predrou2 = ad_save108
  predrou1 = ad_save109
!$BWD-OF II-LOOP 
  DO j=6,jm+1
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1,im+1
!
      predro1 = -(d5*w(i-5, j, 1)) + d4*w(i-4, j, 1) - d3*w(i-3, j, 1) +&
&       d2*w(i-2, j, 1) - d1*w(i-1, j, 1) + d1*w(i, j, 1) - d2*w(i+1, j&
&       , 1) + d3*w(i+2, j, 1) - d4*w(i+3, j, 1) + d5*w(i+4, j, 1)
      predrou1 = -(d5*w(i-5, j, 2)) + d4*w(i-4, j, 2) - d3*w(i-3, j, 2) &
&       + d2*w(i-2, j, 2) - d1*w(i-1, j, 2) + d1*w(i, j, 2) - d2*w(i+1, &
&       j, 2) + d3*w(i+2, j, 2) - d4*w(i+3, j, 2) + d5*w(i+4, j, 2)
      predrov1 = -(d5*w(i-5, j, 3)) + d4*w(i-4, j, 3) - d3*w(i-3, j, 3) &
&       + d2*w(i-2, j, 3) - d1*w(i-1, j, 3) + d1*w(i, j, 3) - d2*w(i+1, &
&       j, 3) + d3*w(i+2, j, 3) - d4*w(i+3, j, 3) + d5*w(i+4, j, 3)
      predrow1 = -(d5*w(i-5, j, 4)) + d4*w(i-4, j, 4) - d3*w(i-3, j, 4) &
&       + d2*w(i-2, j, 4) - d1*w(i-1, j, 4) + d1*w(i, j, 4) - d2*w(i+1, &
&       j, 4) + d3*w(i+2, j, 4) - d4*w(i+3, j, 4) + d5*w(i+4, j, 4)
      predroe1 = -(d5*w(i-5, j, 5)) + d4*w(i-4, j, 5) - d3*w(i-3, j, 5) &
&       + d2*w(i-2, j, 5) - d1*w(i-1, j, 5) + d1*w(i, j, 5) - d2*w(i+1, &
&       j, 5) + d3*w(i+2, j, 5) - d4*w(i+3, j, 5) + d5*w(i+4, j, 5)
      predro2 = -(d5*w(i, j-5, 1)) + d4*w(i, j-4, 1) - d3*w(i, j-3, 1) +&
&       d2*w(i, j-2, 1) - d1*w(i, j-1, 1) + d1*w(i, j, 1) - d2*w(i, j+1&
&       , 1) + d3*w(i, j+2, 1) - d4*w(i, j+3, 1) + d5*w(i, j+4, 1)
      predrou2 = -(d5*w(i, j-5, 2)) + d4*w(i, j-4, 2) - d3*w(i, j-3, 2) &
&       + d2*w(i, j-2, 2) - d1*w(i, j-1, 2) + d1*w(i, j, 2) - d2*w(i, j+&
&       1, 2) + d3*w(i, j+2, 2) - d4*w(i, j+3, 2) + d5*w(i, j+4, 2)
      predrov2 = -(d5*w(i, j-5, 3)) + d4*w(i, j-4, 3) - d3*w(i, j-3, 3) &
&       + d2*w(i, j-2, 3) - d1*w(i, j-1, 3) + d1*w(i, j, 3) - d2*w(i, j+&
&       1, 3) + d3*w(i, j+2, 3) - d4*w(i, j+3, 3) + d5*w(i, j+4, 3)
      predrow2 = -(d5*w(i, j-5, 4)) + d4*w(i, j-4, 4) - d3*w(i, j-3, 4) &
&       + d2*w(i, j-2, 4) - d1*w(i, j-1, 4) + d1*w(i, j, 4) - d2*w(i, j+&
&       1, 4) + d3*w(i, j+2, 4) - d4*w(i, j+3, 4) + d5*w(i, j+4, 4)
      predroe2 = -(d5*w(i, j-5, 5)) + d4*w(i, j-4, 5) - d3*w(i, j-3, 5) &
&       + d2*w(i, j-2, 5) - d1*w(i, j-1, 5) + d1*w(i, j, 5) - d2*w(i, j+&
&       1, 5) + d3*w(i, j+2, 5) - d4*w(i, j+3, 5) + d5*w(i, j+4, 5)
! grad for viscous fluxes o4 - 5p
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccros = TWELFTH*0.0625d0
      volm1 = volf(i, j, 1)
      nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
      nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
      nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
      nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
!
      ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
      ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
      ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
      ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
      val_n = twentyfourth*(-velx(i+1, j)+26.d0*velx(i, j)-velx(i-1, j))
      val_s = twentyfourth*(-velx(i, j)+26.d0*velx(i-1, j)-velx(i-2, j))
      val_e = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-1, j-2)+9.d0*velx(i&
&       , j-2)-velx(i+1, j-2))+7.d0*(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)&
&       +9.d0*velx(i, j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx&
&       (i-1, j)+9.d0*velx(i, j)-velx(i+1, j))-(-velx(i-2, j+1)+9.d0*&
&       velx(i-1, j+1)+9.d0*velx(i, j+1)-velx(i+1, j+1)))
      val_o = ccross*(-(-velx(i-2, j-1)+9.d0*velx(i-1, j-1)+9.d0*velx(i&
&       , j-1)-velx(i+1, j-1))+7.d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+&
&       9.d0*velx(i, j)-velx(i+1, j))+7.d0*(-velx(i-2, j+1)+9.d0*velx(i-&
&       1, j+1)+9.d0*velx(i, j+1)-velx(i+1, j+1))-(-velx(i-2, j+2)+9.d0*&
&       velx(i-1, j+2)+9.d0*velx(i, j+2)-velx(i+1, j+2)))
      ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = twentyfourth*(-vely(i+1, j)+26.d0*vely(i, j)-vely(i-1, j))
      val_s = twentyfourth*(-vely(i, j)+26.d0*vely(i-1, j)-vely(i-2, j))
      val_e = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-1, j-2)+9.d0*vely(i&
&       , j-2)-vely(i+1, j-2))+7.d0*(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)&
&       +9.d0*vely(i, j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely&
&       (i-1, j)+9.d0*vely(i, j)-vely(i+1, j))-(-vely(i-2, j+1)+9.d0*&
&       vely(i-1, j+1)+9.d0*vely(i, j+1)-vely(i+1, j+1)))
      val_o = ccross*(-(-vely(i-2, j-1)+9.d0*vely(i-1, j-1)+9.d0*vely(i&
&       , j-1)-vely(i+1, j-1))+7.d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+&
&       9.d0*vely(i, j)-vely(i+1, j))+7.d0*(-vely(i-2, j+1)+9.d0*vely(i-&
&       1, j+1)+9.d0*vely(i, j+1)-vely(i+1, j+1))-(-vely(i-2, j+2)+9.d0*&
&       vely(i-1, j+2)+9.d0*vely(i, j+2)-vely(i+1, j+2)))
      vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = twentyfourth*(-velz(i+1, j)+26.d0*velz(i, j)-velz(i-1, j))
      val_s = twentyfourth*(-velz(i, j)+26.d0*velz(i-1, j)-velz(i-2, j))
      val_e = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-1, j-2)+9.d0*velz(i&
&       , j-2)-velz(i+1, j-2))+7.d0*(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)&
&       +9.d0*velz(i, j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz&
&       (i-1, j)+9.d0*velz(i, j)-velz(i+1, j))-(-velz(i-2, j+1)+9.d0*&
&       velz(i-1, j+1)+9.d0*velz(i, j+1)-velz(i+1, j+1)))
      val_o = ccross*(-(-velz(i-2, j-1)+9.d0*velz(i-1, j-1)+9.d0*velz(i&
&       , j-1)-velz(i+1, j-1))+7.d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+&
&       9.d0*velz(i, j)-velz(i+1, j))+7.d0*(-velz(i-2, j+1)+9.d0*velz(i-&
&       1, j+1)+9.d0*velz(i, j+1)-velz(i+1, j+1))-(-velz(i-2, j+2)+9.d0*&
&       velz(i-1, j+2)+9.d0*velz(i, j+2)-velz(i+1, j+2)))
      wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = twentyfourth*(-tloc(i+1, j)+26.d0*tloc(i, j)-tloc(i-1, j))
      val_s = twentyfourth*(-tloc(i, j)+26.d0*tloc(i-1, j)-tloc(i-2, j))
      val_e = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-1, j-2)+9.d0*tloc(i&
&       , j-2)-tloc(i+1, j-2))+7.d0*(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)&
&       +9.d0*tloc(i, j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc&
&       (i-1, j)+9.d0*tloc(i, j)-tloc(i+1, j))-(-tloc(i-2, j+1)+9.d0*&
&       tloc(i-1, j+1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1)))
      val_o = ccross*(-(-tloc(i-2, j-1)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i&
&       , j-1)-tloc(i+1, j-1))+7.d0*(-tloc(i-2, j)+9.d0*tloc(i-1, j)+&
&       9.d0*tloc(i, j)-tloc(i+1, j))+7.d0*(-tloc(i-2, j+1)+9.d0*tloc(i-&
&       1, j+1)+9.d0*tloc(i, j+1)-tloc(i+1, j+1))-(-tloc(i-2, j+2)+9.d0*&
&       tloc(i-1, j+2)+9.d0*tloc(i, j+2)-tloc(i+1, j+2)))
      tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
!
! Computation of viscous fluxes
!
      uu = 0.0625d0*(-velx(i-2, j)+9.d0*velx(i-1, j)+9.d0*velx(i, j)-&
&       velx(i+1, j))
      vv = 0.0625d0*(-vely(i-2, j)+9.d0*vely(i-1, j)+9.d0*vely(i, j)-&
&       vely(i+1, j))
      ww = 0.0625d0*(-velz(i-2, j)+9.d0*velz(i-1, j)+9.d0*velz(i, j)-&
&       velz(i+1, j))
!
      mmu = 0.0625d0*(-mu(i-2, j)+9.d0*mu(i-1, j)+9.d0*mu(i, j)-mu(i+1, &
&       j))
      lambda = mmu*cpprandtl
!
      fvrou1 = twothird*mmu*(two*ux-vy)
      fvrov1 = mmu*(uy+vx)
      fvrow1 = mmu*wx
! fvroe1 = (lambda*tx + uu*fvrou1 + vv*fvrov1)
!
      gvrou1 = mmu*(uy+vx)
      gvrov1 = twothird*mmu*(-ux+two*vy)
      gvrow1 = mmu*wy
! gvroe1 = (lambda*ty + uu*gvrou1 + vv*gvrov1)
!!  fvrou1 = TWOTHIRD*mmu*( TWO*ux -     vy  -   wz  )
!!  fvrov1 =          mmu*(     uy +     vx          )
!!  fvrow1 =          mmu*(     uz           +   wx  )
!!  fvroe1 = lambda*tx + uu*fvrou1 + vv*fvrov1 + ww * fvrow1
!!  !
!!  gvrou1 =          mmu*(     uy +     vx          )
!!  gvrov1 = TWOTHIRD*mmu*(    -ux + TWO*vy   -  wz  )
!!  gvrow1 =          mmu*(              vz   +  wy  )
!!  gvroe1 = lambda*ty + uu*gvrou1 + vv*gvrov1 + ww * gvrow1
! grad for viscous fluxes o4 - 5p
!
! for coef ref Zhing et al, JCP2000 ou Shen et al AIAAP 2008
! 1/16 = 0.0625 ccross = 1/12*1/16
! TWENTYFOURTH = ONE/24.d0
! ccross = TWELFTH*0.0625d0
      volm1 = volf(i, j, 2)
      nx_n = half*(nx(i+1, j-1, 1)+nx(i+1, j, 1))
      nx_s = -(half*(nx(i, j-1, 1)+nx(i, j, 1)))
      nx_o = half*(nx(i, j+1, 2)+nx(i, j, 2))
      nx_e = -(half*(nx(i, j-1, 2)+nx(i, j, 2)))
!
      ny_n = half*(ny(i+1, j-1, 1)+ny(i+1, j, 1))
      ny_s = -(half*(ny(i, j-1, 1)+ny(i, j, 1)))
      ny_o = half*(ny(i, j+1, 2)+ny(i, j, 2))
      ny_e = -(half*(ny(i, j-1, 2)+ny(i, j, 2)))
      val_n = ccross*(-(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+9.d0*velx(i-&
&       1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0&
&       *velx(i, j)-velx(i, j+1))+7.d0*(-velx(i+1, j-2)+9.d0*velx(i+1, j&
&       -1)+9.d0*velx(i+1, j)-velx(i+1, j+1))-(-velx(i+2, j-2)+9.d0*velx&
&       (i+2, j-1)+9.d0*velx(i+2, j)-velx(i+2, j+1)))
      val_s = ccross*(-(-velx(i-2, j-2)+9.d0*velx(i-2, j-1)+9.d0*velx(i-&
&       2, j)-velx(i-2, j+1))+7.d0*(-velx(i-1, j-2)+9.d0*velx(i-1, j-1)+&
&       9.d0*velx(i-1, j)-velx(i-1, j+1))+7.d0*(-velx(i, j-2)+9.d0*velx(&
&       i, j-1)+9.d0*velx(i, j)-velx(i, j+1))-(-velx(i+1, j-2)+9.d0*velx&
&       (i+1, j-1)+9.d0*velx(i+1, j)-velx(i+1, j+1)))
      val_e = twentyfourth*(-velx(i, j)+26.d0*velx(i, j-1)-velx(i, j-2))
      val_o = twentyfourth*(-velx(i, j+1)+26.d0*velx(i, j)-velx(i, j-1))
      ad_save = ux
      ux = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save0 = uy
      uy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = ccross*(-(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+9.d0*vely(i-&
&       1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0&
&       *vely(i, j)-vely(i, j+1))+7.d0*(-vely(i+1, j-2)+9.d0*vely(i+1, j&
&       -1)+9.d0*vely(i+1, j)-vely(i+1, j+1))-(-vely(i+2, j-2)+9.d0*vely&
&       (i+2, j-1)+9.d0*vely(i+2, j)-vely(i+2, j+1)))
      val_s = ccross*(-(-vely(i-2, j-2)+9.d0*vely(i-2, j-1)+9.d0*vely(i-&
&       2, j)-vely(i-2, j+1))+7.d0*(-vely(i-1, j-2)+9.d0*vely(i-1, j-1)+&
&       9.d0*vely(i-1, j)-vely(i-1, j+1))+7.d0*(-vely(i, j-2)+9.d0*vely(&
&       i, j-1)+9.d0*vely(i, j)-vely(i, j+1))-(-vely(i+1, j-2)+9.d0*vely&
&       (i+1, j-1)+9.d0*vely(i+1, j)-vely(i+1, j+1)))
      val_e = twentyfourth*(-vely(i, j)+26.d0*vely(i, j-1)-vely(i, j-2))
      val_o = twentyfourth*(-vely(i, j+1)+26.d0*vely(i, j)-vely(i, j-1))
      ad_save1 = vx
      vx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save2 = vy
      vy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = ccross*(-(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+9.d0*velz(i-&
&       1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0&
&       *velz(i, j)-velz(i, j+1))+7.d0*(-velz(i+1, j-2)+9.d0*velz(i+1, j&
&       -1)+9.d0*velz(i+1, j)-velz(i+1, j+1))-(-velz(i+2, j-2)+9.d0*velz&
&       (i+2, j-1)+9.d0*velz(i+2, j)-velz(i+2, j+1)))
      val_s = ccross*(-(-velz(i-2, j-2)+9.d0*velz(i-2, j-1)+9.d0*velz(i-&
&       2, j)-velz(i-2, j+1))+7.d0*(-velz(i-1, j-2)+9.d0*velz(i-1, j-1)+&
&       9.d0*velz(i-1, j)-velz(i-1, j+1))+7.d0*(-velz(i, j-2)+9.d0*velz(&
&       i, j-1)+9.d0*velz(i, j)-velz(i, j+1))-(-velz(i+1, j-2)+9.d0*velz&
&       (i+1, j-1)+9.d0*velz(i+1, j)-velz(i+1, j+1)))
      val_e = twentyfourth*(-velz(i, j)+26.d0*velz(i, j-1)-velz(i, j-2))
      val_o = twentyfourth*(-velz(i, j+1)+26.d0*velz(i, j)-velz(i, j-1))
      ad_save3 = wx
      wx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save4 = wy
      wy = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      val_n = ccross*(-(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+9.d0*tloc(i-&
&       1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(i, j-1)+9.d0&
&       *tloc(i, j)-tloc(i, j+1))+7.d0*(-tloc(i+1, j-2)+9.d0*tloc(i+1, j&
&       -1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1))-(-tloc(i+2, j-2)+9.d0*tloc&
&       (i+2, j-1)+9.d0*tloc(i+2, j)-tloc(i+2, j+1)))
      val_s = ccross*(-(-tloc(i-2, j-2)+9.d0*tloc(i-2, j-1)+9.d0*tloc(i-&
&       2, j)-tloc(i-2, j+1))+7.d0*(-tloc(i-1, j-2)+9.d0*tloc(i-1, j-1)+&
&       9.d0*tloc(i-1, j)-tloc(i-1, j+1))+7.d0*(-tloc(i, j-2)+9.d0*tloc(&
&       i, j-1)+9.d0*tloc(i, j)-tloc(i, j+1))-(-tloc(i+1, j-2)+9.d0*tloc&
&       (i+1, j-1)+9.d0*tloc(i+1, j)-tloc(i+1, j+1)))
      val_e = twentyfourth*(-tloc(i, j)+26.d0*tloc(i, j-1)-tloc(i, j-2))
      val_o = twentyfourth*(-tloc(i, j+1)+26.d0*tloc(i, j)-tloc(i, j-1))
      ad_save5 = tx
      tx = (val_n*nx_n+val_s*nx_s+val_o*nx_o+val_e*nx_e)*volm1
      ad_save6 = ty
      ty = (val_n*ny_n+val_s*ny_s+val_o*ny_o+val_e*ny_e)*volm1
      ad_save7 = uu
      uu = 0.0625d0*(-velx(i, j-2)+9.d0*velx(i, j-1)+9.d0*velx(i, j)-&
&       velx(i, j+1))
      ad_save8 = vv
      vv = 0.0625d0*(-vely(i, j-2)+9.d0*vely(i, j-1)+9.d0*vely(i, j)-&
&       vely(i, j+1))
      ad_save9 = ww
      ww = 0.0625d0*(-velz(i, j-2)+9.d0*velz(i, j-1)+9.d0*velz(i, j)-&
&       velz(i, j+1))
!
      ad_save10 = mmu
      mmu = 0.0625d0*(-mu(i, j-2)+9.d0*mu(i, j-1)+9.d0*mu(i, j)-mu(i, j+&
&       1))
      ad_save11 = lambda
      lambda = mmu*cpprandtl
!
      fvrou2 = twothird*mmu*(two*ux-vy)
      fvrov2 = mmu*(uy+vx)
      fvrow2 = mmu*wx
! fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2)
      gvrou2 = mmu*(uy+vx)
      gvrov2 = twothird*mmu*(-ux+two*vy)
      gvrow2 = mmu*wy
! gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2)
!!  fvrou2 = TWOTHIRD*mmu*( TWO*ux -     vy  -  wz  )
!!  fvrov2 =          mmu*(     uy +     vx         )
!!  fvrow2 =          mmu*(     uz           +  wx  )
!!  fvroe2 = (lambda*tx + uu*fvrou2 + vv*fvrov2 + ww * fvrow2)
!!
!!  gvrou2 =          mmu*(     uy +     vx       )
!!  gvrov2 = TWOTHIRD*mmu*(    -ux + TWO*vy -  wz )
!!  gvrow2 =          mmu*(              vz +  wy )
!!  gvroe2 = (lambda*ty + uu*gvrou2 + vv*gvrov2 + ww*gvrow2)
! #include "rhs/spectralradius_i.F"
! correction Rossow JCP 2000
!1st direction
      rhomr = w(i, j, 1)
      ur = w(i, j, 2)/rhomr
      vr = w(i, j, 3)/rhomr
      c2r = gam*rgaz*tloc(i, j)
!
      rhoml = w(i-1, j, 1)
      ul = w(i-1, j, 2)/rhoml
      vl = w(i-1, j, 3)/rhoml
      c2l = gam*rgaz*tloc(i-1, j)
!
      r = SQRT(rhomr/rhoml)
      rr = one/(one+r)
      omrr = one - rr
!
      u = ul*rr + ur*omrr
      v = vl*rr + vr*omrr
!
      c2x = c2l*rr + c2r*omrr
      vn2 = u*u + v*v
      IF (vn2/c2x .GT. one) THEN
        ad_branch = 0
        mach2 = one
      ELSE
        mach2 = vn2/c2x
        ad_branch = 1
      END IF
      alpha = half*(one-mach2)
      cprim = alpha*alpha*vn2 + mach2*c2x
      nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
      x1 = nx(i, j, 1)*u + ny(i, j, 1)*v
      IF (x1 .GE. 0.) THEN
        ab = x1
        ad_branch0 = 0
      ELSE
        ab = -x1
        ad_branch0 = 1
      END IF
      sq = SQRT(cprim*nx2)
!
      rspec = ab + sq
      IF (p(i-1, j) - two*p(i, j) + p(i+1, j) .GE. 0.) THEN
        abs0 = p(i-1, j) - two*p(i, j) + p(i+1, j)
        ad_branch1 = 1
      ELSE
        abs0 = -(p(i-1, j)-two*p(i, j)+p(i+1, j))
        ad_branch1 = 0
      END IF
      x12 = p(i-1, j) + two*p(i, j) + p(i+1, j)
      IF (x12 .GE. 0.) THEN
        abs22 = x12
        ad_branch2 = 0
      ELSE
        abs22 = -x12
        ad_branch2 = 1
      END IF
!
!1st direction
      k_sensor1 = abs0/abs22
      IF (p(i-2, j) - two*p(i-1, j) + p(i, j) .GE. 0.) THEN
        abs1 = p(i-2, j) - two*p(i-1, j) + p(i, j)
        ad_branch3 = 1
      ELSE
        abs1 = -(p(i-2, j)-two*p(i-1, j)+p(i, j))
        ad_branch3 = 0
      END IF
      x13 = p(i-2, j) + two*p(i-1, j) + p(i, j)
      IF (x13 .GE. 0.) THEN
        abs23 = x13
        ad_branch4 = 0
      ELSE
        abs23 = -x13
        ad_branch4 = 1
      END IF
      k_sensor2 = abs1/abs23
      divu = gradu(i, j, 1) + gradv(i, j, 2)
      divu2 = divu*divu
      vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j&
&       , 2))
      ducros1 = divu2/(divu2+vort2+1d-15)
      dxm1 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
      divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
      ad_save12 = divu2
      divu2 = divu*divu
      vort2 = (gradv(i-1, j, 1)-gradu(i-1, j, 2))*(gradv(i-1, j, 1)-&
&       gradu(i-1, j, 2))
      ducros2 = divu2/(divu2+vort2+1d-15)
      dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
      IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
        coef = k_sensor2*ducros2*dxm2
        ad_branch5 = 0
      ELSE
        coef = k_sensor1*ducros1*dxm1
        ad_branch5 = 1
      END IF
!     ! extension of shock capturing
!
!    k_sensor1 = ABS(p(i,j) - TWO*p(i+1,j) + p(i+2,j)) / &
!                ABS(p(i,j) + TWO*p(i+1,j) + p(i+2,j))
!
!    k_sensor2 = ABS(p(i-3,j) - TWO*p(i-2,j) + p(i-1,j)) / &
!                ABS(p(i-3,j) + TWO*p(i-2,j) + p(i-1,j))
!
!    divu2     = (gradu(i+1,j,1)+gradv(i+1,j,2)) * (gradu(i+1,j,1)+gradv(i+1,j,2))
!    vort2     = (gradv(i+1,j,1)-gradu(i+1,j,2)) * (gradv(i+1,j,1)-gradu(i+1,j,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i-2,j,1)+gradv(i-2,j,2)) * (gradu(i-2,j,1)+gradv(i-2,j,2))
!    vort2     = (gradv(i-2,j,1)-gradu(i-2,j,2)) * (gradv(i-2,j,1)-gradu(i-2,j,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                      k_sensor2*ducros2, coef)
!
      eps2 = k2*coef
      IF (zero .LT. k4 - 12.d0*eps2) THEN
        eps4 = k4 - 12.d0*eps2
        ad_branch6 = 0
      ELSE
        ad_branch6 = 1
        eps4 = zero
      END IF
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_diri.F"
!     endif
! #include "rhs/spectralradius_j.F"
! correction Rossow JCP 2000
!2st direction
      rhomr = w(i, j, 1)
      ad_save13 = ur
      ur = w(i, j, 2)/rhomr
      ad_save14 = vr
      vr = w(i, j, 3)/rhomr
      c2r = gam*rgaz*tloc(i, j)
!
      rhoml = w(i, j-1, 1)
      ul = w(i, j-1, 2)/rhoml
      vl = w(i, j-1, 3)/rhoml
      c2l = gam*rgaz*tloc(i, j-1)
!
      ad_save15 = r
      r = SQRT(rhomr/rhoml)
      rr = one/(one+r)
      omrr = one - rr
!
      ad_save16 = u
      u = ul*rr + ur*omrr
      ad_save17 = v
      v = vl*rr + vr*omrr
!
      c2x = c2l*rr + c2r*omrr
      nx2 = nx(i, j, 2)*nx(i, j, 2) + ny(i, j, 2)*ny(i, j, 2)
      vn2 = u*u + v*v
      IF (vn2/c2x .GT. one) THEN
        ad_save18 = mach2
        mach2 = one
        ad_branch7 = 0
      ELSE
        ad_save19 = mach2
        mach2 = vn2/c2x
        ad_branch7 = 1
      END IF
      ad_save20 = alpha
      alpha = half*(one-mach2)
      cprim = alpha*alpha*vn2 + mach2*c2x
      x2 = nx(i, j, 2)*u + ny(i, j, 2)*v
      IF (x2 .GE. 0.) THEN
        ab = x2
        ad_branch8 = 0
      ELSE
        ab = -x2
        ad_branch8 = 1
      END IF
      ad_save21 = sq
      sq = SQRT(cprim*nx2)
!
      ad_save22 = rspec
      rspec = ab + sq
      IF (p(i, j-1) - two*p(i, j) + p(i, j+1) .GE. 0.) THEN
        abs2 = p(i, j-1) - two*p(i, j) + p(i, j+1)
        ad_branch9 = 1
      ELSE
        abs2 = -(p(i, j-1)-two*p(i, j)+p(i, j+1))
        ad_branch9 = 0
      END IF
      x14 = p(i, j-1) + two*p(i, j) + p(i, j+1)
      IF (x14 .GE. 0.) THEN
        abs24 = x14
        ad_branch10 = 0
      ELSE
        abs24 = -x14
        ad_branch10 = 1
      END IF
!
! 2nd direction
      k_sensor1 = abs2/abs24
      IF (p(i, j-2) - two*p(i, j-1) + p(i, j) .GE. 0.) THEN
        abs3 = p(i, j-2) - two*p(i, j-1) + p(i, j)
        ad_branch11 = 1
      ELSE
        abs3 = -(p(i, j-2)-two*p(i, j-1)+p(i, j))
        ad_branch11 = 0
      END IF
      x15 = p(i, j-2) + two*p(i, j-1) + p(i, j)
      IF (x15 .GE. 0.) THEN
        abs25 = x15
        ad_branch12 = 0
      ELSE
        abs25 = -x15
        ad_branch12 = 1
      END IF
      k_sensor2 = abs3/abs25
!     ducros1 is done in dissipation_ducros_x
      divu = gradu(i, j-1, 1) + gradv(i, j-1, 2)
      divu2 = divu*divu
      ad_save23 = vort2
      vort2 = (gradv(i, j-1, 1)-gradu(i, j-1, 2))*(gradv(i, j-1, 1)-&
&       gradu(i, j-1, 2))
      ducros2 = divu2/(divu2+vort2+1d-15)
!sq = sound/dx
      ad_save24 = dxm2
      dxm2 = half*(one-TANH(2.5d0+10.d0*vol(i, j)/(sq+1d-15)*divu))
      IF (k_sensor1*ducros1*dxm1 .LT. k_sensor2*ducros2*dxm2) THEN
        coef = k_sensor2*ducros2*dxm2
        ad_branch13 = 0
      ELSE
        coef = k_sensor1*ducros1*dxm1
        ad_branch13 = 1
      END IF
! extension of shock capturing
!    k_sensor1 = ABS(p(i,j) - TWO*p(i,j+1) + p(i,j+2)) / &
!                ABS(p(i,j) + TWO*p(i,j+1) + p(i,j+2))
!
!    k_sensor2 = ABS(p(i,j-3) - TWO*p(i,j-2) + p(i,j-1)) / &
!                ABS(p(i,j-3) + TWO*p(i,j-2) + p(i,j-1))
!
!    divu2     = (gradu(i,j+1,1)+gradv(i,j+1,2)) * (gradu(i,j+1,1)+gradv(i,j+1,2))
!    vort2     = (gradv(i,j+1,1)-gradu(i,j+1,2)) * (gradv(i,j+1,1)-gradu(i,j+1,2))
!    ducros1   = divu2/(divu2+vort2+1d-15)
!
!    divu2     = (gradu(i,j-2,1)+gradv(i,j-2,2)) * (gradu(i,j-2,1)+gradv(i,j-2,2))
!    vort2     = (gradv(i,j-2,1)-gradu(i,j-2,2)) * (gradv(i,j-2,1)-gradu(i,j-2,2))
!    ducros2   = divu2/(divu2+vort2+1d-15)
!
!    coef      = MAX( k_sensor1*ducros1, &
!                     k_sensor2*ducros2, coef)
      ad_save25 = eps2
      eps2 = k2*coef
      IF (zero .LT. k4 - 12.d0*eps2) THEN
        ad_save26 = eps4
        eps4 = k4 - 12.d0*eps2
        ad_branch14 = 0
      ELSE
        ad_save27 = eps4
        eps4 = zero
        ad_branch14 = 1
      END IF
      diffro = half*(w(i, j, 1)-w(i, j-1, 1))
      diffrou = half*(w(i, j, 2)-w(i, j-1, 2))
      diffrov = half*(w(i, j, 3)-w(i, j-1, 3))
      diffrow = half*(w(i, j, 4)-w(i, j-1, 4))
      diffroe = half*(w(i, j, 5)-w(i, j-1, 5))
!
!
!     if (eps4.gt.1.d-12) then
! #include "rhs/wiggle_dirj.F"
!     endif
!
      sc1 = nx(i, j, 1)
      sc2 = ny(i, j, 1)
      sn = SQRT(sc1*sc1 + sc2*sc2)
      invsn = one/sn
      nxloc = sc1*invsn
      nyloc = sc2*invsn
!
!
!
! hn(i,j,4,1) = ZERO
!
      sc1 = nx(i, j, 2)
      sc2 = ny(i, j, 2)
      ad_save28 = sn
      sn = SQRT(sc1*sc1 + sc2*sc2)
      invsn = one/sn
      ad_save29 = nxloc
      nxloc = sc1*invsn
      ad_save30 = nyloc
      nyloc = sc2*invsn
!
!
!
! hn(i,j,4,2) = ZERO
!
      fxroe2b = hnb(i, j, 5, 2)
      dissroe2b = -hnb(i, j, 5, 2)
      fvroe2b = -(nxloc*sn*hnb(i, j, 5, 2))
      gvroe2b = -(nyloc*sn*hnb(i, j, 5, 2))
      hnb(i, j, 5, 2) = 0.0_8
      fxrow2b = hnb(i, j, 4, 2)
      dissrow2b = -hnb(i, j, 4, 2)
      fvrow2b = -(nxloc*sn*hnb(i, j, 4, 2))
      gvrow2b = -(nyloc*sn*hnb(i, j, 4, 2))
      hnb(i, j, 4, 2) = 0.0_8
      fxrov2b = hnb(i, j, 3, 2)
      dissrov2b = -hnb(i, j, 3, 2)
      fvrov2b = -(nxloc*sn*hnb(i, j, 3, 2))
      gvrov2b = -(nyloc*sn*hnb(i, j, 3, 2))
      hnb(i, j, 3, 2) = 0.0_8
      fxrou2b = hnb(i, j, 2, 2)
      dissrou2b = -hnb(i, j, 2, 2)
      fvrou2b = -(nxloc*sn*hnb(i, j, 2, 2))
      gvrou2b = -(nyloc*sn*hnb(i, j, 2, 2))
      hnb(i, j, 2, 2) = 0.0_8
      fxro2b = hnb(i, j, 1, 2)
      dissro2b = -hnb(i, j, 1, 2)
      hnb(i, j, 1, 2) = 0.0_8
      nyloc = ad_save30
      nxloc = ad_save29
      sn = ad_save28
      fxroe1b = hnb(i, j, 5, 1)
      dissroe1b = -hnb(i, j, 5, 1)
      fvroe1b = -(nxloc*sn*hnb(i, j, 5, 1))
      gvroe1b = -(nyloc*sn*hnb(i, j, 5, 1))
      hnb(i, j, 5, 1) = 0.0_8
      fxrow1b = hnb(i, j, 4, 1)
      dissrow1b = -hnb(i, j, 4, 1)
      fvrow1b = -(nxloc*sn*hnb(i, j, 4, 1))
      gvrow1b = -(nyloc*sn*hnb(i, j, 4, 1))
      hnb(i, j, 4, 1) = 0.0_8
      fxrov1b = hnb(i, j, 3, 1)
      dissrov1b = -hnb(i, j, 3, 1)
      fvrov1b = -(nxloc*sn*hnb(i, j, 3, 1))
      gvrov1b = -(nyloc*sn*hnb(i, j, 3, 1))
      hnb(i, j, 3, 1) = 0.0_8
      fxrou1b = hnb(i, j, 2, 1)
      dissrou1b = -hnb(i, j, 2, 1)
      fvrou1b = -(nxloc*sn*hnb(i, j, 2, 1))
      gvrou1b = -(nyloc*sn*hnb(i, j, 2, 1))
      hnb(i, j, 2, 1) = 0.0_8
      fxro1b = hnb(i, j, 1, 1)
      dissro1b = -hnb(i, j, 1, 1)
      hnb(i, j, 1, 1) = 0.0_8
      rspecb = (eps2*diffroe+eps4*predroe2)*dissroe2b + (eps2*diffrow+&
&       eps4*predrow2)*dissrow2b + (eps2*diffrov+eps4*predrov2)*&
&       dissrov2b + (eps2*diffrou+eps4*predrou2)*dissrou2b + (eps2*&
&       diffro+eps4*predro2)*dissro2b
      tempb1 = rspec*dissroe2b
      eps2b = diffroe*tempb1
      diffroeb = eps2*tempb1
      eps4b = predroe2*tempb1
      predroe2b = eps4*tempb1
      tempb1 = rspec*dissrow2b
      eps2b = eps2b + diffrow*tempb1
      diffrowb = eps2*tempb1
      eps4b = eps4b + predrow2*tempb1
      predrow2b = eps4*tempb1
      tempb1 = rspec*dissrov2b
      eps2b = eps2b + diffrov*tempb1
      diffrovb = eps2*tempb1
      eps4b = eps4b + predrov2*tempb1
      predrov2b = eps4*tempb1
      tempb1 = rspec*dissrou2b
      eps2b = eps2b + diffrou*tempb1
      diffroub = eps2*tempb1
      eps4b = eps4b + predrou2*tempb1
      predrou2b = eps4*tempb1
      tempb1 = rspec*dissro2b
      eps2b = eps2b + diffro*tempb1
      diffrob = eps2*tempb1
      eps4b = eps4b + predro2*tempb1
      predro2b = eps4*tempb1
      wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
      wb(i, j-1, 5) = wb(i, j-1, 5) - half*diffroeb
      wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
      wb(i, j-1, 4) = wb(i, j-1, 4) - half*diffrowb
      wb(i, j, 3) = wb(i, j, 3) + half*diffrovb
      wb(i, j-1, 3) = wb(i, j-1, 3) - half*diffrovb
      wb(i, j, 2) = wb(i, j, 2) + half*diffroub
      wb(i, j-1, 2) = wb(i, j-1, 2) - half*diffroub
      wb(i, j, 1) = wb(i, j, 1) + half*diffrob
      wb(i, j-1, 1) = wb(i, j-1, 1) - half*diffrob
      IF (ad_branch14 .EQ. 0) THEN
        eps4 = ad_save26
        eps2b = eps2b - 12.d0*eps4b
      ELSE
        eps4 = ad_save27
      END IF
      eps2 = ad_save25
      coefb = k2*eps2b
      IF (ad_branch13 .EQ. 0) THEN
        k_sensor2b = ducros2*dxm2*coefb
        ducros2b = k_sensor2*dxm2*coefb
        dxm2b = k_sensor2*ducros2*coefb
        dxm1b = 0.0_8
        k_sensor1b = 0.0_8
        ducros1b = 0.0_8
      ELSE
        k_sensor1b = ducros1*dxm1*coefb
        ducros1b = k_sensor1*dxm1*coefb
        dxm1b = k_sensor1*ducros1*coefb
        dxm2b = 0.0_8
        k_sensor2b = 0.0_8
        ducros2b = 0.0_8
      END IF
      dxm2 = ad_save24
      temp1 = divu/(sq+1d-15)
      temp0 = 10.d0*vol(i, j)
      tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&       1d-15))
      divub = tempb1
      sqb = -(temp1*tempb1)
      tempb1 = ducros2b/(divu2+vort2+1d-15)
      tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
      divu2b = tempb1 + tempb0
      vort2b = tempb0
      vort2 = ad_save23
      tempb1 = 2*(gradv(i, j-1, 1)-gradu(i, j-1, 2))*vort2b
      gradvb(i, j-1, 1) = gradvb(i, j-1, 1) + tempb1
      gradub(i, j-1, 2) = gradub(i, j-1, 2) - tempb1
      divub = divub + 2*divu*divu2b
      gradub(i, j-1, 1) = gradub(i, j-1, 1) + divub
      gradvb(i, j-1, 2) = gradvb(i, j-1, 2) + divub
      abs3b = k_sensor2b/abs25
      abs25b = -(abs3*k_sensor2b/abs25**2)
      IF (ad_branch12 .EQ. 0) THEN
        x15b = abs25b
      ELSE
        x15b = -abs25b
      END IF
      pb(i, j-2) = pb(i, j-2) + x15b
      pb(i, j-1) = pb(i, j-1) + two*x15b
      pb(i, j) = pb(i, j) + x15b
      IF (ad_branch11 .EQ. 0) THEN
        pb(i, j-1) = pb(i, j-1) + two*abs3b
        pb(i, j-2) = pb(i, j-2) - abs3b
        pb(i, j) = pb(i, j) - abs3b
      ELSE
        pb(i, j-2) = pb(i, j-2) + abs3b
        pb(i, j-1) = pb(i, j-1) - two*abs3b
        pb(i, j) = pb(i, j) + abs3b
      END IF
      abs2b = k_sensor1b/abs24
      abs24b = -(abs2*k_sensor1b/abs24**2)
      IF (ad_branch10 .EQ. 0) THEN
        x14b = abs24b
      ELSE
        x14b = -abs24b
      END IF
      pb(i, j-1) = pb(i, j-1) + x14b
      pb(i, j) = pb(i, j) + two*x14b
      pb(i, j+1) = pb(i, j+1) + x14b
      IF (ad_branch9 .EQ. 0) THEN
        pb(i, j) = pb(i, j) + two*abs2b
        pb(i, j-1) = pb(i, j-1) - abs2b
        pb(i, j+1) = pb(i, j+1) - abs2b
      ELSE
        pb(i, j-1) = pb(i, j-1) + abs2b
        pb(i, j) = pb(i, j) - two*abs2b
        pb(i, j+1) = pb(i, j+1) + abs2b
      END IF
      rspec = ad_save22
      abb = rspecb
      sqb = sqb + rspecb
      sq = ad_save21
      IF (nx2*cprim .EQ. 0.0) THEN
        cprimb = 0.0_8
      ELSE
        cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
      END IF
      IF (ad_branch8 .EQ. 0) THEN
        x2b = abb
      ELSE
        x2b = -abb
      END IF
      ub = nx(i, j, 2)*x2b
      vb = ny(i, j, 2)*x2b
      alphab = 2*alpha*vn2*cprimb
      vn2b = alpha**2*cprimb
      mach2b = c2x*cprimb - half*alphab
      c2xb = mach2*cprimb
      alpha = ad_save20
      IF (ad_branch7 .EQ. 0) THEN
        mach2 = ad_save18
      ELSE
        mach2 = ad_save19
        vn2b = vn2b + mach2b/c2x
        c2xb = c2xb - vn2*mach2b/c2x**2
      END IF
      diffro = half*(w(i, j, 1)-w(i-1, j, 1))
      diffrou = half*(w(i, j, 2)-w(i-1, j, 2))
      diffrov = half*(w(i, j, 3)-w(i-1, j, 3))
      diffrow = half*(w(i, j, 4)-w(i-1, j, 4))
      ub = ub + 2*u*vn2b
      vb = vb + 2*v*vn2b
      c2lb = rr*c2xb
      c2rb = omrr*c2xb
      omrrb = c2r*c2xb + vr*vb + ur*ub
      rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
      v = ad_save17
      vlb = rr*vb
      vrb = omrr*vb
      u = ad_save16
      ulb = rr*ub
      urb = omrr*ub
      rb = -(one*rrb/(one+r)**2)
      r = ad_save15
      IF (rhomr/rhoml .EQ. 0.0) THEN
        tempb1 = 0.0_8
      ELSE
        tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
      END IF
      rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**&
&       2
      rhomlb = -(rhomr*tempb1/rhoml) - w(i, j-1, 3)*vlb/rhoml**2 - w(i, &
&       j-1, 2)*ulb/rhoml**2
      tlocb(i, j-1) = tlocb(i, j-1) + gam*rgaz*c2lb
      wb(i, j-1, 3) = wb(i, j-1, 3) + vlb/rhoml
      wb(i, j-1, 2) = wb(i, j-1, 2) + ulb/rhoml
      wb(i, j-1, 1) = wb(i, j-1, 1) + rhomlb
      tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb
      rhoml = w(i-1, j, 1)
      rr = one/(one+r)
      vl = w(i-1, j, 3)/rhoml
      omrr = one - rr
      vr = ad_save14
      ul = w(i-1, j, 2)/rhoml
      ur = ad_save13
      diffroe = half*(w(i, j, 5)-w(i-1, j, 5))
      rspecb = (eps2*diffroe+eps4*predroe1)*dissroe1b + (eps2*diffrow+&
&       eps4*predrow1)*dissrow1b + (eps2*diffrov+eps4*predrov1)*&
&       dissrov1b + (eps2*diffrou+eps4*predrou1)*dissrou1b + (eps2*&
&       diffro+eps4*predro1)*dissro1b
      tempb1 = rspec*dissroe1b
      eps2b = diffroe*tempb1
      diffroeb = eps2*tempb1
      eps4b = predroe1*tempb1
      predroe1b = eps4*tempb1
      tempb1 = rspec*dissrow1b
      eps2b = eps2b + diffrow*tempb1
      diffrowb = eps2*tempb1
      eps4b = eps4b + predrow1*tempb1
      predrow1b = eps4*tempb1
      tempb1 = rspec*dissrov1b
      eps2b = eps2b + diffrov*tempb1
      diffrovb = eps2*tempb1
      wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + half*diffrovb
      eps4b = eps4b + predrov1*tempb1
      predrov1b = eps4*tempb1
      tempb1 = rspec*dissrou1b
      eps2b = eps2b + diffrou*tempb1
      diffroub = eps2*tempb1
      wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + half*diffroub
      rhomr = w(i, j, 1)
      eps4b = eps4b + predrou1*tempb1
      predrou1b = eps4*tempb1
      tempb1 = rspec*dissro1b
      eps2b = eps2b + diffro*tempb1
      diffrob = eps2*tempb1
      wb(i, j, 1) = wb(i, j, 1) + rhomrb + half*diffrob
      eps4b = eps4b + predro1*tempb1
      predro1b = eps4*tempb1
      wb(i, j, 5) = wb(i, j, 5) + half*diffroeb
      wb(i-1, j, 5) = wb(i-1, j, 5) - half*diffroeb
      wb(i, j, 4) = wb(i, j, 4) + half*diffrowb
      wb(i-1, j, 4) = wb(i-1, j, 4) - half*diffrowb
      wb(i-1, j, 3) = wb(i-1, j, 3) - half*diffrovb
      wb(i-1, j, 2) = wb(i-1, j, 2) - half*diffroub
      wb(i-1, j, 1) = wb(i-1, j, 1) - half*diffrob
      IF (ad_branch6 .EQ. 0) eps2b = eps2b - 12.d0*eps4b
      coefb = k2*eps2b
      divu = gradu(i-1, j, 1) + gradv(i-1, j, 2)
      divu2 = divu*divu
      k_sensor1 = abs0/abs22
      k_sensor2 = abs1/abs23
      ducros2 = divu2/(divu2+vort2+1d-15)
      IF (ad_branch5 .EQ. 0) THEN
        k_sensor2b = ducros2*dxm2*coefb
        ducros2b = k_sensor2*dxm2*coefb
        dxm2b = k_sensor2*ducros2*coefb
        k_sensor1b = 0.0_8
      ELSE
        k_sensor1b = ducros1*dxm1*coefb
        ducros1b = ducros1b + k_sensor1*dxm1*coefb
        dxm1b = dxm1b + k_sensor1*ducros1*coefb
        dxm2b = 0.0_8
        k_sensor2b = 0.0_8
        ducros2b = 0.0_8
      END IF
      temp1 = divu/(sq+1d-15)
      temp0 = 10.d0*vol(i, j)
      tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm2b/(sq+&
&       1d-15))
      divub = tempb1
      sqb = -(temp1*tempb1)
      tempb1 = ducros2b/(divu2+vort2+1d-15)
      tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
      divu2b = tempb1 + tempb0
      vort2b = tempb0
      tempb1 = 2*(gradv(i-1, j, 1)-gradu(i-1, j, 2))*vort2b
      gradvb(i-1, j, 1) = gradvb(i-1, j, 1) + tempb1
      gradub(i-1, j, 2) = gradub(i-1, j, 2) - tempb1
      vort2 = (gradv(i, j, 1)-gradu(i, j, 2))*(gradv(i, j, 1)-gradu(i, j&
&       , 2))
      divu2 = ad_save12
      divub = divub + 2*divu*divu2b
      gradub(i-1, j, 1) = gradub(i-1, j, 1) + divub
      gradvb(i-1, j, 2) = gradvb(i-1, j, 2) + divub
      divu = gradu(i, j, 1) + gradv(i, j, 2)
      temp1 = divu/(sq+1d-15)
      temp0 = 10.d0*vol(i, j)
      tempb1 = -(temp0*(1.0-TANH(temp0*temp1+2.5d0)**2)*half*dxm1b/(sq+&
&       1d-15))
      divub = tempb1
      sqb = sqb - temp1*tempb1
      tempb1 = ducros1b/(divu2+vort2+1d-15)
      tempb0 = -(divu2*tempb1/(divu2+vort2+1d-15))
      divu2b = tempb1 + tempb0
      vort2b = tempb0
      tempb1 = 2*(gradv(i, j, 1)-gradu(i, j, 2))*vort2b
      gradvb(i, j, 1) = gradvb(i, j, 1) + tempb1
      gradub(i, j, 2) = gradub(i, j, 2) - tempb1
      divub = divub + 2*divu*divu2b
      gradub(i, j, 1) = gradub(i, j, 1) + divub
      gradvb(i, j, 2) = gradvb(i, j, 2) + divub
      abs1b = k_sensor2b/abs23
      abs23b = -(abs1*k_sensor2b/abs23**2)
      IF (ad_branch4 .EQ. 0) THEN
        x13b = abs23b
      ELSE
        x13b = -abs23b
      END IF
      pb(i-2, j) = pb(i-2, j) + x13b
      pb(i-1, j) = pb(i-1, j) + two*x13b
      pb(i, j) = pb(i, j) + x13b
      IF (ad_branch3 .EQ. 0) THEN
        pb(i-1, j) = pb(i-1, j) + two*abs1b
        pb(i-2, j) = pb(i-2, j) - abs1b
        pb(i, j) = pb(i, j) - abs1b
      ELSE
        pb(i-2, j) = pb(i-2, j) + abs1b
        pb(i-1, j) = pb(i-1, j) - two*abs1b
        pb(i, j) = pb(i, j) + abs1b
      END IF
      abs0b = k_sensor1b/abs22
      abs22b = -(abs0*k_sensor1b/abs22**2)
      IF (ad_branch2 .EQ. 0) THEN
        x12b = abs22b
      ELSE
        x12b = -abs22b
      END IF
      pb(i-1, j) = pb(i-1, j) + x12b
      pb(i, j) = pb(i, j) + two*x12b
      pb(i+1, j) = pb(i+1, j) + x12b
      IF (ad_branch1 .EQ. 0) THEN
        pb(i, j) = pb(i, j) + two*abs0b
        pb(i-1, j) = pb(i-1, j) - abs0b
        pb(i+1, j) = pb(i+1, j) - abs0b
      ELSE
        pb(i-1, j) = pb(i-1, j) + abs0b
        pb(i, j) = pb(i, j) - two*abs0b
        pb(i+1, j) = pb(i+1, j) + abs0b
      END IF
      abb = rspecb
      sqb = sqb + rspecb
      c2r = gam*rgaz*tloc(i, j)
      c2l = gam*rgaz*tloc(i-1, j)
      c2x = c2l*rr + c2r*omrr
      vn2 = u*u + v*v
      nx2 = nx(i, j, 1)*nx(i, j, 1) + ny(i, j, 1)*ny(i, j, 1)
      cprim = alpha*alpha*vn2 + mach2*c2x
      IF (nx2*cprim .EQ. 0.0) THEN
        cprimb = 0.0_8
      ELSE
        cprimb = nx2*sqb/(2.0*SQRT(nx2*cprim))
      END IF
      IF (ad_branch0 .EQ. 0) THEN
        x1b = abb
      ELSE
        x1b = -abb
      END IF
      ub = nx(i, j, 1)*x1b
      vb = ny(i, j, 1)*x1b
      alphab = 2*alpha*vn2*cprimb
      vn2b = alpha**2*cprimb
      mach2b = c2x*cprimb - half*alphab
      c2xb = mach2*cprimb
      IF (ad_branch .NE. 0) THEN
        vn2b = vn2b + mach2b/c2x
        c2xb = c2xb - vn2*mach2b/c2x**2
      END IF
      fvrov2b = fvrov2b + vv*fvroe2b
      ub = ub + 2*u*vn2b
      vb = vb + 2*v*vn2b
      c2lb = rr*c2xb
      c2rb = omrr*c2xb
      omrrb = c2r*c2xb + vr*vb + ur*ub
      rrb = c2l*c2xb + vl*vb + ul*ub - omrrb
      vlb = rr*vb
      vrb = omrr*vb
      ulb = rr*ub
      urb = omrr*ub
      rb = -(one*rrb/(one+r)**2)
      IF (rhomr/rhoml .EQ. 0.0) THEN
        tempb1 = 0.0_8
      ELSE
        tempb1 = rb/(rhoml*2.0*SQRT(rhomr/rhoml))
      END IF
      rhomrb = tempb1 - w(i, j, 3)*vrb/rhomr**2 - w(i, j, 2)*urb/rhomr**&
&       2
      rhomlb = -(rhomr*tempb1/rhoml) - w(i-1, j, 3)*vlb/rhoml**2 - w(i-1&
&       , j, 2)*ulb/rhoml**2
      wb(i-1, j, 3) = wb(i-1, j, 3) + vlb/rhoml - d1*predrov1b
      wb(i-1, j, 2) = wb(i-1, j, 2) + ulb/rhoml - d1*predrou1b
      wb(i-1, j, 1) = wb(i-1, j, 1) + rhomlb - d1*predro1b
      wb(i, j, 3) = wb(i, j, 3) + vrb/rhomr + d1*predrov2b + d1*&
&       predrov1b
      wb(i, j, 2) = wb(i, j, 2) + urb/rhomr + d1*predrou2b + d1*&
&       predrou1b
      wb(i, j, 1) = wb(i, j, 1) + rhomrb + d1*predro2b + d1*predro1b
      lambdab = ty*gvroe2b + tx*fvroe2b
      tyb = lambda*gvroe2b
      uub = gvrou2*gvroe2b + fvrou2*fvroe2b
      gvrou2b = gvrou2b + uu*gvroe2b
      vvb = gvrov2*gvroe2b + fvrov2*fvroe2b
      gvrov2b = gvrov2b + vv*gvroe2b
      wwb = gvrow2*gvroe2b + fvrow2*fvroe2b
      gvrow2b = gvrow2b + ww*gvroe2b
      wyb = mmu*gvrow2b
      tempb1 = twothird*gvrov2b
      mmub = wy*gvrow2b + (two*vy-ux)*tempb1
      vyb = two*mmu*tempb1
      uxb = -(mmu*tempb1)
      uyb = mmu*gvrou2b + mmu*fvrov2b
      vxb = mmu*gvrou2b + mmu*fvrov2b
      txb = lambda*fvroe2b
      fvrou2b = fvrou2b + uu*fvroe2b
      fvrow2b = fvrow2b + ww*fvroe2b
      wxb = mmu*fvrow2b
      tempb1 = twothird*fvrou2b
      mmub = mmub + (uy+vx)*gvrou2b + wx*fvrow2b + (uy+vx)*fvrov2b + (&
&       two*ux-vy)*tempb1 + cpprandtl*lambdab
      uxb = uxb + two*mmu*tempb1
      vyb = vyb - mmu*tempb1
      lambda = ad_save11
      mmu = ad_save10
      tempb1 = 0.0625d0*mmub
      mub(i, j-1) = mub(i, j-1) + 9.d0*tempb1
      mub(i, j-2) = mub(i, j-2) - tempb1
      mub(i, j) = mub(i, j) + 9.d0*tempb1
      mub(i, j+1) = mub(i, j+1) - tempb1
      ww = ad_save9
      tempb1 = 0.0625d0*wwb
      velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb1
      velzb(i, j-2) = velzb(i, j-2) - tempb1
      velzb(i, j) = velzb(i, j) + 9.d0*tempb1
      velzb(i, j+1) = velzb(i, j+1) - tempb1
      vv = ad_save8
      tempb1 = 0.0625d0*vvb
      velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb1
      velyb(i, j-2) = velyb(i, j-2) - tempb1
      velyb(i, j) = velyb(i, j) + 9.d0*tempb1
      velyb(i, j+1) = velyb(i, j+1) - tempb1
      uu = ad_save7
      tempb1 = 0.0625d0*uub
      velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb1
      velxb(i, j-2) = velxb(i, j-2) - tempb1
      velxb(i, j) = velxb(i, j) + 9.d0*tempb1
      velxb(i, j+1) = velxb(i, j+1) - tempb1
      ty = ad_save6
      tempb1 = volm1*tyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tx = ad_save5
      tempb1 = volm1*txb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      tlocb(i, j) = tlocb(i, j) + gam*rgaz*c2rb + 26.d0*tempb1
      tlocb(i, j+1) = tlocb(i, j+1) - tempb1
      tlocb(i, j-1) = tlocb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      tlocb(i, j-1) = tlocb(i, j-1) + 26.d0*tempb1
      tlocb(i, j) = tlocb(i, j) - tempb1
      tlocb(i, j-2) = tlocb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
      tlocb(i-2, j-1) = tlocb(i-2, j-1) - 9.d0*tempb1
      tlocb(i-2, j) = tlocb(i-2, j) - 9.d0*tempb1
      tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
      tlocb(i+1, j-1) = tlocb(i+1, j-1) - 9.d0*tempb1
      tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1
      tlocb(i+1, j) = tlocb(i+1, j) - 9.d0*tempb1
      tempb1 = ccross*val_nb
      tlocb(i-1, j) = tlocb(i-1, j) + gam*rgaz*c2lb + 9.d0*tempb0 - 9.d0&
&       *tempb1
      tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      tlocb(i-1, j-2) = tlocb(i-1, j-2) + tempb1 - tempb0
      tlocb(i-1, j+1) = tlocb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      tlocb(i, j-2) = tlocb(i, j-2) - tempb - tempb0
      tlocb(i, j) = tlocb(i, j) + 9.d0*tempb + 9.d0*tempb0
      tlocb(i, j+1) = tlocb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      tlocb(i+2, j-2) = tlocb(i+2, j-2) + tempb1
      tlocb(i+2, j-1) = tlocb(i+2, j-1) - 9.d0*tempb1
      tlocb(i+2, j+1) = tlocb(i+2, j+1) + tempb1
      tlocb(i+2, j) = tlocb(i+2, j) - 9.d0*tempb1
      tlocb(i+1, j-1) = tlocb(i+1, j-1) + 9.d0*tempb
      tlocb(i+1, j-2) = tlocb(i+1, j-2) - tempb
      tlocb(i+1, j) = tlocb(i+1, j) + 9.d0*tempb
      tlocb(i+1, j+1) = tlocb(i+1, j+1) - tempb
      wy = ad_save4
      tempb1 = volm1*wyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      wx = ad_save3
      tempb1 = volm1*wxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      velzb(i, j) = velzb(i, j) + 26.d0*tempb1
      velzb(i, j+1) = velzb(i, j+1) - tempb1
      velzb(i, j-1) = velzb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      velzb(i, j-1) = velzb(i, j-1) + 26.d0*tempb1
      velzb(i, j) = velzb(i, j) - tempb1
      velzb(i, j-2) = velzb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
      velzb(i-2, j-1) = velzb(i-2, j-1) - 9.d0*tempb1
      velzb(i-2, j) = velzb(i-2, j) - 9.d0*tempb1
      velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
      velzb(i+1, j-1) = velzb(i+1, j-1) - 9.d0*tempb1
      velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1
      velzb(i+1, j) = velzb(i+1, j) - 9.d0*tempb1
      tempb1 = ccross*val_nb
      velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      velzb(i-1, j-2) = velzb(i-1, j-2) + tempb1 - tempb0
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      velzb(i-1, j+1) = velzb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      velzb(i, j-2) = velzb(i, j-2) - tempb - tempb0
      velzb(i, j) = velzb(i, j) + 9.d0*tempb + 9.d0*tempb0
      velzb(i, j+1) = velzb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      velzb(i+2, j-2) = velzb(i+2, j-2) + tempb1
      velzb(i+2, j-1) = velzb(i+2, j-1) - 9.d0*tempb1
      velzb(i+2, j+1) = velzb(i+2, j+1) + tempb1
      velzb(i+2, j) = velzb(i+2, j) - 9.d0*tempb1
      velzb(i+1, j-1) = velzb(i+1, j-1) + 9.d0*tempb
      velzb(i+1, j-2) = velzb(i+1, j-2) - tempb
      velzb(i+1, j) = velzb(i+1, j) + 9.d0*tempb
      velzb(i+1, j+1) = velzb(i+1, j+1) - tempb
      vy = ad_save2
      tempb1 = volm1*vyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      vx = ad_save1
      tempb1 = volm1*vxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      velyb(i, j) = velyb(i, j) + 26.d0*tempb1
      velyb(i, j+1) = velyb(i, j+1) - tempb1
      velyb(i, j-1) = velyb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      velyb(i, j-1) = velyb(i, j-1) + 26.d0*tempb1
      velyb(i, j) = velyb(i, j) - tempb1
      velyb(i, j-2) = velyb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
      velyb(i-2, j-1) = velyb(i-2, j-1) - 9.d0*tempb1
      velyb(i-2, j) = velyb(i-2, j) - 9.d0*tempb1
      velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
      velyb(i+1, j-1) = velyb(i+1, j-1) - 9.d0*tempb1
      velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1
      velyb(i+1, j) = velyb(i+1, j) - 9.d0*tempb1
      tempb1 = ccross*val_nb
      velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      velyb(i-1, j-2) = velyb(i-1, j-2) + tempb1 - tempb0
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      velyb(i-1, j+1) = velyb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      velyb(i, j-2) = velyb(i, j-2) - tempb - tempb0
      velyb(i, j) = velyb(i, j) + 9.d0*tempb + 9.d0*tempb0
      velyb(i, j+1) = velyb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      velyb(i+2, j-2) = velyb(i+2, j-2) + tempb1
      velyb(i+2, j-1) = velyb(i+2, j-1) - 9.d0*tempb1
      velyb(i+2, j+1) = velyb(i+2, j+1) + tempb1
      velyb(i+2, j) = velyb(i+2, j) - 9.d0*tempb1
      velyb(i+1, j-1) = velyb(i+1, j-1) + 9.d0*tempb
      velyb(i+1, j-2) = velyb(i+1, j-2) - tempb
      velyb(i+1, j) = velyb(i+1, j) + 9.d0*tempb
      velyb(i+1, j+1) = velyb(i+1, j+1) - tempb
      uy = ad_save0
      tempb1 = volm1*uyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      ux = ad_save
      tempb1 = volm1*uxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = twentyfourth*val_ob
      velxb(i, j) = velxb(i, j) + 26.d0*tempb1
      velxb(i, j+1) = velxb(i, j+1) - tempb1
      velxb(i, j-1) = velxb(i, j-1) - tempb1
      tempb1 = twentyfourth*val_eb
      velxb(i, j-1) = velxb(i, j-1) + 26.d0*tempb1
      velxb(i, j) = velxb(i, j) - tempb1
      velxb(i, j-2) = velxb(i, j-2) - tempb1
      tempb1 = ccross*val_sb
      velxb(i-2, j-2) = velxb(i-2, j-2) + tempb1
      velxb(i-2, j-1) = velxb(i-2, j-1) - 9.d0*tempb1
      velxb(i-2, j) = velxb(i-2, j) - 9.d0*tempb1
      velxb(i-2, j+1) = velxb(i-2, j+1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velxb(i+1, j-2) = velxb(i+1, j-2) + tempb1
      velxb(i+1, j-1) = velxb(i+1, j-1) - 9.d0*tempb1
      velxb(i+1, j+1) = velxb(i+1, j+1) + tempb1
      velxb(i+1, j) = velxb(i+1, j) - 9.d0*tempb1
      velxb(i, j) = velxb(i, j) + 9.d0*tempb
      tempb1 = ccross*val_nb
      velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb0 - 9.d0*tempb1
      velxb(i-1, j-2) = velxb(i-1, j-2) + tempb1 - tempb0
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0 - 9.d0*tempb1
      velxb(i-1, j+1) = velxb(i-1, j+1) + tempb1 - tempb0
      tempb0 = 7.d0*tempb1
      velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb + 9.d0*tempb0
      velxb(i, j-2) = velxb(i, j-2) - tempb - tempb0
      velxb(i, j+1) = velxb(i, j+1) - tempb - tempb0
      tempb = 7.d0*tempb1
      velxb(i+2, j-2) = velxb(i+2, j-2) + tempb1
      velxb(i+2, j-1) = velxb(i+2, j-1) - 9.d0*tempb1
      velxb(i+2, j+1) = velxb(i+2, j+1) + tempb1
      velxb(i+2, j) = velxb(i+2, j) - 9.d0*tempb1
      velxb(i+1, j-1) = velxb(i+1, j-1) + 9.d0*tempb
      velxb(i+1, j-2) = velxb(i+1, j-2) - tempb
      velxb(i+1, j+1) = velxb(i+1, j+1) - tempb
      lambdab = ty*gvroe1b + tx*fvroe1b
      tyb = lambda*gvroe1b
      uub = gvrou1*gvroe1b + fvrou1*fvroe1b
      gvrou1b = gvrou1b + uu*gvroe1b
      vvb = gvrov1*gvroe1b + fvrov1*fvroe1b
      gvrov1b = gvrov1b + vv*gvroe1b
      wwb = gvrow1*gvroe1b + fvrow1*fvroe1b
      gvrow1b = gvrow1b + ww*gvroe1b
      wyb = mmu*gvrow1b
      tempb1 = twothird*gvrov1b
      mmub = wy*gvrow1b + (two*vy-ux)*tempb1
      vyb = two*mmu*tempb1
      uxb = -(mmu*tempb1)
      txb = lambda*fvroe1b
      fvrou1b = fvrou1b + uu*fvroe1b
      fvrov1b = fvrov1b + vv*fvroe1b
      uyb = mmu*gvrou1b + mmu*fvrov1b
      vxb = mmu*gvrou1b + mmu*fvrov1b
      fvrow1b = fvrow1b + ww*fvroe1b
      wxb = mmu*fvrow1b
      tempb1 = twothird*fvrou1b
      mmub = mmub + (uy+vx)*gvrou1b + wx*fvrow1b + (uy+vx)*fvrov1b + (&
&       two*ux-vy)*tempb1 + cpprandtl*lambdab
      uxb = uxb + two*mmu*tempb1
      vyb = vyb - mmu*tempb1
      tempb1 = 0.0625d0*mmub
      mub(i-1, j) = mub(i-1, j) + 9.d0*tempb1
      mub(i-2, j) = mub(i-2, j) - tempb1
      mub(i, j) = mub(i, j) + 9.d0*tempb1
      mub(i+1, j) = mub(i+1, j) - tempb1
      tempb1 = 0.0625d0*wwb
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb1
      velzb(i-2, j) = velzb(i-2, j) - tempb1
      velzb(i, j) = velzb(i, j) + 9.d0*tempb1
      velzb(i+1, j) = velzb(i+1, j) - tempb1
      tempb1 = 0.0625d0*vvb
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb1
      velyb(i-2, j) = velyb(i-2, j) - tempb1
      velyb(i, j) = velyb(i, j) + 9.d0*tempb1
      velyb(i+1, j) = velyb(i+1, j) - tempb1
      tempb1 = 0.0625d0*uub
      velxb(i+1, j) = velxb(i+1, j) + 9.d0*tempb - tempb1
      velxb(i, j) = velxb(i, j) + 9.d0*tempb0 + 9.d0*tempb1
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1
      velxb(i-2, j) = velxb(i-2, j) - tempb1
      ny_e = -(half*(ny(i-1, j, 2)+ny(i, j, 2)))
      ny_n = half*(ny(i+1, j, 1)+ny(i, j, 1))
      ny_o = half*(ny(i-1, j+1, 2)+ny(i, j+1, 2))
      ny_s = -(half*(ny(i-1, j, 1)+ny(i, j, 1)))
      volm1 = volf(i, j, 1)
      tempb1 = volm1*tyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      nx_e = -(half*(nx(i-1, j, 2)+nx(i, j, 2)))
      nx_n = half*(nx(i+1, j, 1)+nx(i, j, 1))
      nx_o = half*(nx(i-1, j+1, 2)+nx(i, j+1, 2))
      nx_s = -(half*(nx(i-1, j, 1)+nx(i, j, 1)))
      tempb1 = volm1*txb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      tlocb(i-2, j-1) = tlocb(i-2, j-1) + tempb1
      tlocb(i-1, j-1) = tlocb(i-1, j-1) - 9.d0*tempb1
      tlocb(i, j-1) = tlocb(i, j-1) - 9.d0*tempb1
      tlocb(i+1, j-1) = tlocb(i+1, j-1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      tlocb(i-2, j+2) = tlocb(i-2, j+2) + tempb1
      tlocb(i-1, j+2) = tlocb(i-1, j+2) - 9.d0*tempb1
      tlocb(i+1, j+2) = tlocb(i+1, j+2) + tempb1
      tlocb(i, j+2) = tlocb(i, j+2) - 9.d0*tempb1
      tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb0
      tlocb(i-2, j) = tlocb(i-2, j) - tempb0
      tlocb(i, j) = tlocb(i, j) + 9.d0*tempb0
      tlocb(i+1, j) = tlocb(i+1, j) - tempb0
      tempb1 = ccross*val_eb
      tlocb(i-1, j+1) = tlocb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
      tlocb(i-2, j+1) = tlocb(i-2, j+1) + tempb1 - tempb
      tlocb(i, j+1) = tlocb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
      tlocb(i+1, j+1) = tlocb(i+1, j+1) + tempb1 - tempb
      tlocb(i-2, j-2) = tlocb(i-2, j-2) + tempb1
      tlocb(i-1, j-2) = tlocb(i-1, j-2) - 9.d0*tempb1
      tlocb(i, j-2) = tlocb(i, j-2) - 9.d0*tempb1
      tlocb(i+1, j-2) = tlocb(i+1, j-2) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      tlocb(i-1, j-1) = tlocb(i-1, j-1) + 9.d0*tempb0
      tlocb(i-2, j-1) = tlocb(i-2, j-1) - tempb0
      tlocb(i, j-1) = tlocb(i, j-1) + 9.d0*tempb0
      tlocb(i+1, j-1) = tlocb(i+1, j-1) - tempb0
      tempb1 = twentyfourth*val_sb
      tlocb(i-1, j) = tlocb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
      tlocb(i-2, j) = tlocb(i-2, j) - tempb - tempb1
      tlocb(i, j) = tlocb(i, j) + 9.d0*tempb - tempb1
      tempb1 = twentyfourth*val_nb
      tlocb(i+1, j) = tlocb(i+1, j) - tempb - tempb1
      tlocb(i, j) = tlocb(i, j) + 26.d0*tempb1
      tlocb(i-1, j) = tlocb(i-1, j) - tempb1
      tempb1 = volm1*wyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tempb1 = volm1*wxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      velzb(i-2, j-1) = velzb(i-2, j-1) + tempb1
      velzb(i-1, j-1) = velzb(i-1, j-1) - 9.d0*tempb1
      velzb(i, j-1) = velzb(i, j-1) - 9.d0*tempb1
      velzb(i+1, j-1) = velzb(i+1, j-1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velzb(i-2, j+2) = velzb(i-2, j+2) + tempb1
      velzb(i-1, j+2) = velzb(i-1, j+2) - 9.d0*tempb1
      velzb(i+1, j+2) = velzb(i+1, j+2) + tempb1
      velzb(i, j+2) = velzb(i, j+2) - 9.d0*tempb1
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb0
      velzb(i-2, j) = velzb(i-2, j) - tempb0
      velzb(i, j) = velzb(i, j) + 9.d0*tempb0
      velzb(i+1, j) = velzb(i+1, j) - tempb0
      tempb1 = ccross*val_eb
      velzb(i-1, j+1) = velzb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
      velzb(i-2, j+1) = velzb(i-2, j+1) + tempb1 - tempb
      velzb(i, j+1) = velzb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
      velzb(i+1, j+1) = velzb(i+1, j+1) + tempb1 - tempb
      velzb(i-2, j-2) = velzb(i-2, j-2) + tempb1
      velzb(i-1, j-2) = velzb(i-1, j-2) - 9.d0*tempb1
      velzb(i, j-2) = velzb(i, j-2) - 9.d0*tempb1
      velzb(i+1, j-2) = velzb(i+1, j-2) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velzb(i-1, j-1) = velzb(i-1, j-1) + 9.d0*tempb0
      velzb(i-2, j-1) = velzb(i-2, j-1) - tempb0
      velzb(i, j-1) = velzb(i, j-1) + 9.d0*tempb0
      velzb(i+1, j-1) = velzb(i+1, j-1) - tempb0
      tempb1 = twentyfourth*val_sb
      velzb(i-1, j) = velzb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
      velzb(i-2, j) = velzb(i-2, j) - tempb - tempb1
      velzb(i, j) = velzb(i, j) + 9.d0*tempb - tempb1
      tempb1 = twentyfourth*val_nb
      velzb(i+1, j) = velzb(i+1, j) - tempb - tempb1
      velzb(i, j) = velzb(i, j) + 26.d0*tempb1
      velzb(i-1, j) = velzb(i-1, j) - tempb1
      tempb1 = volm1*vyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tempb1 = volm1*vxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      velyb(i-2, j-1) = velyb(i-2, j-1) + tempb1
      velyb(i-1, j-1) = velyb(i-1, j-1) - 9.d0*tempb1
      velyb(i, j-1) = velyb(i, j-1) - 9.d0*tempb1
      velyb(i+1, j-1) = velyb(i+1, j-1) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velyb(i-2, j+2) = velyb(i-2, j+2) + tempb1
      velyb(i-1, j+2) = velyb(i-1, j+2) - 9.d0*tempb1
      velyb(i+1, j+2) = velyb(i+1, j+2) + tempb1
      velyb(i, j+2) = velyb(i, j+2) - 9.d0*tempb1
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb0
      velyb(i-2, j) = velyb(i-2, j) - tempb0
      velyb(i, j) = velyb(i, j) + 9.d0*tempb0
      velyb(i+1, j) = velyb(i+1, j) - tempb0
      tempb1 = ccross*val_eb
      velyb(i-1, j+1) = velyb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb1
      velyb(i-2, j+1) = velyb(i-2, j+1) + tempb1 - tempb
      velyb(i, j+1) = velyb(i, j+1) + 9.d0*tempb - 9.d0*tempb1
      velyb(i+1, j+1) = velyb(i+1, j+1) + tempb1 - tempb
      velyb(i-2, j-2) = velyb(i-2, j-2) + tempb1
      velyb(i-1, j-2) = velyb(i-1, j-2) - 9.d0*tempb1
      velyb(i, j-2) = velyb(i, j-2) - 9.d0*tempb1
      velyb(i+1, j-2) = velyb(i+1, j-2) + tempb1
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velyb(i-1, j-1) = velyb(i-1, j-1) + 9.d0*tempb0
      velyb(i-2, j-1) = velyb(i-2, j-1) - tempb0
      velyb(i, j-1) = velyb(i, j-1) + 9.d0*tempb0
      velyb(i+1, j-1) = velyb(i+1, j-1) - tempb0
      tempb1 = twentyfourth*val_sb
      velyb(i-1, j) = velyb(i-1, j) + 9.d0*tempb + 26.d0*tempb1
      velyb(i-2, j) = velyb(i-2, j) - tempb - tempb1
      velyb(i, j) = velyb(i, j) + 9.d0*tempb - tempb1
      tempb1 = twentyfourth*val_nb
      velyb(i+1, j) = velyb(i+1, j) - tempb - tempb1
      velyb(i, j) = velyb(i, j) + 26.d0*tempb1
      velyb(i-1, j) = velyb(i-1, j) - tempb1
      tempb1 = volm1*uyb
      val_nb = ny_n*tempb1
      val_sb = ny_s*tempb1
      val_ob = ny_o*tempb1
      val_eb = ny_e*tempb1
      tempb1 = volm1*uxb
      val_nb = val_nb + nx_n*tempb1
      val_sb = val_sb + nx_s*tempb1
      val_ob = val_ob + nx_o*tempb1
      val_eb = val_eb + nx_e*tempb1
      tempb1 = ccross*val_ob
      tempb0 = 7.d0*tempb1
      tempb = 7.d0*tempb1
      velxb(i-2, j+2) = velxb(i-2, j+2) + tempb1
      velxb(i-1, j+2) = velxb(i-1, j+2) - 9.d0*tempb1
      velxb(i+1, j+2) = velxb(i+1, j+2) + tempb1
      velxb(i, j+2) = velxb(i, j+2) - 9.d0*tempb1
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb0
      velxb(i-2, j) = velxb(i-2, j) - tempb0
      velxb(i, j) = velxb(i, j) + 9.d0*tempb0
      velxb(i+1, j) = velxb(i+1, j) - tempb0
      tempb0 = ccross*val_eb
      velxb(i-1, j+1) = velxb(i-1, j+1) + 9.d0*tempb - 9.d0*tempb0
      velxb(i-2, j+1) = velxb(i-2, j+1) + tempb0 - tempb
      velxb(i, j+1) = velxb(i, j+1) + 9.d0*tempb - 9.d0*tempb0
      velxb(i+1, j+1) = velxb(i+1, j+1) + tempb0 - tempb
      velxb(i-2, j-2) = velxb(i-2, j-2) + tempb0
      velxb(i-1, j-2) = velxb(i-1, j-2) - 9.d0*tempb0
      velxb(i, j-2) = velxb(i, j-2) - 9.d0*tempb0
      velxb(i+1, j-2) = velxb(i+1, j-2) + tempb0
      tempb = 7.d0*tempb0
      velxb(i-2, j-1) = velxb(i-2, j-1) + tempb1 - tempb
      velxb(i-1, j-1) = velxb(i-1, j-1) + 9.d0*tempb - 9.d0*tempb1
      velxb(i, j-1) = velxb(i, j-1) + 9.d0*tempb - 9.d0*tempb1
      velxb(i+1, j-1) = velxb(i+1, j-1) + tempb1 - tempb
      tempb1 = 7.d0*tempb0
      tempb0 = twentyfourth*val_sb
      velxb(i-1, j) = velxb(i-1, j) + 9.d0*tempb1 + 26.d0*tempb0
      velxb(i-2, j) = velxb(i-2, j) - tempb1 - tempb0
      velxb(i, j) = velxb(i, j) + 9.d0*tempb1 - tempb0
      tempb0 = twentyfourth*val_nb
      velxb(i+1, j) = velxb(i+1, j) - tempb1 - tempb0
      velxb(i, j) = velxb(i, j) + 26.d0*tempb0
      velxb(i-1, j) = velxb(i-1, j) - tempb0
      wb(i, j-4, 5) = wb(i, j-4, 5) + d4*predroe2b
      wb(i, j-5, 5) = wb(i, j-5, 5) - d5*predroe2b
      wb(i, j-3, 5) = wb(i, j-3, 5) - d3*predroe2b
      wb(i, j-2, 5) = wb(i, j-2, 5) + d2*predroe2b
      wb(i, j-1, 5) = wb(i, j-1, 5) - d1*predroe2b
      wb(i, j, 5) = wb(i, j, 5) + d1*predroe2b + d1*predroe1b
      wb(i, j+1, 5) = wb(i, j+1, 5) - d2*predroe2b
      wb(i, j+2, 5) = wb(i, j+2, 5) + d3*predroe2b
      wb(i, j+4, 5) = wb(i, j+4, 5) + d5*predroe2b
      wb(i, j+3, 5) = wb(i, j+3, 5) - d4*predroe2b
      wb(i, j-4, 4) = wb(i, j-4, 4) + d4*predrow2b
      wb(i, j-5, 4) = wb(i, j-5, 4) - d5*predrow2b
      wb(i, j-3, 4) = wb(i, j-3, 4) - d3*predrow2b
      wb(i, j-2, 4) = wb(i, j-2, 4) + d2*predrow2b
      wb(i, j-1, 4) = wb(i, j-1, 4) - d1*predrow2b
      wb(i, j, 4) = wb(i, j, 4) + d1*predrow2b + d1*predrow1b
      wb(i, j+1, 4) = wb(i, j+1, 4) - d2*predrow2b
      wb(i, j+2, 4) = wb(i, j+2, 4) + d3*predrow2b
      wb(i, j+4, 4) = wb(i, j+4, 4) + d5*predrow2b
      wb(i, j+3, 4) = wb(i, j+3, 4) - d4*predrow2b
      wb(i, j-4, 3) = wb(i, j-4, 3) + d4*predrov2b
      wb(i, j-5, 3) = wb(i, j-5, 3) - d5*predrov2b
      wb(i, j-3, 3) = wb(i, j-3, 3) - d3*predrov2b
      wb(i, j-2, 3) = wb(i, j-2, 3) + d2*predrov2b
      wb(i, j-1, 3) = wb(i, j-1, 3) - d1*predrov2b
      wb(i, j+1, 3) = wb(i, j+1, 3) - d2*predrov2b
      wb(i, j+2, 3) = wb(i, j+2, 3) + d3*predrov2b
      wb(i, j+4, 3) = wb(i, j+4, 3) + d5*predrov2b
      wb(i, j+3, 3) = wb(i, j+3, 3) - d4*predrov2b
      wb(i, j-4, 2) = wb(i, j-4, 2) + d4*predrou2b
      wb(i, j-5, 2) = wb(i, j-5, 2) - d5*predrou2b
      wb(i, j-3, 2) = wb(i, j-3, 2) - d3*predrou2b
      wb(i, j-2, 2) = wb(i, j-2, 2) + d2*predrou2b
      wb(i, j-1, 2) = wb(i, j-1, 2) - d1*predrou2b
      wb(i, j+1, 2) = wb(i, j+1, 2) - d2*predrou2b
      wb(i, j+2, 2) = wb(i, j+2, 2) + d3*predrou2b
      wb(i, j+4, 2) = wb(i, j+4, 2) + d5*predrou2b
      wb(i, j+3, 2) = wb(i, j+3, 2) - d4*predrou2b
      wb(i, j-4, 1) = wb(i, j-4, 1) + d4*predro2b
      wb(i, j-5, 1) = wb(i, j-5, 1) - d5*predro2b
      wb(i, j-3, 1) = wb(i, j-3, 1) - d3*predro2b
      wb(i, j-2, 1) = wb(i, j-2, 1) + d2*predro2b
      wb(i, j-1, 1) = wb(i, j-1, 1) - d1*predro2b
      wb(i, j+1, 1) = wb(i, j+1, 1) - d2*predro2b
      wb(i, j+2, 1) = wb(i, j+2, 1) + d3*predro2b
      wb(i, j+4, 1) = wb(i, j+4, 1) + d5*predro2b
      wb(i, j+3, 1) = wb(i, j+3, 1) - d4*predro2b
      wb(i-4, j, 5) = wb(i-4, j, 5) + d4*predroe1b
      wb(i-5, j, 5) = wb(i-5, j, 5) - d5*predroe1b
      wb(i-3, j, 5) = wb(i-3, j, 5) - d3*predroe1b
      wb(i-2, j, 5) = wb(i-2, j, 5) + d2*predroe1b
      wb(i-1, j, 5) = wb(i-1, j, 5) - d1*predroe1b
      wb(i+1, j, 5) = wb(i+1, j, 5) - d2*predroe1b
      wb(i+2, j, 5) = wb(i+2, j, 5) + d3*predroe1b
      wb(i+4, j, 5) = wb(i+4, j, 5) + d5*predroe1b
      wb(i+3, j, 5) = wb(i+3, j, 5) - d4*predroe1b
      wb(i-4, j, 4) = wb(i-4, j, 4) + d4*predrow1b
      wb(i-5, j, 4) = wb(i-5, j, 4) - d5*predrow1b
      wb(i-3, j, 4) = wb(i-3, j, 4) - d3*predrow1b
      wb(i-2, j, 4) = wb(i-2, j, 4) + d2*predrow1b
      wb(i-1, j, 4) = wb(i-1, j, 4) - d1*predrow1b
      wb(i+1, j, 4) = wb(i+1, j, 4) - d2*predrow1b
      wb(i+2, j, 4) = wb(i+2, j, 4) + d3*predrow1b
      wb(i+4, j, 4) = wb(i+4, j, 4) + d5*predrow1b
      wb(i+3, j, 4) = wb(i+3, j, 4) - d4*predrow1b
      wb(i-4, j, 3) = wb(i-4, j, 3) + d4*predrov1b
      wb(i-5, j, 3) = wb(i-5, j, 3) - d5*predrov1b
      wb(i-3, j, 3) = wb(i-3, j, 3) - d3*predrov1b
      wb(i-2, j, 3) = wb(i-2, j, 3) + d2*predrov1b
      wb(i+1, j, 3) = wb(i+1, j, 3) - d2*predrov1b
      wb(i+2, j, 3) = wb(i+2, j, 3) + d3*predrov1b
      wb(i+4, j, 3) = wb(i+4, j, 3) + d5*predrov1b
      wb(i+3, j, 3) = wb(i+3, j, 3) - d4*predrov1b
      wb(i-4, j, 2) = wb(i-4, j, 2) + d4*predrou1b
      wb(i-5, j, 2) = wb(i-5, j, 2) - d5*predrou1b
      wb(i-3, j, 2) = wb(i-3, j, 2) - d3*predrou1b
      wb(i-2, j, 2) = wb(i-2, j, 2) + d2*predrou1b
      wb(i+1, j, 2) = wb(i+1, j, 2) - d2*predrou1b
      wb(i+2, j, 2) = wb(i+2, j, 2) + d3*predrou1b
      wb(i+4, j, 2) = wb(i+4, j, 2) + d5*predrou1b
      wb(i+3, j, 2) = wb(i+3, j, 2) - d4*predrou1b
      wb(i-4, j, 1) = wb(i-4, j, 1) + d4*predro1b
      wb(i-5, j, 1) = wb(i-5, j, 1) - d5*predro1b
      wb(i-3, j, 1) = wb(i-3, j, 1) - d3*predro1b
      wb(i-2, j, 1) = wb(i-2, j, 1) + d2*predro1b
      wb(i+1, j, 1) = wb(i+1, j, 1) - d2*predro1b
      wb(i+2, j, 1) = wb(i+2, j, 1) + d3*predro1b
      wb(i+4, j, 1) = wb(i+4, j, 1) + d5*predro1b
      wb(i+3, j, 1) = wb(i+3, j, 1) - d4*predro1b
      tempb0 = nx(i, j, 2)*fxroe2b
      tempb = ny(i, j, 2)*fxroe2b
      gb(i, j, 5) = gb(i, j, 5) + c1*tempb
      gb(i, j-1, 5) = gb(i, j-1, 5) + c1*tempb
      gb(i, j+1, 5) = gb(i, j+1, 5) + c2*tempb
      gb(i, j-2, 5) = gb(i, j-2, 5) + c2*tempb
      gb(i, j+2, 5) = gb(i, j+2, 5) + c3*tempb
      gb(i, j-3, 5) = gb(i, j-3, 5) + c3*tempb
      gb(i, j+3, 5) = gb(i, j+3, 5) + c4*tempb
      gb(i, j-4, 5) = gb(i, j-4, 5) + c4*tempb
      gb(i, j+4, 5) = gb(i, j+4, 5) + c5*tempb
      gb(i, j-5, 5) = gb(i, j-5, 5) + c5*tempb
      fb(i, j, 5) = fb(i, j, 5) + c1*tempb0
      fb(i, j-1, 5) = fb(i, j-1, 5) + c1*tempb0
      fb(i, j+1, 5) = fb(i, j+1, 5) + c2*tempb0
      fb(i, j-2, 5) = fb(i, j-2, 5) + c2*tempb0
      fb(i, j+2, 5) = fb(i, j+2, 5) + c3*tempb0
      fb(i, j-3, 5) = fb(i, j-3, 5) + c3*tempb0
      fb(i, j+3, 5) = fb(i, j+3, 5) + c4*tempb0
      fb(i, j-4, 5) = fb(i, j-4, 5) + c4*tempb0
      fb(i, j+4, 5) = fb(i, j+4, 5) + c5*tempb0
      fb(i, j-5, 5) = fb(i, j-5, 5) + c5*tempb0
      tempb0 = nx(i, j, 2)*fxrow2b
      tempb = ny(i, j, 2)*fxrow2b
      gb(i, j, 4) = gb(i, j, 4) + c1*tempb
      gb(i, j-1, 4) = gb(i, j-1, 4) + c1*tempb
      gb(i, j+1, 4) = gb(i, j+1, 4) + c2*tempb
      gb(i, j-2, 4) = gb(i, j-2, 4) + c2*tempb
      gb(i, j+2, 4) = gb(i, j+2, 4) + c3*tempb
      gb(i, j-3, 4) = gb(i, j-3, 4) + c3*tempb
      gb(i, j+3, 4) = gb(i, j+3, 4) + c4*tempb
      gb(i, j-4, 4) = gb(i, j-4, 4) + c4*tempb
      gb(i, j+4, 4) = gb(i, j+4, 4) + c5*tempb
      gb(i, j-5, 4) = gb(i, j-5, 4) + c5*tempb
      fb(i, j, 4) = fb(i, j, 4) + c1*tempb0
      fb(i, j-1, 4) = fb(i, j-1, 4) + c1*tempb0
      fb(i, j+1, 4) = fb(i, j+1, 4) + c2*tempb0
      fb(i, j-2, 4) = fb(i, j-2, 4) + c2*tempb0
      fb(i, j+2, 4) = fb(i, j+2, 4) + c3*tempb0
      fb(i, j-3, 4) = fb(i, j-3, 4) + c3*tempb0
      fb(i, j+3, 4) = fb(i, j+3, 4) + c4*tempb0
      fb(i, j-4, 4) = fb(i, j-4, 4) + c4*tempb0
      fb(i, j+4, 4) = fb(i, j+4, 4) + c5*tempb0
      fb(i, j-5, 4) = fb(i, j-5, 4) + c5*tempb0
      tempb0 = nx(i, j, 2)*fxrov2b
      tempb = ny(i, j, 2)*fxrov2b
      gb(i, j, 3) = gb(i, j, 3) + c1*tempb
      gb(i, j-1, 3) = gb(i, j-1, 3) + c1*tempb
      gb(i, j+1, 3) = gb(i, j+1, 3) + c2*tempb
      gb(i, j-2, 3) = gb(i, j-2, 3) + c2*tempb
      gb(i, j+2, 3) = gb(i, j+2, 3) + c3*tempb
      gb(i, j-3, 3) = gb(i, j-3, 3) + c3*tempb
      gb(i, j+3, 3) = gb(i, j+3, 3) + c4*tempb
      gb(i, j-4, 3) = gb(i, j-4, 3) + c4*tempb
      gb(i, j+4, 3) = gb(i, j+4, 3) + c5*tempb
      gb(i, j-5, 3) = gb(i, j-5, 3) + c5*tempb
      fb(i, j, 3) = fb(i, j, 3) + c1*tempb0
      fb(i, j-1, 3) = fb(i, j-1, 3) + c1*tempb0
      fb(i, j+1, 3) = fb(i, j+1, 3) + c2*tempb0
      fb(i, j-2, 3) = fb(i, j-2, 3) + c2*tempb0
      fb(i, j+2, 3) = fb(i, j+2, 3) + c3*tempb0
      fb(i, j-3, 3) = fb(i, j-3, 3) + c3*tempb0
      fb(i, j+3, 3) = fb(i, j+3, 3) + c4*tempb0
      fb(i, j-4, 3) = fb(i, j-4, 3) + c4*tempb0
      fb(i, j+4, 3) = fb(i, j+4, 3) + c5*tempb0
      fb(i, j-5, 3) = fb(i, j-5, 3) + c5*tempb0
      tempb0 = nx(i, j, 2)*fxrou2b
      tempb = ny(i, j, 2)*fxrou2b
      gb(i, j, 2) = gb(i, j, 2) + c1*tempb
      gb(i, j-1, 2) = gb(i, j-1, 2) + c1*tempb
      gb(i, j+1, 2) = gb(i, j+1, 2) + c2*tempb
      gb(i, j-2, 2) = gb(i, j-2, 2) + c2*tempb
      gb(i, j+2, 2) = gb(i, j+2, 2) + c3*tempb
      gb(i, j-3, 2) = gb(i, j-3, 2) + c3*tempb
      gb(i, j+3, 2) = gb(i, j+3, 2) + c4*tempb
      gb(i, j-4, 2) = gb(i, j-4, 2) + c4*tempb
      gb(i, j+4, 2) = gb(i, j+4, 2) + c5*tempb
      gb(i, j-5, 2) = gb(i, j-5, 2) + c5*tempb
      fb(i, j, 2) = fb(i, j, 2) + c1*tempb0
      fb(i, j-1, 2) = fb(i, j-1, 2) + c1*tempb0
      fb(i, j+1, 2) = fb(i, j+1, 2) + c2*tempb0
      fb(i, j-2, 2) = fb(i, j-2, 2) + c2*tempb0
      fb(i, j+2, 2) = fb(i, j+2, 2) + c3*tempb0
      fb(i, j-3, 2) = fb(i, j-3, 2) + c3*tempb0
      fb(i, j+3, 2) = fb(i, j+3, 2) + c4*tempb0
      fb(i, j-4, 2) = fb(i, j-4, 2) + c4*tempb0
      fb(i, j+4, 2) = fb(i, j+4, 2) + c5*tempb0
      fb(i, j-5, 2) = fb(i, j-5, 2) + c5*tempb0
      tempb0 = nx(i, j, 2)*fxro2b
      tempb = ny(i, j, 2)*fxro2b
      gb(i, j, 1) = gb(i, j, 1) + c1*tempb
      gb(i, j-1, 1) = gb(i, j-1, 1) + c1*tempb
      gb(i, j+1, 1) = gb(i, j+1, 1) + c2*tempb
      gb(i, j-2, 1) = gb(i, j-2, 1) + c2*tempb
      gb(i, j+2, 1) = gb(i, j+2, 1) + c3*tempb
      gb(i, j-3, 1) = gb(i, j-3, 1) + c3*tempb
      gb(i, j+3, 1) = gb(i, j+3, 1) + c4*tempb
      gb(i, j-4, 1) = gb(i, j-4, 1) + c4*tempb
      gb(i, j+4, 1) = gb(i, j+4, 1) + c5*tempb
      gb(i, j-5, 1) = gb(i, j-5, 1) + c5*tempb
      fb(i, j, 1) = fb(i, j, 1) + c1*tempb0
      fb(i, j-1, 1) = fb(i, j-1, 1) + c1*tempb0
      fb(i, j+1, 1) = fb(i, j+1, 1) + c2*tempb0
      fb(i, j-2, 1) = fb(i, j-2, 1) + c2*tempb0
      fb(i, j+2, 1) = fb(i, j+2, 1) + c3*tempb0
      fb(i, j-3, 1) = fb(i, j-3, 1) + c3*tempb0
      fb(i, j+3, 1) = fb(i, j+3, 1) + c4*tempb0
      fb(i, j-4, 1) = fb(i, j-4, 1) + c4*tempb0
      fb(i, j+4, 1) = fb(i, j+4, 1) + c5*tempb0
      fb(i, j-5, 1) = fb(i, j-5, 1) + c5*tempb0
      tempb0 = nx(i, j, 1)*fxroe1b
      tempb = ny(i, j, 1)*fxroe1b
      gb(i, j, 5) = gb(i, j, 5) + c1*tempb
      gb(i-1, j, 5) = gb(i-1, j, 5) + c1*tempb
      gb(i+1, j, 5) = gb(i+1, j, 5) + c2*tempb
      gb(i-2, j, 5) = gb(i-2, j, 5) + c2*tempb
      gb(i+2, j, 5) = gb(i+2, j, 5) + c3*tempb
      gb(i-3, j, 5) = gb(i-3, j, 5) + c3*tempb
      gb(i+3, j, 5) = gb(i+3, j, 5) + c4*tempb
      gb(i-4, j, 5) = gb(i-4, j, 5) + c4*tempb
      gb(i+4, j, 5) = gb(i+4, j, 5) + c5*tempb
      gb(i-5, j, 5) = gb(i-5, j, 5) + c5*tempb
      fb(i, j, 5) = fb(i, j, 5) + c1*tempb0
      fb(i-1, j, 5) = fb(i-1, j, 5) + c1*tempb0
      fb(i+1, j, 5) = fb(i+1, j, 5) + c2*tempb0
      fb(i-2, j, 5) = fb(i-2, j, 5) + c2*tempb0
      fb(i+2, j, 5) = fb(i+2, j, 5) + c3*tempb0
      fb(i-3, j, 5) = fb(i-3, j, 5) + c3*tempb0
      fb(i+3, j, 5) = fb(i+3, j, 5) + c4*tempb0
      fb(i-4, j, 5) = fb(i-4, j, 5) + c4*tempb0
      fb(i+4, j, 5) = fb(i+4, j, 5) + c5*tempb0
      fb(i-5, j, 5) = fb(i-5, j, 5) + c5*tempb0
      tempb0 = nx(i, j, 1)*fxrow1b
      tempb = ny(i, j, 1)*fxrow1b
      gb(i, j, 4) = gb(i, j, 4) + c1*tempb
      gb(i-1, j, 4) = gb(i-1, j, 4) + c1*tempb
      gb(i+1, j, 4) = gb(i+1, j, 4) + c2*tempb
      gb(i-2, j, 4) = gb(i-2, j, 4) + c2*tempb
      gb(i+2, j, 4) = gb(i+2, j, 4) + c3*tempb
      gb(i-3, j, 4) = gb(i-3, j, 4) + c3*tempb
      gb(i+3, j, 4) = gb(i+3, j, 4) + c4*tempb
      gb(i-4, j, 4) = gb(i-4, j, 4) + c4*tempb
      gb(i+4, j, 4) = gb(i+4, j, 4) + c5*tempb
      gb(i-5, j, 4) = gb(i-5, j, 4) + c5*tempb
      fb(i, j, 4) = fb(i, j, 4) + c1*tempb0
      fb(i-1, j, 4) = fb(i-1, j, 4) + c1*tempb0
      fb(i+1, j, 4) = fb(i+1, j, 4) + c2*tempb0
      fb(i-2, j, 4) = fb(i-2, j, 4) + c2*tempb0
      fb(i+2, j, 4) = fb(i+2, j, 4) + c3*tempb0
      fb(i-3, j, 4) = fb(i-3, j, 4) + c3*tempb0
      fb(i+3, j, 4) = fb(i+3, j, 4) + c4*tempb0
      fb(i-4, j, 4) = fb(i-4, j, 4) + c4*tempb0
      fb(i+4, j, 4) = fb(i+4, j, 4) + c5*tempb0
      fb(i-5, j, 4) = fb(i-5, j, 4) + c5*tempb0
      tempb0 = nx(i, j, 1)*fxrov1b
      tempb = ny(i, j, 1)*fxrov1b
      gb(i, j, 3) = gb(i, j, 3) + c1*tempb
      gb(i-1, j, 3) = gb(i-1, j, 3) + c1*tempb
      gb(i+1, j, 3) = gb(i+1, j, 3) + c2*tempb
      gb(i-2, j, 3) = gb(i-2, j, 3) + c2*tempb
      gb(i+2, j, 3) = gb(i+2, j, 3) + c3*tempb
      gb(i-3, j, 3) = gb(i-3, j, 3) + c3*tempb
      gb(i+3, j, 3) = gb(i+3, j, 3) + c4*tempb
      gb(i-4, j, 3) = gb(i-4, j, 3) + c4*tempb
      gb(i+4, j, 3) = gb(i+4, j, 3) + c5*tempb
      gb(i-5, j, 3) = gb(i-5, j, 3) + c5*tempb
      fb(i, j, 3) = fb(i, j, 3) + c1*tempb0
      fb(i-1, j, 3) = fb(i-1, j, 3) + c1*tempb0
      fb(i+1, j, 3) = fb(i+1, j, 3) + c2*tempb0
      fb(i-2, j, 3) = fb(i-2, j, 3) + c2*tempb0
      fb(i+2, j, 3) = fb(i+2, j, 3) + c3*tempb0
      fb(i-3, j, 3) = fb(i-3, j, 3) + c3*tempb0
      fb(i+3, j, 3) = fb(i+3, j, 3) + c4*tempb0
      fb(i-4, j, 3) = fb(i-4, j, 3) + c4*tempb0
      fb(i+4, j, 3) = fb(i+4, j, 3) + c5*tempb0
      fb(i-5, j, 3) = fb(i-5, j, 3) + c5*tempb0
      tempb0 = nx(i, j, 1)*fxrou1b
      tempb = ny(i, j, 1)*fxrou1b
      gb(i, j, 2) = gb(i, j, 2) + c1*tempb
      gb(i-1, j, 2) = gb(i-1, j, 2) + c1*tempb
      gb(i+1, j, 2) = gb(i+1, j, 2) + c2*tempb
      gb(i-2, j, 2) = gb(i-2, j, 2) + c2*tempb
      gb(i+2, j, 2) = gb(i+2, j, 2) + c3*tempb
      gb(i-3, j, 2) = gb(i-3, j, 2) + c3*tempb
      gb(i+3, j, 2) = gb(i+3, j, 2) + c4*tempb
      gb(i-4, j, 2) = gb(i-4, j, 2) + c4*tempb
      gb(i+4, j, 2) = gb(i+4, j, 2) + c5*tempb
      gb(i-5, j, 2) = gb(i-5, j, 2) + c5*tempb
      fb(i, j, 2) = fb(i, j, 2) + c1*tempb0
      fb(i-1, j, 2) = fb(i-1, j, 2) + c1*tempb0
      fb(i+1, j, 2) = fb(i+1, j, 2) + c2*tempb0
      fb(i-2, j, 2) = fb(i-2, j, 2) + c2*tempb0
      fb(i+2, j, 2) = fb(i+2, j, 2) + c3*tempb0
      fb(i-3, j, 2) = fb(i-3, j, 2) + c3*tempb0
      fb(i+3, j, 2) = fb(i+3, j, 2) + c4*tempb0
      fb(i-4, j, 2) = fb(i-4, j, 2) + c4*tempb0
      fb(i+4, j, 2) = fb(i+4, j, 2) + c5*tempb0
      fb(i-5, j, 2) = fb(i-5, j, 2) + c5*tempb0
      tempb0 = nx(i, j, 1)*fxro1b
      tempb = ny(i, j, 1)*fxro1b
      gb(i, j, 1) = gb(i, j, 1) + c1*tempb
      gb(i-1, j, 1) = gb(i-1, j, 1) + c1*tempb
      gb(i+1, j, 1) = gb(i+1, j, 1) + c2*tempb
      gb(i-2, j, 1) = gb(i-2, j, 1) + c2*tempb
      gb(i+2, j, 1) = gb(i+2, j, 1) + c3*tempb
      gb(i-3, j, 1) = gb(i-3, j, 1) + c3*tempb
      gb(i+3, j, 1) = gb(i+3, j, 1) + c4*tempb
      gb(i-4, j, 1) = gb(i-4, j, 1) + c4*tempb
      gb(i+4, j, 1) = gb(i+4, j, 1) + c5*tempb
      gb(i-5, j, 1) = gb(i-5, j, 1) + c5*tempb
      fb(i, j, 1) = fb(i, j, 1) + c1*tempb0
      fb(i-1, j, 1) = fb(i-1, j, 1) + c1*tempb0
      fb(i+1, j, 1) = fb(i+1, j, 1) + c2*tempb0
      fb(i-2, j, 1) = fb(i-2, j, 1) + c2*tempb0
      fb(i+2, j, 1) = fb(i+2, j, 1) + c3*tempb0
      fb(i-3, j, 1) = fb(i-3, j, 1) + c3*tempb0
      fb(i+3, j, 1) = fb(i+3, j, 1) + c4*tempb0
      fb(i-4, j, 1) = fb(i-4, j, 1) + c4*tempb0
      fb(i+4, j, 1) = fb(i+4, j, 1) + c5*tempb0
      fb(i-5, j, 1) = fb(i-5, j, 1) + c5*tempb0
    END DO
  END DO
  DO i=2,1,-1
    DO h=gh,1,-1
      gradvb(im-1+h, :, :) = gradvb(im-1+h, :, :) + two*gradvb(im+h, :, &
&       :)
      gradvb(im-2+h, :, :) = gradvb(im-2+h, :, :) - gradvb(im+h, :, :)
      gradvb(im+h, :, :) = 0.0_8
      gradub(im-1+h, :, :) = gradub(im-1+h, :, :) + two*gradub(im+h, :, &
&       :)
      gradub(im-2+h, :, :) = gradub(im-2+h, :, :) - gradub(im+h, :, :)
      gradub(im+h, :, :) = 0.0_8
      gradvb(2-h, :, :) = gradvb(2-h, :, :) + two*gradvb(1-h, :, :)
      gradvb(3-h, :, :) = gradvb(3-h, :, :) - gradvb(1-h, :, :)
      gradvb(1-h, :, :) = 0.0_8
      gradub(2-h, :, :) = gradub(2-h, :, :) + two*gradub(1-h, :, :)
      gradub(3-h, :, :) = gradub(3-h, :, :) - gradub(1-h, :, :)
      gradub(1-h, :, :) = 0.0_8
      gradvb(:, jm-1+h, :) = gradvb(:, jm-1+h, :) + two*gradvb(:, jm+h, &
&       :)
      gradvb(:, jm-2+h, :) = gradvb(:, jm-2+h, :) - gradvb(:, jm+h, :)
      gradvb(:, jm+h, :) = 0.0_8
      gradub(:, jm-1+h, :) = gradub(:, jm-1+h, :) + two*gradub(:, jm+h, &
&       :)
      gradub(:, jm-2+h, :) = gradub(:, jm-2+h, :) - gradub(:, jm+h, :)
      gradub(:, jm+h, :) = 0.0_8
      gradvb(:, 2-h, :) = gradvb(:, 2-h, :) + two*gradvb(:, 1-h, :)
      gradvb(:, 3-h, :) = gradvb(:, 3-h, :) - gradvb(:, 1-h, :)
      gradvb(:, 1-h, :) = 0.0_8
      gradub(:, 2-h, :) = gradub(:, 2-h, :) + two*gradub(:, 1-h, :)
      gradub(:, 3-h, :) = gradub(:, 3-h, :) - gradub(:, 1-h, :)
      gradub(:, 1-h, :) = 0.0_8
    END DO
  END DO
!$BWD-OF II-LOOP 
  DO j=1,jm
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1,im
!idir
!jdir
      volm1 = one/vol(i, j)
      dxm1 = half*(nx(i, j, 1)+nx(i+1, j, 1))*volm1
      dxm2 = half*(nx(i, j, 2)+nx(i, j+1, 2))*volm1
      dym1 = half*(ny(i, j, 1)+ny(i+1, j, 1))*volm1
      dym2 = half*(ny(i, j, 2)+ny(i, j+1, 2))*volm1
      gvib = dym1*gradvb(i, j, 2) + dxm1*gradvb(i, j, 1)
      gvjb = dym2*gradvb(i, j, 2) + dxm2*gradvb(i, j, 1)
      gradvb(i, j, 2) = 0.0_8
      guib = dym1*gradub(i, j, 2) + dxm1*gradub(i, j, 1)
      gujb = dym2*gradub(i, j, 2) + dxm2*gradub(i, j, 1)
      gradub(i, j, 2) = 0.0_8
      gradvb(i, j, 1) = 0.0_8
      gradub(i, j, 1) = 0.0_8
      velyb(i, j+1) = velyb(i, j+1) + b1*gvjb
      velyb(i, j-1) = velyb(i, j-1) - b1*gvjb
      velyb(i, j+2) = velyb(i, j+2) + b2*gvjb
      velyb(i, j-2) = velyb(i, j-2) - b2*gvjb
      velyb(i, j+3) = velyb(i, j+3) + b3*gvjb
      velyb(i, j-3) = velyb(i, j-3) - b3*gvjb
      velyb(i, j+4) = velyb(i, j+4) + b4*gvjb
      velyb(i, j-4) = velyb(i, j-4) - b4*gvjb
      velyb(i, j+5) = velyb(i, j+5) + b5*gvjb
      velyb(i, j-5) = velyb(i, j-5) - b5*gvjb
      velxb(i, j+1) = velxb(i, j+1) + b1*gujb
      velxb(i, j-1) = velxb(i, j-1) - b1*gujb
      velxb(i, j+2) = velxb(i, j+2) + b2*gujb
      velxb(i, j-2) = velxb(i, j-2) - b2*gujb
      velxb(i, j+3) = velxb(i, j+3) + b3*gujb
      velxb(i, j-3) = velxb(i, j-3) - b3*gujb
      velxb(i, j+4) = velxb(i, j+4) + b4*gujb
      velxb(i, j-4) = velxb(i, j-4) - b4*gujb
      velxb(i, j+5) = velxb(i, j+5) + b5*gujb
      velxb(i, j-5) = velxb(i, j-5) - b5*gujb
      velyb(i+1, j) = velyb(i+1, j) + b1*gvib
      velyb(i-1, j) = velyb(i-1, j) - b1*gvib
      velyb(i+2, j) = velyb(i+2, j) + b2*gvib
      velyb(i-2, j) = velyb(i-2, j) - b2*gvib
      velyb(i+3, j) = velyb(i+3, j) + b3*gvib
      velyb(i-3, j) = velyb(i-3, j) - b3*gvib
      velyb(i+4, j) = velyb(i+4, j) + b4*gvib
      velyb(i-4, j) = velyb(i-4, j) - b4*gvib
      velyb(i+5, j) = velyb(i+5, j) + b5*gvib
      velyb(i-5, j) = velyb(i-5, j) - b5*gvib
      velxb(i+1, j) = velxb(i+1, j) + b1*guib
      velxb(i-1, j) = velxb(i-1, j) - b1*guib
      velxb(i+2, j) = velxb(i+2, j) + b2*guib
      velxb(i-2, j) = velxb(i-2, j) - b2*guib
      velxb(i+3, j) = velxb(i+3, j) + b3*guib
      velxb(i-3, j) = velxb(i-3, j) - b3*guib
      velxb(i+4, j) = velxb(i+4, j) + b4*guib
      velxb(i-4, j) = velxb(i-4, j) - b4*guib
      velxb(i+5, j) = velxb(i+5, j) + b5*guib
      velxb(i-5, j) = velxb(i-5, j) - b5*guib
    END DO
  END DO
!$BWD-OF II-LOOP 
  DO j=1-gh,jm+gh
!$BWD-OF II-LOOP 
!DIR$ IVDEP
    DO i=1-gh,im+gh
      ro = w(i, j, 1)
      rom1 = one/ro
      velx(i, j) = w(i, j, 2)*rom1
      vely(i, j) = w(i, j, 3)*rom1
      velz(i, j) = w(i, j, 4)*rom1
!
      ec = half*(velx(i, j)*velx(i, j)+vely(i, j)*vely(i, j)+velz(i, j)*&
&       velz(i, j))
! ec  = HALF*( velx(i,j)*velx(i,j) &
!            + vely(i,j)*vely(i,j))
!
      eloc = (w(i, j, 5)-ec*ro)*rom1
!
      tloc(i, j) = eloc*cvm1
!
      p(i, j) = (gam-one)*ro*eloc
!  p(i,j)  = ro*rgaz*tloc(i,j)
      htot = (w(i, j, 5)+p(i, j))*rom1
!h(i,j,1)  = w(i,j,4)
!h(i,j,2)  = w(i,j,4) * velx(i,j)
!h(i,j,3)  = w(i,j,4) * vely(i,j)
!h(i,j,4)  = w(i,j,4) * velz(i,j) + p(i,j)
!h(i,j,5)  = w(i,j,4) * htot
      temp = tloc(i, j)/(s_suth+tloc(i, j))
      temp0 = SQRT(tloc(i, j))
      tempb = temp0*betas*mub(i, j)/(s_suth+tloc(i, j))
      IF (tloc(i, j) .EQ. 0.0) THEN
        tlocb(i, j) = tlocb(i, j) + (1.0-temp)*tempb
      ELSE
        tlocb(i, j) = tlocb(i, j) + temp*betas*mub(i, j)/(2.0*temp0) + (&
&         1.0-temp)*tempb
      END IF
      mub(i, j) = 0.0_8
      htotb = w(i, j, 3)*gb(i, j, 5) + w(i, j, 2)*fb(i, j, 5)
      pb(i, j) = pb(i, j) + gb(i, j, 3) + fb(i, j, 2) + rom1*htotb
      elocb = ro*(gam-one)*pb(i, j) + cvm1*tlocb(i, j)
      tlocb(i, j) = 0.0_8
      tempb = rom1*elocb
      wb(i, j, 5) = wb(i, j, 5) + rom1*htotb + tempb
      rob = eloc*(gam-one)*pb(i, j) - ec*tempb
      pb(i, j) = 0.0_8
      ecb = -(ro*tempb)
      tempb = half*ecb
      velzb(i, j) = velzb(i, j) + w(i, j, 3)*gb(i, j, 4) + w(i, j, 2)*fb&
&       (i, j, 4) + 2*velz(i, j)*tempb
      velyb(i, j) = velyb(i, j) + w(i, j, 3)*gb(i, j, 3) + w(i, j, 2)*fb&
&       (i, j, 3) + 2*vely(i, j)*tempb
      wb(i, j, 3) = wb(i, j, 3) + htot*gb(i, j, 5) + velz(i, j)*gb(i, j&
&       , 4) + vely(i, j)*gb(i, j, 3) + velx(i, j)*gb(i, j, 2) + gb(i, j&
&       , 1) + rom1*velyb(i, j)
      gb(i, j, 5) = 0.0_8
      gb(i, j, 4) = 0.0_8
      gb(i, j, 3) = 0.0_8
      velxb(i, j) = velxb(i, j) + w(i, j, 3)*gb(i, j, 2) + w(i, j, 2)*fb&
&       (i, j, 2) + 2*velx(i, j)*tempb
      gb(i, j, 2) = 0.0_8
      gb(i, j, 1) = 0.0_8
      wb(i, j, 2) = wb(i, j, 2) + htot*fb(i, j, 5) + velz(i, j)*fb(i, j&
&       , 4) + vely(i, j)*fb(i, j, 3) + velx(i, j)*fb(i, j, 2) + fb(i, j&
&       , 1) + rom1*velxb(i, j)
      fb(i, j, 5) = 0.0_8
      fb(i, j, 4) = 0.0_8
      fb(i, j, 3) = 0.0_8
      fb(i, j, 2) = 0.0_8
      fb(i, j, 1) = 0.0_8
      rom1b = (w(i, j, 5)+p(i, j))*htotb + (w(i, j, 5)-ec*ro)*elocb + w(&
&       i, j, 4)*velzb(i, j) + w(i, j, 3)*velyb(i, j) + w(i, j, 2)*velxb&
&       (i, j)
      wb(i, j, 4) = wb(i, j, 4) + rom1*velzb(i, j)
      velzb(i, j) = 0.0_8
      velyb(i, j) = 0.0_8
      velxb(i, j) = 0.0_8
      rob = rob - one*rom1b/ro**2
      wb(i, j, 1) = wb(i, j, 1) + rob
    END DO
  END DO
END SUBROUTINE FLUX_NUM_DNC9_2D_B
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

